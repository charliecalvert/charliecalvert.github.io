<!DOCTYPE html><html lang="en" dir="ltr"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width initial-scale=1.0"><title>Prog219-Week11-2015</title><link rel="shortcut icon" href="/charlie/images/favicon.png"><!-- Latest compiled and minified CSS--><link rel="stylesheet" href="/components/bootstrap/dist/css/bootstrap.min.css"><!-- Optional theme--><link rel="stylesheet" href="/components/bootstrap/dist/css/bootstrap-theme.min.css"><!-- link(href='/libs/css/BootstrapIndex.css', rel='stylesheet', type='text/css')--><link href="/css/style.css" rel="stylesheet" type="text/css"><link href="/css/highlight/googlecode.css" rel="stylesheet" type="text/css"><script src="/components/jquery/dist/jquery.js"></script><script src="/components/angular/angular.js"></script><script src="/components/angular-route/angular-route.js"></script><script src="/components/bootstrap/dist/js/bootstrap.min.js"></script><!-- script(src='/libs/scripts/elvenware.js', type='text/javascript')--><!-- script(src="/libs/scripts/Control.js")--><!-- script(src='http://localhost:35729/livereload.js')--></head><body><div class="navbar navbar-inverse"><div class="container"><div class="navbar-header"><button type="button" data-toggle="collapse" data-target=".navbar-collapse" class="navbar-toggle"><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><a href="/" class="navbar-brand">Elvenware</a></div><div class="collapse navbar-collapse"><ul class="nav navbar-nav"><li class="active"><a href="/index.html">Home</a></li><li><a href="/about">About</a></li><li class="dropdown"><a href="#/" data-toggle="dropdown" class="dropdown-toggle">Dropdown<b class="caret"></b></a><ul class="dropdown-menu"><li class="dropdown-header">Core Code</li><li><a href="/development/index.html">Strongly Typed</a></li><li><a href="/development/web/index.html">Web & Scripts</a></li><li><a href="/development/cloud/index.shtml">Cloud</a></li><li class="divider"></li><li class="dropdown-header">OS and Tools</li><li><a href="/os/index.html">OS</a></li><li><a href="/development/database/index.html">Database</a></li><li><a href="/books/index.html">My Writing</a></li><li class="divider"></li><li class="dropdown-header">Art</li><li><a href="/charlie/Art/index.html">Poems & Photos</a></li><li><a href="/books/reading/index.html">Book Reviews</a></li><li><a href="/spirit/index.html">Spiritual</a></li><li class="divider"></li><li class="dropdown-header">Links</li><li><a href="/charlie/links.html">My Links</a></li><li><a href="http://www.github.com/charliecalvert">GitHub</a></li><li><a href="http://sourceforge.net/projects/elvenware/">Sourceforge</a></li></ul></li></ul></div><!-- /.nav-collapse--></div></div><div class="container"><figure><img alt="Elvenware" src="/charlie/images/elvenwarelogo.png"/></figure><h1>Prog219-Week11-2015</h1><p>Table of Content:</p><ul><!--TOC_Start--><li><a href="#description">Description</a></li>
<li><a href="#shared-document-on-google">Shared Document on Google</a></li>
<li><a href="#angular-verison">Angular verison</a></li>
<li><a href="#bootswatch-gotcha">Bootswatch Gotcha</a></li>
<li><a href="#test-code">Test Code</a></li>
<li><a href="#jasmine-version">Jasmine Version</a></li>
<li><a href="#jasmine-and-httpbackend">Jasmine and $httpBackend</a></li>
<li><a href="#scope">Scope</a></li>
<li><a href="#routes">Routes</a></li>
<li><a href="#upstart">Upstart</a></li>
<li><a href="#menus">Menus</a></li>
<li><a href="#signin">SignIn</a></li>
<li><a href="#comments">Comments</a></li>
<li><a href="#handling-missing-documents">Handling Missing Documents</a></li>
<li><a href="#the-getmarie-button">The GetMarie Button</a></li><!--TOC_End--></ul><h2 id="description">Description</h2>
<p>Thoughts and hints during finals week.</p>
<p>Please note that next school year I should be teaching:</p>
<ul>
<li>ISIT320 in the fall</li>
<li>ISIT322 in Winter</li>
<li>Prog270 in Winter</li>
<li>Prog272 in Spring</li>
<li>Prog219 in Spring</li>
</ul>
<p>Anyone who got through this course is welcome in both 320 and 322. Those are sophmore year courses and are part of the four year program. Having made it through this course should make 270 relatively simple for you, and Prog272 should be interesting but also a comfortable fit. </p>
<p>In general, a lot of the same subjects we are covering here will be in all or most of those courses:</p>
<ul>
<li>Cloud, Git, AWS</li>
<li>HTML, CSS, JavaScript</li>
<li>Express, Angular</li>
<li>NOSQL with either MongoDb or CouchDb</li>
<li>Maybe a little Python in 320 and 322. We also did a lot of ThreeJS in 320 last year, but I&#39;m not sure we will head that way this time around. </li>
</ul>
<h2 id="shared-document-on-google">Shared Document on Google</h2>
<p>Make sure everyone can find our shared document on Google docs. The <strong>FromCharlie</strong> document.</p>
<h2 id="angular-verison">Angular verison</h2>
<p>Don&#39;t mix your versions of angular in bower.json</p>
<p>Wrong:</p>
<pre><code> <span class="hljs-string">"dependencies"</span>: {
    <span class="hljs-string">"angular"</span>: <span class="hljs-string">"~1.3.15"</span>,
    <span class="hljs-string">"angular-mocks"</span>: <span class="hljs-string">"~1.3.15"</span>,
    <span class="hljs-string">"angular-resource"</span>: <span class="hljs-string">"~1.4.0"</span>,
    <span class="hljs-string">"angular-route"</span>: <span class="hljs-string">"~1.4.0"</span>
  }
</code></pre><p>Right:</p>
<pre><code> <span class="hljs-string">"dependencies"</span>: {
    <span class="hljs-string">"angular"</span>: <span class="hljs-string">"~1.4.0"</span>,
    <span class="hljs-string">"angular-mocks"</span>: <span class="hljs-string">"~1.4.0"</span>,
    <span class="hljs-string">"angular-resource"</span>: <span class="hljs-string">"~1.4.0"</span>,
    <span class="hljs-string">"angular-route"</span>: <span class="hljs-string">"~1.4.0"</span>
  }
</code></pre><h2 id="bootswatch-gotcha">Bootswatch Gotcha</h2>
<p>For some reason, typing bower install bootswatch --save generates this code in bower.json:</p>
<pre><code>  <span class="hljs-string">"dependencies"</span>: {
    <span class="hljs-string">"angular"</span>: <span class="hljs-string">"~1.4.0"</span>,
    <span class="hljs-string">"bootstrap"</span>: <span class="hljs-string">"~3.3.4"</span>,
    <span class="hljs-string">"angular-route"</span>: <span class="hljs-string">"~1.4.0"</span>,
    <span class="hljs-string">"bootswatch"</span>: <span class="hljs-string">"~3.3.4+1"</span>
  }
</code></pre><p>Having this code in your bower.json file won&#39;t necessarily cause on error on your end, but it does cause an error when I type <strong>bower install</strong>.</p>
<p>The problem is that the bootswatch dependency in <strong>bower.json</strong> is not valid bower syntax, or perhaps bower has a bug and cannot process this syntax:</p>
<pre><code><span class="hljs-string">"bootswatch"</span>: <span class="hljs-string">"~3.3.4+1"</span>
</code></pre><p>Regardless of why it occurs, you have to fix it like this:</p>
<pre><code><span class="hljs-string">"bootswatch"</span>: <span class="hljs-string">"~3.3.4"</span>
</code></pre><p>Or perhaps like this:</p>
<pre><code><span class="hljs-string">"bootswatch"</span>: <span class="hljs-string">"3.3.4+1"</span>
</code></pre><p>The first is probably better. Please check all your projects, and especially your final, and make sure you don&#39;t turn in code like this. Your code should compile as is when you hand it in. Just think if you opened this project a year from now, when this stuff is no longer fresh in your mind, and you tried to run it and saw some error that made no sense to you. You can fix it now, but later your head won&#39;t be in this space, and even a simple error like this could throw you. Fix it so you can use your code later on.</p>
<h2 id="test-code">Test Code</h2>
<p>In the previous section we talked about <strong>bootswatch</strong>.  The same things we said there are true for forgetting to add something to bower. For instance, if you type <strong>bower install angular-route</strong>, and forget to add the <strong>--save</strong> then it will work fine on your machine, but not on other machines. When you come back to the program much later you might not see as quickly as you do now just what is wrong. </p>
<p>The take-away: <strong>test your code!</strong>. Before you submit, try doing a pull on your repository in a temp directory and see if it works for someone who is trying to bootstrap the program from the source you provide. Someday, that someone might well be you. Do you future self a favor: <strong>test your code</strong>.</p>
<h2 id="jasmine-version">Jasmine Version</h2>
<p>Make sure you are using the correct version of Jasmine.</p>
<p>Wrong:</p>
<pre><code class="lang-javascript">{
 "<span class="hljs-attr">name</span>": <span class="hljs-string">"testlive"</span>,
 "<span class="hljs-attr">version</span>": <span class="hljs-string">"0.0.0"</span>,
 "<span class="hljs-attr">dependencies</span>": {
     "<span class="hljs-attr">jasmine</span>": <span class="hljs-string">"~1.3.1"</span>
 },
 "<span class="hljs-attr">devDependencies</span>": {}
}
</code></pre>
<p>It should be a later version, like this:</p>
<pre><code class="lang-javascript">{
 "<span class="hljs-attr">name</span>": <span class="hljs-string">"testlive"</span>,
 "<span class="hljs-attr">version</span>": <span class="hljs-string">"0.0.0"</span>,
 "<span class="hljs-attr">dependencies</span>": {
   "<span class="hljs-attr">jasmine</span>": <span class="hljs-string">"~2.3.4"</span>
 },
 "<span class="hljs-attr">devDependencies</span>": {}
}
</code></pre>
<p>Make sure you are loading all the jasmine files, including <strong>boot.js</strong>:</p>
<pre><code class="lang-HTML"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"bower_components/jasmine/lib/jasmine-core/jasmine.js"</span>&gt;</span><span class="undefined"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"bower_components/jasmine/lib/jasmine-core/jasmine-html.js"</span>&gt;</span><span class="undefined"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"bower_components/jasmine/lib/jasmine-core/boot.js"</span>&gt;</span><span class="undefined"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<p>For instance, here is a sample <strong>test/index.html</strong> file:</p>
<pre><code class="lang-html"><span class="hljs-meta">&lt;!doctype html&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Jasmine Spec Runner<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"stylesheet"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"bower_components/jasmine/lib/jasmine-core/jasmine.css"</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"bower_components/jasmine/lib/jasmine-core/jasmine.js"</span>&gt;</span><span class="undefined"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"bower_components/jasmine/lib/jasmine-core/jasmine-html.js"</span>&gt;</span><span class="undefined"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"bower_components/jasmine/lib/jasmine-core/boot.js"</span>&gt;</span><span class="undefined"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>

        <span class="hljs-comment">&lt;!-- include source files here... --&gt;</span>
        <span class="hljs-comment">&lt;!-- script src="../public/components/jquery/dist/jquery.js"&gt;&lt;/script --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"../public/components/angular/angular.js"</span>&gt;</span><span class="undefined"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"../public/components/angular-mocks/angular-mocks.js"</span>&gt;</span><span class="undefined"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"../public/components/angular-route/angular-route.js"</span>&gt;</span><span class="undefined"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- include spec files here... --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"../public/javascripts/ScienceFacade.js"</span>&gt;</span><span class="undefined"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"../public/javascripts/SimpleScienceData.js"</span>&gt;</span><span class="undefined"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"../public/javascripts/Control.js"</span>&gt;</span><span class="undefined"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"spec/test.js"</span>&gt;</span><span class="undefined"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"spec/TestScienceFacade.js"</span>&gt;</span><span class="undefined"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<h2 id="jasmine-and-httpbackend">Jasmine and $httpBackend</h2>
<p>I have added at least a little more text to my explanation of <strong>$httpBackend</strong>:</p>
<ul>
<li><a href="http://www.elvenware.com/charlie/development/web/JavaScript/Angular.html#mocking-objects-with-httpbackend">http://www.elvenware.com/charlie/development/web/JavaScript/Angular.html#mocking-objects-with-httpbackend</a></li>
</ul>
<p>Press F5 a few times to make sure you have the most recent copy if you are going back to that page after viewing it recently.</p>
<h2 id="scope">Scope</h2>
<p>A few students are still placing code outside the scope of the modules, factories and controllers that we are creating. For instance, in the code shown below the <strong>remove</strong> method is outside the scope the <strong>scientists</strong> factory. I&#39;m showing the module, the constant and the factory, with all their interanal code elided. I then show the error, which is trying to add a method to the factory called <strong>remove</strong>. The problem is that the remove method is being placed outside the scope of the factory:</p>
<pre><code class="lang-javascript">angular.module(<span class="hljs-string">'pres'</span>, [<span class="hljs-string">'ngResource'</span>])
    .constant(<span class="hljs-string">'CONFIG'</span>, {
        // Code Omitted here
    })
    .factory(<span class="hljs-string">'scientists'</span>, <span class="hljs-keyword">function</span> ($resource, CONFIG) {

        var scientists = $resource( ...

        // Code ommitted here

        return scientists;
    });

    scientists.prototype.remove = <span class="hljs-keyword">function</span> (successCallback, errorCallback) {
        // Code omitted here
    };
</code></pre>
<p>It should be like this:</p>
<pre><code class="lang-javascript">angular.module(<span class="hljs-string">'pres'</span>, [<span class="hljs-string">'ngResource'</span>])
    .constant(<span class="hljs-string">'CONFIG'</span>, {
        // Code Omitted here
    })
    .factory(<span class="hljs-string">'scientists'</span>, <span class="hljs-keyword">function</span> ($resource, CONFIG) {

        var scientists = $resource( ...

        // Code ommitted here

        scientists.prototype.remove = function (successCallback, errorCallback) {
            // Code omitted here
        };

        return scientists;
    });
</code></pre>
<p>Can you see that this will never work? The remove method is outside the factory itself. </p>
<h2 id="routes">Routes</h2>
<p>You will need at least two middleware routing files on the server side to get the basic functionality up and running. You will need three if you want to properly handle <strong>comments</strong>.</p>
<p>Here are the files:</p>
<ul>
<li><strong>routes/index</strong>: Use this file to handle requests for <strong>main.jade</strong>, <strong>about.jade</strong> and similar files.</li>
<li><strong>routes/documents</strong>: Use this or file with a similar name to handle requests for your topics documents. In the sample program, these documents have names like <strong>physics.jade</strong>, <strong>astronomy.jade</strong>, etc.</li>
<li><strong>routes/comments</strong>: Use this file for requests related to comments.</li>
</ul>
<p>In <strong>index.js</strong> the code that handles requests for comments looks like this in my version of the final:</p>
<pre><code class="lang-javascript">router.<span class="hljs-keyword">get</span>(<span class="hljs-string">'/:id'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(request, response)</span> </span>{
    console.log(request.params.id);
    response.render(request.params.id, {});
});
</code></pre>
<p>In <strong>documents.js</strong>, the entire file looks like this in my version of final:</p>
<pre><code class="lang-javascript">var express = require(<span class="hljs-string">'express'</span>)<span class="hljs-comment">;</span>
var router = express.Router()<span class="hljs-comment">;</span>

<span class="hljs-comment">/* GET home page. */</span>

router.get(<span class="hljs-string">'/:id'</span>, function(req, res, <span class="hljs-keyword">next</span>) {
  console.log(<span class="hljs-string">'ScienceInfo'</span>, req.params.id)<span class="hljs-comment">;</span>
  res.render(<span class="hljs-string">'ScienceInfo/'</span> + req.params.id, { <span class="hljs-keyword">title</span>: <span class="hljs-string">'Astronomy'</span> })<span class="hljs-comment">;</span>
})<span class="hljs-comment">;</span>

module.exports = router<span class="hljs-comment">;</span>
</code></pre>
<p>The contents of my <strong>routes/comments.js</strong> file is discussed <a href="https://www.ccalvert.net/books/CloudNotes/Assignments/MongooseComments.html#step-three">elsewhere</a>.</p>
<h2 id="upstart">Upstart</h2>
<p>Make sure upstart is running on EC2</p>
<ul>
<li><a href="http://www.elvenware.com/charlie/development/web/JavaScript/NodeJs.html#upstart">Upstart on Elvenware</a></li>
<li><a href="https://github.com/charliecalvert/JsObjects/blob/master/JavaScript/NodeCode/ExpressSend/ExpressSend.conf">Sample Upstart script</a></li>
</ul>
<h2 id="menus">Menus</h2>
<h2 id="signin">SignIn</h2>
<p>This video shows one way to handle the login functionality in your application. This is not the only possible solution. You can do it differently, but if you are not sure what is wanted, this gives you an idea of what to shoot for. </p>
<ul>
<li><a href="https://youtu.be/xCmgU7iSYO4">https://youtu.be/xCmgU7iSYO4</a></li>
</ul>
<h2 id="comments">Comments</h2>
<p>Please see this explanation of sending requests from the browser, to the server, to the databases, and back. It is very important that you understand this operation.</p>
<ul>
<li>Sending a <a href="http://elvenware.com/charlie/development/web/JavaScript/Angular.html#http">new comment</a> from the browser to a server to a database. </li>
</ul>
<h2 id="handling-missing-documents">Handling Missing Documents</h2>
<p>We should have a default document that is loaded if the document requested is not found. If not that, then at least load in a message rather than popping up an alert.</p>
<h2 id="the-getmarie-button">The GetMarie Button</h2>
<p>Make sure you are searching for a string and a field that exists in your database. For instance, I have someone with a firstName of <strong>Marie</strong> in my database, hence the following code works for me:</p>
<pre><code class="lang-javascript">
myController.getMarie = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">var</span> maries = myController.scientists[<span class="hljs-number">0</span>].getTopic(<span class="hljs-string">"Marie"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(maries)</span> </span>{
        myController.marie = maries[<span class="hljs-number">0</span>];
    });
};
</code></pre>
<p>But if you have no one with a first name of Marie, then that won&#39;t work. </p>
<p>Also, in your equivalent of <strong>public/javascripts/ScienceResource</strong>, make sure you search on a field that exists in your database. For instance, I have a field called <strong>firstName</strong> so this code works:</p>
<pre><code class="lang-javascript">scientists.prototype.getTopic = <span class="hljs-keyword">function</span>(firstNameToFind, callback) {
    bar = $resource(
        <span class="hljs-string">'https://api.mongolab.com/api/1/databases/'</span> + CONFIG.DB_NAME +
        <span class="hljs-string">'/collections/'</span> + CONFIG.COLLECTION, {
            apiKey: CONFIG.API_KEY,
            q: {<span class="hljs-string">"firstName"</span>: firstNameToFind }
        });
    return bar.query({}, callback);
};
</code></pre>
<p>However, if you have a <strong>gadgetName</strong> property but no <strong>firstName</strong> property, then you should write this:</p>
<pre><code class="lang-javascript">scientists.prototype.getTopic = <span class="hljs-keyword">function</span>(gadgetNameToFind, callback) {
    bar = $resource(
        <span class="hljs-string">'https://api.mongolab.com/api/1/databases/'</span> + CONFIG.DB_NAME +
        <span class="hljs-string">'/collections/'</span> + CONFIG.COLLECTION, {
            apiKey: CONFIG.API_KEY,
            q: {<span class="hljs-string">"gadgetName"</span>: gadgetNameToFind }
        });
    return bar.query({}, callback);
};
</code></pre>
</div></body></html>