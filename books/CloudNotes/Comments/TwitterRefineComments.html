<!DOCTYPE html><html lang="en" dir="ltr"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width initial-scale=1.0"><title>TwitterRefineComments</title><link rel="shortcut icon" href="/charlie/images/favicon.png"><!-- Latest compiled and minified CSS--><link rel="stylesheet" href="/components/bootstrap/dist/css/bootstrap.min.css"><!-- Optional theme--><link rel="stylesheet" href="/components/bootstrap/dist/css/bootstrap-theme.min.css"><link href="/libs/css/BootstrapIndex.css" rel="stylesheet" type="text/css"><link href="/css/style.css" rel="stylesheet" type="text/css"><link href="/css/highlight/googlecode.css" rel="stylesheet" type="text/css"><script src="/components/jquery/dist/jquery.js"></script><script src="/components/angular/angular.js"></script><script src="/components/angular-route/angular-route.js"></script><script src="/components/bootstrap/dist/js/bootstrap.min.js"></script><script src="/libs/scripts/elvenware.js" type="text/javascript"></script><script src="/libs/scripts/Control.js"></script></head><body><div class="navbar navbar-inverse"><div class="container"><div class="navbar-header"><button type="button" data-toggle="collapse" data-target=".navbar-collapse" class="navbar-toggle"><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><a href="/" class="navbar-brand">Elvenware</a></div><div class="collapse navbar-collapse"><ul class="nav navbar-nav"><li class="active"><a href="/index.html">Home</a></li><li><a href="/about">About</a></li><li class="dropdown"><a href="#/" data-toggle="dropdown" class="dropdown-toggle">Dropdown<b class="caret"></b></a><ul class="dropdown-menu"><li class="dropdown-header">Core Code</li><li><a href="/development/index.html">Strongly Typed</a></li><li><a href="/development/web/index.html">Web & Scripts</a></li><li><a href="/development/cloud/index.shtml">Cloud</a></li><li class="divider"></li><li class="dropdown-header">OS and Tools</li><li><a href="/os/index.html">OS</a></li><li><a href="/development/database/index.html">Database</a></li><li><a href="/books/index.html">My Writing</a></li><li class="divider"></li><li class="dropdown-header">Art</li><li><a href="/charlie/Art/index.html">Poems & Photos</a></li><li><a href="/books/reading/index.html">Book Reviews</a></li><li><a href="/spirit/index.html">Spiritual</a></li><li class="divider"></li><li class="dropdown-header">Links</li><li><a href="/charlie/links.html">My Links</a></li><li><a href="http://www.github.com/charliecalvert">GitHub</a></li><li><a href="http://sourceforge.net/projects/elvenware/">Sourceforge</a></li></ul></li></ul></div><!-- /.nav-collapse--></div></div><div class="container"><figure><img alt="Elvenware" src="/charlie/images/elvenwarelogo.png"/></figure><h1>TwitterRefineComments</h1><h3>Table of Contents</h3><ul><!--TOC_Start--><li><a href="#overview">Overview</a></li>
<li><a href="#create-a-timeline-function">Create a Timeline Function</a></li>
<li><a href="#provide-two-paths">Provide Two Paths</a></li>
<li><a href="#debug">Debug</a></li>
<li><a href="#jade-indent">The Giant Jade Search Button</a></li>
<li><a href="#clear-data">Clear Data</a></li>
<li><a href="#match-ids-in-jade-and-javascript">Match IDs in Jade and JavaScript</a></li><!--TOC_End--></ul><h2 id="overview">Overview</h2>
<p>Comments on the Twitter Refine assignment.</p>
<h2 id="create-a-timeline-function">Create a Timeline Function</h2>
<p>When the user clicks on the <strong>Timeline</strong> button, several things should happen. The first is defined by the ID associated with the button:</p>
<pre><code class="lang-javascript"><span class="hljs-tag">button</span><span class="hljs-class">.btn</span><span class="hljs-class">.btn-default</span>#<span class="hljs-function"><span class="hljs-title">getTimeline</span><span class="hljs-params">(type=<span class="hljs-string">'button'</span>)</span></span> Timeline
</code></pre>
<p>As you can see, the ID is called <strong>#getTimeline</strong></p>
<p>We set up an event handler for this button in the <strong>document ready</strong> callback:</p>
<pre><code class="lang-javascript">$(<span class="hljs-built_in">document</span>).ready(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
<span class="hljs-pi">    'use strict'</span>;

    $(<span class="hljs-string">'#getTimeline'</span>).click(getTimeline);
    $(<span class="hljs-string">'#search'</span>).click(search);
});
</code></pre>
<p>The key line, of course, is this one:</p>
<pre><code class="lang-javascript">    <span class="hljs-variable">$(</span><span class="hljs-string">'#getTimeline'</span>).click(getTimeline);
</code></pre>
<p>It states the clicks on the control with the ID <strong>#getTimeline</strong> should be delegated to the <strong>getTimeline</strong> function.</p>
<p>Our implementation for the <strong>getTimeLine</strong> function might look something like this:</p>
<pre><code class="lang-javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getTimeline</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> timeline = $(<span class="hljs-string">"#timelineQuery"</span>).val();
    $.getJSON(<span class="hljs-string">'/time-line'</span>, {<span class="hljs-string">"screen_name"</span>: timeline}, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">result</span>) </span>{
        $(<span class="hljs-string">'#tweetData'</span>).html(<span class="hljs-built_in">JSON</span>.stringify(result, <span class="hljs-literal">null</span>, <span class="hljs-number">4</span>));
        clearControls();
        $.each(result, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">index, tweet</span>) </span>{
            <span class="hljs-keyword">if</span> (tweet.entities.urls.length &gt; <span class="hljs-number">0</span>) {
                appendUrl(<span class="hljs-string">'#tweetList'</span>, index, tweet.text, tweet.entities.urls[<span class="hljs-number">0</span>].url);
            } <span class="hljs-keyword">else</span> {
                renderTable(tweet.text, tweet.user.name);
                $(<span class="hljs-string">'#tweetList'</span>).append(<span class="hljs-string">'&lt;li&gt;'</span> + tweet.text + <span class="hljs-string">'&lt;/li&gt;'</span>);
            }
        });
    });
}
</code></pre>
<h2 id="provide-two-paths">Provide Two Paths</h2>
<p>Some students are correctly detecting that certain records have a URL associated with them, and that other records do not. However, you should provide a path for both cases, not just one.</p>
<p>Consider this code:</p>
<pre><code class="lang-javascript"> $.each(<span class="hljs-literal">result</span>, function(index, tweet) {
    <span class="hljs-keyword">if</span> (tweet.entities.urls.length &gt; <span class="hljs-number">0</span>) {
        appendUrl('<span class="hljs-comment">#tweetList', index, tweet.text, tweet.entities.urls[0].url);</span>
        renderTable(tweet.text, tweet.user.name);
    }
});
</code></pre>
<p>This path is clean, and runs smoothly. However, it only displays those tweets that have a URL. We want to display links that have a URL in one place, and those that don&#39;t in another place. For instance, this is one possible solution:</p>
<pre><code class="lang-javascript">$.each(<span class="hljs-literal">result</span>, function(index, tweet) {
    <span class="hljs-keyword">if</span> (tweet.entities.urls.length &gt; <span class="hljs-number">0</span>) {
        appendUrl('<span class="hljs-comment">#tweetList', index, tweet.text, tweet.entities.urls[0].url);</span>
    } <span class="hljs-keyword">else</span> {
         renderTable(tweet.text, tweet.user.name);
    }
});
</code></pre>
<p>In this case, tweets that have a URL associated with the displayed in the clickable list. The others go in the scrollable table.</p>
<p>Another variation on this same problem looks like this:</p>
<pre><code class="lang-javascript"> $.each(<span class="hljs-literal">result</span>.statuses, function(index, tweet) {
    <span class="hljs-keyword">if</span> (tweet.entities.urls.length &gt; <span class="hljs-number">0</span>) {
        appendUrl(<span class="hljs-string">"#tweetList"</span>, index, tweet.text, tweet.entities.urls[<span class="hljs-number">0</span>].url);
    }
    renderTable(tweet.text, tweet.user.name);
});
</code></pre>
<p>This code renders everything to the table, rather than rendering only the tweets that do not have a link. The fix is the same as above.</p>
<h2 id="debug">Debug</h2>
<p>When running your code, make sure the debug window is open. Consider the image shown below.</p>
<p><img src="https://s3.amazonaws.com/bucket01.elvenware.com/images/debug-bitly-refine-01.png" alt="Debug Twitter"></p>
<p>Notice the following:</p>
<ul>
<li>We are running Chrome/Chromium, not FireFox</li>
<li>The Chrome Developer Tools are open (F12)</li>
<li>We are turned to the <strong>Sources</strong> page</li>
<li>The red circle with the white X at the top right of the Chrome Developer Tools means there is an error</li>
<li>The blue <strong>&gt;_</strong> symbol to the right of the red circle is toggled on (it is blue). When toggled on, this option displays the <strong>console</strong> at the bottom of the dev tools.</li>
<li>The console shows our error, which states that &quot;url&quot; is part of an object that is not defined. We can see that the error is on line 33 of <strong>control.js</strong></li>
<li>The code in the display shows the actual line causing the problem. It is underlined with a red squiggly. Looking at the left of the display we can confirm that it is on line 33.</li>
</ul>
<p>Turning to our editor, and moving to line 33, we can see the complete line of code causing the error:</p>
<pre><code class="lang-javascript">appendUrl(<span class="hljs-string">'#tweetList'</span>, <span class="hljs-keyword">index</span>, tweet.text, tweet.entities.urls[<span class="hljs-number">0</span>].url);
</code></pre>
<p>From the error messages in the dev tools, we now know that <strong>urls[0]</strong> is undefined. This is almost certainly because this particular tweet has no <strong>urls</strong> associated with it. As you know from previous lessons, the fix for this problem is to write something like this:</p>
<pre><code class="lang-javascript"><span class="hljs-tag">if</span> (tweet.entities.urls.length &gt; <span class="hljs-number">0</span>) { ... }
</code></pre>
<p>But my point here is not to provide the fix. It is to emphasize how crucially important it is that you use the debugger. I have come around to help many of you during or after class. As you know, the first thing I do is almost always to turn the debugger on. Without it the task of finding an error becomes much more difficult. We <strong>can</strong> walk from here to Tacoma rather than driving, but it is more difficult. We <strong>can</strong> fix problems in our code without the dev tools, but it is indeed much more difficult.</p>
<h2 id="jade-indent">The Giant Jade Search Button</h2>
<p>Consider this jade:</p>
<pre><code class="lang-javascript">
  +<span class="hljs-function"><span class="hljs-title">elfPanel</span><span class="hljs-params">(<span class="hljs-string">"Debug"</span>, <span class="hljs-string">"panel-default"</span>)</span></span><span class="hljs-class">.elfDiv</span>
    <span class="hljs-tag">button</span><span class="hljs-class">.btn</span><span class="hljs-class">.btn-default</span>#<span class="hljs-function"><span class="hljs-title">getTweets</span><span class="hljs-params">(type=<span class="hljs-string">'button'</span>)</span></span> Get Tweets
    <span class="hljs-tag">button</span><span class="hljs-class">.btn</span><span class="hljs-class">.btn-default</span>#<span class="hljs-function"><span class="hljs-title">search</span><span class="hljs-params">(type=<span class="hljs-string">'button'</span>)</span></span> Search

      <span class="hljs-tag">div</span>
        pre#tweetData
</code></pre>
<p>The DIV and PRE tags at the end are indented too far. As a result, they are shown as children of the button. This means they became the label for the button. The whole bottom of the screen becomes one gigantic button with hundreds of lines of text on it. Try it. If you see this in your program, try clicking on it. You will see that it is a button!</p>
<p>The fix is to move the DIV and PRE tags to the left.</p>
<p>Here it is, the giant search button:</p>
<p><img src="https://s3.amazonaws.com/bucket01.elvenware.com/images/giant-search-button.png" alt="GiantSearchButton"></p>
<p><strong>Image</strong>: <em>The Giant Seach Button</em></p>
<h2 id="clear-data">Clear Data</h2>
<p>Before you fill in the table, you should clear any data that might already be in it. Otherwise our code continually appends code to the table. It is unlikely the user would even know this is happening since the new rows are not visible. We can only see four or five rows at a time, so if you append data down on the 25th row, for instance, the user won&#39;t be able to see it.</p>
<p>There are several reasonable solutions to this problem. One simple fix might be to write code like this:</p>
<pre><code class="lang-javascript">renderTable: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">links</span>) </span>{
<span class="hljs-pi">    'use strict'</span>;
    $(<span class="hljs-string">"#tableLinks"</span>).empty();
    $.each(links, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">index, link</span>) </span>{ 

    <span class="hljs-comment">// Code omitted here...</span>
},
</code></pre>
<p>The call to empty ensures that the any data appended to the table will at least begin on row 1. This ensures that at least the first few rows of data are visible, and that the user is given a visual cue that something has changed.</p>
<h2 id="match-ids-in-jade-and-javascript">Match IDs in Jade and JavaScript</h2>
<p>Suppose you declare a button with an id of <strong>getTimeLine</strong>:</p>
<pre><code class="lang-jade">    <span class="hljs-tag">button</span><span class="hljs-class">.btn</span><span class="hljs-class">.btn-default</span>#<span class="hljs-function"><span class="hljs-title">getTimeline</span><span class="hljs-params">(type=<span class="hljs-string">'button'</span>)</span></span> Timeline
</code></pre>
<p>Then suppose you tried to set up an event handler for that button with code that looks like this:</p>
<pre><code class="lang-javascript">$(<span class="hljs-string">'#timeline'</span>).<span class="hljs-function"><span class="hljs-title">click</span><span class="hljs-params">(timeline)</span></span>
</code></pre>
<p>This is never going to work because the ID specified in the javascript code and the ID specified in the jade are different: <strong>getTimeLine</strong> vs <strong>timeLine</strong>.</p>
<p>The fix would be to match the two IDs:</p>
<pre><code class="lang-javascript"><span class="hljs-variable">$(</span><span class="hljs-string">'#timeline'</span>).click(getTimeline);
</code></pre>
<p>Here I show the jQuery for setting up the button handler in the <strong>document ready</strong> function which is where it frequently goes:</p>
<pre><code class="lang-javascript">$(<span class="hljs-built_in">document</span>).ready(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
<span class="hljs-pi">    'use strict'</span>;
    $(<span class="hljs-string">'#search'</span>).click(search);
    $(<span class="hljs-string">'#timeline'</span>).click(getTimeline);
});
</code></pre>
</div></body></html>