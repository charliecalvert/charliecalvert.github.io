<!DOCTYPE html><html lang="en" dir="ltr"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width initial-scale=1.0"><title>BitlyInteractiveComments</title><link rel="shortcut icon" href="/charlie/images/favicon.png"><!-- Latest compiled and minified CSS--><link rel="stylesheet" href="/components/bootstrap/dist/css/bootstrap.min.css"><!-- Optional theme--><link rel="stylesheet" href="/components/bootstrap/dist/css/bootstrap-theme.min.css"><!-- link(href='/libs/css/BootstrapIndex.css', rel='stylesheet', type='text/css')--><link href="/css/style.css" rel="stylesheet" type="text/css"><link href="/css/highlight/googlecode.css" rel="stylesheet" type="text/css"><script src="/components/jquery/dist/jquery.js"></script><script src="/components/angular/angular.js"></script><script src="/components/angular-route/angular-route.js"></script><script src="/components/bootstrap/dist/js/bootstrap.min.js"></script><!-- script(src='/libs/scripts/elvenware.js', type='text/javascript')--><!-- script(src="/libs/scripts/Control.js")--><!-- script(src='http://localhost:35729/livereload.js')--></head><body><div class="navbar navbar-inverse"><div class="container"><div class="navbar-header"><button type="button" data-toggle="collapse" data-target=".navbar-collapse" class="navbar-toggle"><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><a href="/" class="navbar-brand">Elvenware</a></div><div class="collapse navbar-collapse"><ul class="nav navbar-nav"><li class="active"><a href="/index.html">Home</a></li><li><a href="/about">About</a></li><li class="dropdown"><a href="#/" data-toggle="dropdown" class="dropdown-toggle">Dropdown<b class="caret"></b></a><ul class="dropdown-menu"><li class="dropdown-header">Core Code</li><li><a href="/development/index.html">Strongly Typed</a></li><li><a href="/development/web/index.html">Web & Scripts</a></li><li><a href="/development/cloud/index.shtml">Cloud</a></li><li class="divider"></li><li class="dropdown-header">OS and Tools</li><li><a href="/os/index.html">OS</a></li><li><a href="/development/database/index.html">Database</a></li><li><a href="/books/index.html">My Writing</a></li><li class="divider"></li><li class="dropdown-header">Art</li><li><a href="/charlie/Art/index.html">Poems & Photos</a></li><li><a href="/books/reading/index.html">Book Reviews</a></li><li><a href="/spirit/index.html">Spiritual</a></li><li class="divider"></li><li class="dropdown-header">Links</li><li><a href="/charlie/links.html">My Links</a></li><li><a href="http://www.github.com/charliecalvert">GitHub</a></li><li><a href="http://sourceforge.net/projects/elvenware/">Sourceforge</a></li></ul></li></ul></div><!-- /.nav-collapse--></div></div><div class="container"><figure><img alt="Elvenware" src="/charlie/images/elvenwarelogo.png"/></figure><h1>BitlyInteractiveComments</h1><h3>Table of Contents</h3><ul><!--TOC_Start--><li><a href="#week06-bitlyinteractive">Week06-BitlyInteractive</a></li>
<li><a href="#links">Links</a></li>
<li><a href="#separate-files">Source in Separate Files</a></li>
<li><a href="#Switch Source">Switching Sources</a></li>
<li><a href="#switch-source-improved">Improved Switch Source</a></li>
<li><a href="#icon-missing">Fav-Icon Missing - 404</a></li>
<li><a href="#package-start">Careful in package.json</a></li>
<li><a href="#iterate">Iterating Past the End of the Array</a></li>
<li><a href="#test-with-chrome">Test with Chrome</a></li>
<li><a href="#calling-showrecord">Calling ShowRecord</a></li><!--TOC_End--></ul><h1 id="week06-bitlyinteractive">Week06-BitlyInteractive</h1>
<p>by Charlie Calvert</p>
<h2 id="links">Links</h2>
<ul>
<li><a href="http://www.tutorialrepublic.com/twitter-bootstrap-tutorial/bootstrap-forms.php">Forms</a></li>
<li><a href="https://github.com/jadejs/jade/issues/1248">Jade Code</a></li>
<li><a href="http://learnlayout.com/position-example.html">Learn-Layout</a></li>
</ul>
<h2 id="separate-files">Source in Separate Files</h2>
<p>You should create three files called:</p>
<ul>
<li>downloads.js</li>
<li>movements.js</li>
<li>control.js</li>
</ul>
<p>Then be sure to load each of them in <strong>layout.jade</strong>:</p>
<pre><code class="lang-jade">doctype html
html
  head
    meta(<span class="hljs-name">charset=</span>'UTF-8')
    meta(<span class="hljs-name">name=</span>'viewport', content='width=device-width')
    title= title
    link(<span class="hljs-name">rel=</span>'stylesheet', href='/stylesheets/style.css')
    link(<span class="hljs-name">rel=</span>'stylesheet', href='/components/bootstrap/dist/css/bootstrap.css')
    script(<span class="hljs-name">src=</span><span class="hljs-string">"components/jquery/dist/jquery.js"</span>)
    script(<span class="hljs-name">src=</span><span class="hljs-string">"components/bootstrap/dist/js/bootstrap.js"</span>)
    script(<span class="hljs-name">src=</span><span class="hljs-string">"javascripts/control.js"</span>)
    script(<span class="hljs-name">src=</span><span class="hljs-string">"javascripts/downloads.js"</span>)
    script(<span class="hljs-name">src=</span><span class="hljs-string">"javascripts/movement.js"</span>)
  body
    block content
</code></pre>
<p>You should not put all your code in <em>control.js</em>. Instead you should break the objects out into separate files, with <strong>elfDownloads</strong> in <strong>downloads.js</strong>, etc.</p>
<h2 id="Switch Source">Switching Sources</h2>
<p>We have two buttons that allow us to switch between the local and remote data.</p>
<p>As Jade:</p>
<pre><code class="lang-jade"><span class="hljs-selector-tag">div</span><span class="hljs-selector-class">.col-sm-6</span>
    +elfRadioPanel(<span class="hljs-string">"Radio Buttons"</span>, <span class="hljs-string">"dataSource"</span>)
        +elfRadio(<span class="hljs-string">"Local Data"</span>, <span class="hljs-string">"localData"</span>)
        +elfRadio(<span class="hljs-string">"Cloud Data"</span>, <span class="hljs-string">"cloudData"</span>)
</code></pre>
<p>As HTML:</p>
<pre><code class="lang-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">role</span>=<span class="hljs-string">"group"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"radio"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">"#radioButtonDisplay01"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"radio"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"radio"</span>
                   <span class="hljs-attr">value</span>=<span class="hljs-string">"#radioButtonDisplay01"</span>
                   <span class="hljs-attr">id</span>=<span class="hljs-string">"#radioButtonDisplay01"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>Local Data<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"radio"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">"#radioButtonDisplay02"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"radio"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"radio"</span>
                   <span class="hljs-attr">value</span>=<span class="hljs-string">"#radioButtonDisplay02"</span>
                   <span class="hljs-attr">id</span>=<span class="hljs-string">"#radioButtonDisplay02"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>Cloud Data<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</code></pre>
<p>If you select one of the radio buttons, the following code gets called in <strong>downloads.js</strong>:</p>
<pre><code class="lang-javascript">downloads.dataTypes = [<span class="hljs-string">'dtLocal'</span>, <span class="hljs-string">'dtCloud'</span>];

downloads.dataType = downloads.dataTypes[<span class="hljs-number">0</span>];

downloads.dataTypeSelection = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
<span class="hljs-meta">    'use strict'</span>;
    <span class="hljs-keyword">if</span> ($(<span class="hljs-string">'#localData'</span>).is(<span class="hljs-string">':checked'</span>)) {
        $(<span class="hljs-string">'#radioButtonDisplay01'</span>).html(<span class="hljs-string">'You clicked localData '</span>);
        downloads.dataType = downloads.dataTypes[<span class="hljs-number">0</span>];
    } <span class="hljs-keyword">else</span> {
        $(<span class="hljs-string">'#radioButtonDisplay01'</span>).html(<span class="hljs-string">'You clicked cloudData '</span>);
        downloads.dataType = downloads.dataTypes[<span class="hljs-number">1</span>];
    }
};
</code></pre>
<p>Recall that the <strong>dataTypeSelection</strong> method won&#39;t get called unless you hook it up to your <strong>radio</strong> buttons:</p>
<pre><code class="lang-javascript">$(<span class="hljs-string">'#dataSource'</span>).<span class="hljs-built_in">click</span>(downloads.dataTypeSelection);
</code></pre>
<p>This bit of <strong>jquery</strong> belongs in the <strong>document ready</strong> callback in <strong>control.js</strong>.</p>
<p>It sets the data type to either <strong>dtLocal</strong> or <strong>dtCloud</strong>. When the user clicks the button to download the data, the following code gets called:</p>
<pre><code class="lang-javascript">downloads.getBitlyData = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
<span class="hljs-meta">    'use strict'</span>;
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.dataType === <span class="hljs-keyword">this</span>.dataTypes[<span class="hljs-number">0</span>]) {
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'getBitlyData called: '</span>, <span class="hljs-keyword">this</span>.dataTypes[<span class="hljs-number">0</span>]);
        bitlyUrlParser.getBitlyLinks(<span class="hljs-number">-1</span>);
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.dataType === <span class="hljs-keyword">this</span>.dataTypes[<span class="hljs-number">1</span>]) {
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'getBitlyData called: '</span>, <span class="hljs-keyword">this</span>.dataTypes[<span class="hljs-number">1</span>]);
        bitlyUrlParser.getBitlyLinks(downloads.accessToken);
    }
};
</code></pre>
<p>If the <strong>dataType</strong> is set to <strong>dtLocal</strong> then we call <strong>getBitlyLinks</strong> with <strong>-1</strong>:</p>
<pre><code class="lang-javascript">bitlyUrlParser.getBitlyLinks(<span class="hljs-number">-1</span>);
<span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.dataType === <span class="hljs-keyword">this</span>.dataTypes[<span class="hljs-number">0</span>]) {
</code></pre>
<p>Otherwise we call it with our <strong>accessToken</strong> from the Bitly site:</p>
<pre><code class="lang-javascript"><span class="hljs-selector-tag">bitlyUrlParser</span><span class="hljs-selector-class">.getBitlyLinks</span>(<span class="hljs-selector-tag">downloads</span><span class="hljs-selector-class">.accessToken</span>);
</code></pre>
<p>In <strong>control.js</strong> we form the URL our download based on the argument passed to us:</p>
<pre><code class="lang-javascript">getUrl: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">accessToken</span>) </span>{
<span class="hljs-meta">    'use strict'</span>;

    <span class="hljs-keyword">var</span> baseUrl = <span class="hljs-string">'https://api-ssl.bitly.com/v3/user/link_history'</span>;
    <span class="hljs-keyword">var</span> params = <span class="hljs-string">'?access_token='</span>;

    <span class="hljs-keyword">if</span> (accessToken === <span class="hljs-number">-1</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-string">'data/bitly-links.json'</span>;
    } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">var</span> url = baseUrl + params;
        <span class="hljs-keyword">return</span> url += accessToken;
    }
},
</code></pre>
<p>If the argument is <strong>-1</strong> then we get the local URL pointing to the copy of our JSON file which is in the <strong>data</strong> directory. Otherwise we compose a URL that points at the Bitly cloud service.</p>
<h2 id="switch-source-improved">Improved Switch Source</h2>
<p>My code shown in the previous section was flawed because I was using <strong>magic numbers</strong>. In the uses, the word magic has negative connotations. When we talk about <strong>magic numbers</strong> we are referring to numbers in our code that have no inherent meaning, no semantic value. They are just numbers that can only be understood by studying the code. But ideally, the person who maintains our code should not have to study our code to understand it. They should be able to just read it.</p>
<p>In particular, there are places in my code where I was writing things like:</p>
<pre><code class="lang-javascript">    <span class="hljs-keyword">if</span> <span class="hljs-comment">(accessToken === -1)</span> {
</code></pre>
<p>The values <strong>-1</strong> and <strong>0</strong> have no semantic value. They are just numbers which <em>magically</em> mean things like <strong>get the local file</strong> or <em>index</em> into the array to get the local or cloud value.</p>
<p>The following changes replace my magic numbers with meaningful variables that have semantic value. In <strong>downloads.js</strong>, here are two updated properties and two updated methods:</p>
<pre><code class="lang-javascript">downloads.dataTypes = {<span class="hljs-string">'dtLocal'</span>: <span class="hljs-number">0</span>, <span class="hljs-string">'dtCloud'</span>: <span class="hljs-number">1</span>};

downloads.dataType = downloads.dataTypes.dtLocal;

downloads.dataTypeSelection = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
<span class="hljs-meta">    'use strict'</span>;
    <span class="hljs-keyword">if</span> ($(<span class="hljs-string">'#localData'</span>).is(<span class="hljs-string">':checked'</span>)) {
        $(<span class="hljs-string">'#radioButtonDisplay01'</span>).html(<span class="hljs-string">'You clicked localData '</span>);
        downloads.dataType = downloads.dataTypes.dtLocal;
    } <span class="hljs-keyword">else</span> {
        $(<span class="hljs-string">'#radioButtonDisplay01'</span>).html(<span class="hljs-string">'You clicked cloudData '</span>);
        downloads.dataType = downloads.dataTypes.dtCloud;
    }
};

downloads.getBitlyData = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
<span class="hljs-meta">    'use strict'</span>;
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'getBitlyData called: '</span>, <span class="hljs-built_in">Object</span>.keys[downloads.dataType]);
    bitlyUrlParser.getBitlyLinks(downloads.dataType);
};
</code></pre>
<p>Notice the improvement. Before I wrote:</p>
<pre><code class="lang-javascript">downloads.dataType = downloads.dataTypes<span class="hljs-string">[0]</span>;
</code></pre>
<p>This code is flawed because it contains a magic number. What does the value <strong>0</strong> mean? It has no obvious semantic value. You have to study the code to discern its meaning. Now I write:</p>
<pre><code class="lang-javascript">downloads.dataType = downloads.dataTypes.dtLocal<span class="hljs-comment">;</span>
`
</code></pre>
<p>The property of <strong>dataTypes</strong> called <strong>dtLocal</strong> is much easier to understand than a <strong>magic number</strong> like <strong>0</strong> or <strong>1</strong>.</p>
<p>And here are the changes to control.js. Near the top&gt;</p>
<pre><code class="lang-javascript">
    getUrl: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">accessToken</span>) </span>{
<span class="hljs-meta">        'use strict'</span>;

        <span class="hljs-keyword">var</span> cloudBaseUrl = <span class="hljs-string">'https://api-ssl.bitly.com/v3/user/link_history'</span>;
        <span class="hljs-keyword">var</span> cloudParams = <span class="hljs-string">'?access_token='</span>;
        <span class="hljs-keyword">var</span> localUrl = <span class="hljs-string">'data/bitly-links.json'</span>;

        <span class="hljs-keyword">if</span> (accessToken === downloads.dataTypes.dtLocal) {
            <span class="hljs-keyword">return</span> localUrl;
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">return</span> baseUrl + params + downloads.accessToken;
        }
    },
</code></pre>
<p>And near the bottom:</p>
<pre><code class="lang-javascript">$(<span class="hljs-built_in">document</span>).ready(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
<span class="hljs-meta">    'use strict'</span>;
    $(<span class="hljs-string">'#localData'</span>).prop(<span class="hljs-string">'checked'</span>, <span class="hljs-literal">true</span>);
    bitlyUrlParser.getBitlyLinks(downloads.dataTypes.dtLocal);
    $(<span class="hljs-string">'#dataSource'</span>).click(downloads.dataTypeSelection);
});
</code></pre>
<p>Notice improvement. Before I wrote:</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">if</span> (accessToken === <span class="hljs-number">-1</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-string">'data/bitly-links.json'</span><span class="hljs-comment">;</span>
} <span class="hljs-keyword">else</span> {
    var url = baseUrl + params<span class="hljs-comment">;</span>
    <span class="hljs-keyword">return</span> url += accessToken<span class="hljs-comment">;</span>
}
</code></pre>
<p>What the heck does <strong>-1</strong> mean? That number has no inherent semantic value. Now I write:</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">if</span> (accessToken === downloads.dataTypes.dtLocal) {
    <span class="hljs-keyword">return</span> localUrl<span class="hljs-comment">;</span>
} <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">return</span> baseUrl + params + downloads.accessToken<span class="hljs-comment">;</span>
}
</code></pre>
<p>Instead of <strong>-1</strong>, we have <strong>dtLocal</strong>, which is much easier to understand.</p>
<p><strong>NOTE</strong>: <em>Nearly everyone writes careless code like the code in my original version of the assignment. The point is not that we never write bad code, but that we take the time to go over our code and clean up the ugly parts.</em></p>
<h2 id="icon-missing">Fav-Icon Missing - 404</h2>
<p>Sometimes, on startup, you get an error about your favorite icon missing. I believe the <strong>CreateExpressProject</strong> script will put a 32 X 32 image file called called <strong>favicon.png</strong> in your <strong>public</strong> directory. You need to open <strong>app.js</strong>. Around line 17 you will find this code:</p>
<pre><code class="lang-javascript">// uncomment <span class="hljs-keyword">after</span> placing your favicon <span class="hljs-keyword">in</span> /public
//app.<span class="hljs-keyword">use</span>(favicon(path.join(__dirname, <span class="hljs-symbol">'public</span>', <span class="hljs-symbol">'favicon</span>.ico')));
</code></pre>
<p>Uncomment the second line and change <strong>favicon.ico</strong> to <strong>favicon.png</strong>.</p>
<pre><code class="lang-javascript"><span class="hljs-comment">// uncomment after placing your favicon in /public</span>
app.<span class="hljs-keyword">use</span>(favicon(path.join(__dirname, <span class="hljs-string">'public'</span>, <span class="hljs-string">'favicon.png'</span>)));
</code></pre>
<p>Now the error should go away. You can use any image editor you want to modify the <strong>favicon.png</strong> file. On Linux, the tool of choice is called <strong>gimp</strong>, but simpler tools will probably a do simple job like this just as well.</p>
<h2 id="package-start">Careful in package.json</h2>
<p>One student made an interesting mistake in their <strong>package.json</strong>. They copied the <strong>package.json</strong> file from <strong>Week04-JavaScriptObjects</strong>:</p>
<pre><code class="lang-javascript">{
    <span class="hljs-string">"name"</span>: <span class="hljs-string">"week06-BitlyInteractive"</span>,
    <span class="hljs-string">"version"</span>: <span class="hljs-string">"1.0.0"</span>,
    <span class="hljs-string">"description"</span>: <span class="hljs-string">"\"</span>Learn about jscs <span class="hljs-literal">and</span> grunt\<span class="hljs-string">""</span>,
    <span class="hljs-string">"main"</span>: <span class="hljs-string">"work.js"</span>,
    <span class="hljs-string">"scripts"</span>: {
        <span class="hljs-string">"start"</span>: <span class="hljs-string">"nodemon work.js"</span>,
        <span class="hljs-string">"test"</span>: <span class="hljs-string">"grunt test"</span>
    },
    etc...
</code></pre>
<p>In and of itself, that is a reasonable thing to do. However, they failed to see that <strong>nodemon work.js</strong> is correct for the JavaScriptObjects project, but not for this project. It should be:</p>
<pre><code><span class="hljs-attribute">nodemon</span> bin/www
</code></pre><h2 id="iterate">Iterating Past the End of the Array</h2>
<p>Don&#39;t allow your buttons to iterate past the end of your array. Here is one way to check for that condition in <strong>movement.js</strong>:</p>
<pre><code class="lang-javascript">    right: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
<span class="hljs-meta">        'use strict'</span>;
        <span class="hljs-keyword">var</span> history = bitlyUrlParser.getLinkHistoryArray();
        <span class="hljs-keyword">if</span> (bitlyUrlParser.linkIndex &lt; (history.length - <span class="hljs-number">1</span>)) {
            bitlyUrlParser.linkIndex += <span class="hljs-number">1</span>;
            bitlyUrlParser.display();
        }
    }
</code></pre>
<p>And here is <strong>getLinkHistoryArray</strong>:</p>
<pre><code class="lang-javascript">getLinkHistoryArray: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
<span class="hljs-meta">    'use strict'</span>;
    <span class="hljs-keyword">return</span> bitlyUrlParser.bitlyLinks.data.link_history;
},
</code></pre>
<p>When the user wants to move left, wants to iterate backwards through the data, our only concern is that we don&#39;t move past the beginning of our array:</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">if</span> <span class="hljs-comment">(bitlyUrlParser.linkIndex &gt; 0)</span> {
    etc...
</code></pre>
<h2 id="test-with-chrome">Test with Chrome</h2>
<p>Make sure the karma chrome launcher is available:</p>
<pre><code>npm install karma-chrome-launcher --<span class="hljs-built_in">save</span>-<span class="hljs-built_in">dev</span>
</code></pre><p>Replace PhantomJS with Chrome:</p>
<pre><code>sed -<span class="hljs-selector-tag">i</span> -- <span class="hljs-string">"s/browsers: \['PhantomJS'\]/browsers: \['Chrome'\]/"</span> karma<span class="hljs-selector-class">.conf</span><span class="hljs-selector-class">.js</span>
sed -<span class="hljs-selector-tag">i</span> -- <span class="hljs-string">"s/karma-phantomjs-launcher/karma-chrome-launcher/"</span> karma<span class="hljs-selector-class">.conf</span><span class="hljs-selector-class">.js</span>
</code></pre><h2 id="calling-showrecord">Calling ShowRecord</h2>
<p>Since we call showRecord in our <strong>display</strong> method, then we are also going to have to declare and implement <strong>showRecord</strong> in the same object:</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">var</span> bitlyUrlParser = {

    <span class="hljs-comment">// CODE OMITTED HERE</span>

    display: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
<span class="hljs-meta">        'use strict'</span>;
        <span class="hljs-keyword">var</span> index = <span class="hljs-keyword">this</span>.linkIndex;
        <span class="hljs-keyword">var</span> bitlyLink = <span class="hljs-keyword">this</span>.getLinkHistoryItem(index);
        <span class="hljs-keyword">this</span>.showRecord(bitlyLink);
    },

    <span class="hljs-comment">// CODE OMITTED HERE</span>

    showRecord: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">bitlyLink</span>) </span>{
<span class="hljs-meta">        'use strict'</span>;
        <span class="hljs-keyword">if</span> (bitlyLink.private) {
            $(<span class="hljs-string">'#checkBoxPrivate'</span>).prop(<span class="hljs-string">'checked'</span>, <span class="hljs-literal">true</span>);
        }
        etc ...
    }
}
</code></pre>
<p>In our case, we could also implement <strong>display</strong> like this:</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">var</span> bitlyUrlParser = {

    <span class="hljs-comment">// CODE OMITTED HERE</span>

    display: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
<span class="hljs-meta">        'use strict'</span>;
        <span class="hljs-keyword">var</span> index = bitlyUrlParser.linkIndex;
        <span class="hljs-keyword">var</span> bitlyLink = bitlyUrlParser.getLinkHistoryItem(index);
        bitlyUrlParser.showRecord(bitlyLink);
    },

    <span class="hljs-comment">// CODE OMITTED HERE</span>
}
</code></pre>
</div></body></html>