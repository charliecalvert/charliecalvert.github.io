<!DOCTYPE html><html lang="en" dir="ltr"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width initial-scale=1.0"><title>Week09-ClickRoutes</title><link rel="shortcut icon" href="/charlie/images/favicon.png"><!-- Latest compiled and minified CSS--><link rel="stylesheet" href="/components/bootstrap/dist/css/bootstrap.min.css"><!-- Optional theme--><link rel="stylesheet" href="/components/bootstrap/dist/css/bootstrap-theme.min.css"><!-- link(href='/libs/css/BootstrapIndex.css', rel='stylesheet', type='text/css')--><link href="/css/style.css" rel="stylesheet" type="text/css"><link href="/css/highlight/googlecode.css" rel="stylesheet" type="text/css"><script src="/components/jquery/dist/jquery.js"></script><script src="/components/angular/angular.js"></script><script src="/components/angular-route/angular-route.js"></script><script src="/components/bootstrap/dist/js/bootstrap.min.js"></script><!-- script(src='/libs/scripts/elvenware.js', type='text/javascript')--><script src="/libs/scripts/Control.js"></script><!-- script(src='http://localhost:35729/livereload.js')--></head><body><div class="navbar navbar-inverse"><div class="container"><div class="navbar-header"><button type="button" data-toggle="collapse" data-target=".navbar-collapse" class="navbar-toggle"><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><a href="/" class="navbar-brand">Elvenware</a></div><div class="collapse navbar-collapse"><ul class="nav navbar-nav"><li class="active"><a href="/index.html">Home</a></li><li><a href="/charlie/About.html">About</a></li><li class="dropdown"><a href="#/" data-toggle="dropdown" class="dropdown-toggle">Dropdown<b class="caret"></b></a><ul class="dropdown-menu"><li class="dropdown-header">Core Code</li><li><a href="/charlie/development/index.html">Strongly Typed</a></li><li><a href="/charlie/development/web/index.html">Web & Scripts</a></li><li><a href="/charlie/development/cloud/index.shtml">Cloud</a></li><li class="divider"></li><li class="dropdown-header">OS and Tools</li><li><a href="/os/index.html">OS</a></li><li><a href="/charlie/development/database/index.html">Database</a></li><li><a href="/books/index.html">My Writing</a></li><li class="divider"></li><li class="dropdown-header">Art</li><li><a href="/charlie/Art/index.html">Poems & Photos</a></li><li><a href="/books/reading/index.html">Book Reviews</a></li><li><a href="/spirit/index.html">Spiritual</a></li><li class="divider"></li><li class="dropdown-header">Links</li><li><a href="/charlie/links.html">My Links</a></li><li><a href="http://www.github.com/charliecalvert">GitHub</a></li><li><a href="http://sourceforge.net/projects/elvenware/">Sourceforge</a></li></ul></li></ul></div><!-- /.nav-collapse--></div></div><div class="container"><figure><img alt="Elvenware" src="/charlie/images/elvenwarelogo.png"/></figure><h1>Week09-ClickRoutes</h1><p>Table of Contents</p><ul><!--TOC_Start--><li><a href="#click-route">Click Route</a></li>
<li><a href="#requirejs">RequireJs</a></li>
<li><a href="#step01">Step01 - Copy the project to your repository</a></li>
<li><a href="#step02">Step02 - Server Side</a></li>
<li><a href="#step03">Step03 - Client Side</a></li>
<li><a href="#step04">Step04 - Parse the data</a></li>
<li><a href="#sample-interface">Sample Interface</a></li>
<li><a href="#step05">Step05: Turn it In</a></li>
<li><a href="#hints">Hints</a></li><!--TOC_End--></ul><h1 id="click-route">Click Route</h1>
<p>Information on routes and Express is available here:</p>
<ul>
<li><a href="http://bit.ly/noderoutes">http://bit.ly/noderoutes</a></li>
</ul>
<p>I have created a project named <strong>ClickRoute</strong> and made it available for from the <strong>elven-assignments</strong> repository:</p>
<pre><code><span class="hljs-string">https:</span><span class="hljs-comment">//github.com/charliecalvert/elven-assignments</span>
</code></pre><p>Clone the repository:</p>
<p>   git clone <a href="https://github.com/charliecalvert/elven-assignments.git">https://github.com/charliecalvert/elven-assignments.git</a></p>
<p><strong>NOTE</strong>: <em>This repository used to be called <strong>Prog272-Assignments</strong>. This particular project was created with <strong>express ClickRoute</strong> rather than <strong>yo express</strong>. As a result, you should start it with <strong>npm start</strong> or <strong>node bin/www</strong> or, better, <strong>nodemon bin/www</strong>.</em></p>
<h2 id="requirejs">RequireJs</h2>
<p>This project uses <a href="http://requirejs.org">RequireJs</a>. We have not used this technology yet, but most large applications use it, or some similar system. I have a description of it here:</p>
<ul>
<li><a href="http://www.elvenware.com/charlie/development/web/JavaScript/Require.html">Requirejs on Elvenware</a></li>
</ul>
<p>To use it, first put requirejs in <strong>layout.jade</strong>:</p>
<pre><code class="lang-text">doctype <span class="hljs-selector-tag">html</span>
<span class="hljs-selector-tag">html</span>
  head
    title= title
    link(rel=<span class="hljs-string">'stylesheet'</span>, href=<span class="hljs-string">'/stylesheets/style.css'</span>)
    script(src=<span class="hljs-string">"components/requirejs/require.js"</span> data-main=<span class="hljs-string">"javascripts/main"</span>)

  <span class="hljs-selector-tag">body</span>
    block <span class="hljs-attribute">content</span>
</code></pre>
<p>Load the files you want to use in <strong>public/javascripts/main.js</strong>, as described below.</p>
<h2 id="step01">Step01 - Copy the project to your repository</h2>
<p>After you clone or pull the repository. Find the <strong>ClickRoute</strong> project. Copy it to your repository and rename it to reflect our current week. For instance, <strong>Week04-ClickRoute</strong>.</p>
<p><strong>NOTE</strong>: <em>Remember you can copy files from the bash shell with a command similar to this:</em></p>
<pre><code>cp -r ClickRoute ~<span class="hljs-regexp">/Git/</span>prog272-lastName-<span class="hljs-number">2016</span><span class="hljs-regexp">/Week04-ClickRoute/</span>
</code></pre><p>Let&#39;s include <strong>$(document).ready(callback)</strong> or <a href="http://requirejs.org/docs/api.html#pageload">DomReady</a> in <strong>Main.js</strong>:</p>
<pre><code><span class="hljs-built_in">require</span>([<span class="hljs-string">'jquery'</span>, <span class="hljs-string">'ClickEvents'</span>], <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">$, ClickEvents</span>) </span>{
<span class="hljs-meta">    'use strict'</span>;

    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'Main called'</span>);
    $(<span class="hljs-built_in">document</span>).ready(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> clickEvents = <span class="hljs-keyword">new</span> ClickEvents();
    });
});
</code></pre><p>And if we want to use jquery in <strong>click-routes.js</strong>, then be sure to include it at the top of that file:</p>
<pre><code>define([<span class="hljs-string">"jquery"</span>], <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">($)</span> </span>{<span class="hljs-string">'use strict'</span>;
</code></pre><p>If you skip this latter step, then the program will still run without error, but jquery events may not be fired until you press refresh.</p>
<h2 id="step02">Step02 - Server Side</h2>
<p>Define three routes in <strong>routes/index.js</strong>. The routes are as follows:</p>
<ul>
<li>/Item01</li>
<li>/Item02</li>
<li>/Item03</li>
</ul>
<p>Here for instance, is a route for Item01 as found in <strong>routes/index.js</strong>:</p>
<pre><code>router.get('/<span class="hljs-type">Item01</span>', function(request, response) {
    <span class="hljs-keyword">var</span> <span class="hljs-literal">result</span> = { <span class="hljs-string">"result"</span>: <span class="hljs-string">"Success"</span> };
    response.send(<span class="hljs-literal">result</span>);
});
</code></pre><p>Create similar routes in the same file for <strong>Item02</strong> and <strong>Item03</strong>. For now, that means you should repeat the code shown above, but with slight variations. (There are other ways to handle this sort of thing, but this will do for now.</p>
<p>Change the <strong>result</strong> object literal so that it has three properties:</p>
<ul>
<li>result</li>
<li>route</li>
<li>message</li>
</ul>
<p>The object you return should now have three properties:</p>
<ul>
<li>Set the <strong>result</strong> property to <strong>Success</strong> as shown above.</li>
<li>Set a new property called <strong>route</strong> to the name of the route, such as <strong>/Item01</strong>.</li>
<li>Set a new property called <strong>message</strong> to the string <strong>The server sent me.</strong></li>
</ul>
<p>Again, this means your declaration for this result object in <strong>routes/index.js</strong> will change. To give a very broad hint, consider the following bit of pseudo-code:</p>
<pre><code>    <span class="hljs-keyword">var</span> <span class="hljs-literal">result</span> = { <span class="hljs-string">"result"</span>: <span class="hljs-string">"Success"</span> <span class="hljs-type">WHAT</span> <span class="hljs-type">GOES</span> <span class="hljs-type">HERE</span>? };
</code></pre><p>On the client side, you will need parsing the JSON you receive from the server. The three properties should be displayed to the user exactly as you define in them. In other words the value of the properties you define in <strong>routes/index.js</strong> should appear verbatim on your HTML page at run time. When you click on <strong>Item 1</strong>, we should see all three properties for <strong>Item01</strong>, when you click on <strong>Item02</strong>, we should see all three properties of <strong>Item02</strong>, etc.</p>
<p><strong>Remember</strong>: <em>Put your routes in /routes/index.js</em></p>
<h2 id="step03">Step03 - Client Side</h2>
<p>Open up <strong>click-event.js</strong> and look for the listClick method:</p>
<pre><code><span class="hljs-keyword">var</span> listClick = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(event)</span> </span>{
    <span class="hljs-keyword">var</span> clickText = event.target.innerHTML; <span class="hljs-comment">// was innerText</span>
};
</code></pre><p>This method is called whenever the user clicks on one of the list items in the unordered list found on the site&#39;s web page.</p>
<p>From inside this one method, I want you to call <a href="http://www.elvenware.com/charlie/development/web/JavaScript/JQueryBasic.html#getJSON">getJSON</a>. As you remember, getJSON looks a bit like this:</p>
<pre><code>$.getJSON('/SOME_ROUTE, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(DATA_FROM_SERVER)</span> {</span>
    <span class="hljs-comment">// Do something such as: $(SOME_SELECTOR).html(DATA_FROM_SERVER);</span>
});
</code></pre><p>I want you to dynamically change <strong>/SOME_ROUTE</strong> depending on what list item the user clicked. If they clicked on <strong>Item01</strong>, then set the route to <strong>/Item01</strong>. This should call the appropriate route that you set up on the server in the previous step. There are multiple ways to solve this problem, but it would be nice if you only had to call <strong>getJSON</strong> once. In other words, set the string to pass as the route, then pass that string in the first parameter to <strong>getJSON</strong>:</p>
<pre><code class="lang-javascript">    <span class="hljs-keyword">var</span> theRoute = <span class="hljs-comment">// Define the route based on the information you already have</span>
    $.getJSON(theRoute, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">result</span>) </span>{
         <span class="hljs-comment">// CODE OMITTED HERE</span>
    });
</code></pre>
<p>The route is the name of the method on the server side that you want to call. For instance, to call the method on the server side that I give you above, the route would be the string <strong>/Item01</strong>.</p>
<h2 id="step04">Step04 - Parse the data</h2>
<p>When you called <strong>response.send</strong> back on the server, you sent an object from the client to the server. On the client side, this object is passed to the <strong>getJSON</strong> callback:</p>
<pre><code class="lang-javascript">    $.getJSON(<span class="hljs-string">'/SOME_ROUTE'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">DATA_FROM_SERVER</span>) </span>{
      <span class="hljs-comment">// CODE OMITTED HERE</span>
    });
</code></pre>
<p>Parse the data sent from the server and display it to the user in three paragraph tags that appear on your HTML page. In Jade, that will look like this:</p>
<pre><code class="lang-text">p<span class="hljs-selector-id">#result</span>
p<span class="hljs-selector-id">#route</span>
p#message
</code></pre>
<p>Inside the call to <strong>getJSON</strong>, use jQuery to set each of these paragraphs to one of the properties from the object sent by your server.</p>
<p><strong>Hint</strong>: <em>Compare the ID&#39;s shown above to the properties of the object you set up in <a href="#step02">Step02</a></em>.</p>
<p>When you are done, the app should respond to clicks on the list items as follows:</p>
<ul>
<li>Call <strong>getJSON</strong> to invoke a route on the server</li>
<li>On the server, respond by sending back a custom object with three properties</li>
<li>On the client receive the data, and display each of the three properties to the user. Each property should appear in a separate paragraph tag that was configured with Jade.</li>
</ul>
<h2 id="sample-interface">Sample Interface</h2>
<p>It can look as you please, but here is an example interface.</p>
<p><img src="http://www.elvenware.com/charlie/books/CloudNotes/Images/ClickEvents05.png" alt="Click Route"></p>
<h2 id="step05">Step05: Turn it In</h2>
<p>Check it into your repository in a folder called <strong>Week0X-ClickRoute</strong>, where X is the week in which the assignment was assigned.</p>
<p>Don&#39;t forget to make sure your favicon works and that the project passes <strong>grunt check</strong>.</p>
<h2 id="hints">Hints</h2>
<p>You may see this message or one like it:</p>
<pre><code>Not Found

<span class="hljs-number">404</span>

<span class="hljs-symbol">Error:</span> Not Found
    at app.use.res.render.message (<span class="hljs-regexp">/home/charlie</span><span class="hljs-regexp">/Downloads/</span>ClickRoute/server.<span class="hljs-symbol">js:</span><span class="hljs-number">37</span>:<span class="hljs-number">15</span>)
    at Layer.handle [<span class="hljs-keyword">as</span> handle_request] (<span class="hljs-regexp">/home/charlie</span><span class="hljs-regexp">/Downloads/</span>ClickRoute/node_modules/express/<span class="hljs-class"><span class="hljs-keyword">lib</span>/<span class="hljs-title">router</span>/<span class="hljs-title">layer</span>.<span class="hljs-title">js</span>:82:5)</span>
    at trim_prefix (<span class="hljs-regexp">/home/charlie</span><span class="hljs-regexp">/Downloads/</span>ClickRoute/node_modules/express/<span class="hljs-class"><span class="hljs-keyword">lib</span>/<span class="hljs-title">router</span>/<span class="hljs-title">index</span>.<span class="hljs-title">js</span>:302:13)</span>
    at /home/charlie/Downloads/ClickRoute/node_modules/express/<span class="hljs-class"><span class="hljs-keyword">lib</span>/<span class="hljs-title">router</span>/<span class="hljs-title">index</span>.<span class="hljs-title">js</span>:270:7</span>
    at Function.proto.process_params (<span class="hljs-regexp">/home/charlie</span><span class="hljs-regexp">/Downloads/</span>ClickRoute/node_modules/express/<span class="hljs-class"><span class="hljs-keyword">lib</span>/<span class="hljs-title">router</span>/<span class="hljs-title">index</span>.<span class="hljs-title">js</span>:321:12)</span>
    at <span class="hljs-keyword">next</span> (<span class="hljs-regexp">/home/charlie</span><span class="hljs-regexp">/Downloads/</span>ClickRoute/node_modules/express/<span class="hljs-class"><span class="hljs-keyword">lib</span>/<span class="hljs-title">router</span>/<span class="hljs-title">index</span>.<span class="hljs-title">js</span>:261:10)</span>
    at /home/charlie/Downloads/ClickRoute/node_modules/express/<span class="hljs-class"><span class="hljs-keyword">lib</span>/<span class="hljs-title">router</span>/<span class="hljs-title">index</span>.<span class="hljs-title">js</span>:603:15</span>
    at <span class="hljs-keyword">next</span> (<span class="hljs-regexp">/home/charlie</span><span class="hljs-regexp">/Downloads/</span>ClickRoute/node_modules/express/<span class="hljs-class"><span class="hljs-keyword">lib</span>/<span class="hljs-title">router</span>/<span class="hljs-title">index</span>.<span class="hljs-title">js</span>:246:14)</span>
    at Function.proto.handle (<span class="hljs-regexp">/home/charlie</span><span class="hljs-regexp">/Downloads/</span>ClickRoute/node_modules/express/<span class="hljs-class"><span class="hljs-keyword">lib</span>/<span class="hljs-title">router</span>/<span class="hljs-title">index</span>.<span class="hljs-title">js</span>:166:3)</span>
    at router (<span class="hljs-regexp">/home/charlie</span><span class="hljs-regexp">/Downloads/</span>ClickRoute/node_modules/express/<span class="hljs-class"><span class="hljs-keyword">lib</span>/<span class="hljs-title">router</span>/<span class="hljs-title">index</span>.<span class="hljs-title">js</span>:35:12)</span>
</code></pre><p>This can mean that you have not properly defined a route for your event handler. Go back and re-read the section on Server Side code in this document.</p>
<p>This information is a bit outdated, in that you should use router.get rather than app.get, but nevertheless, there is information here you might find useful:</p>
<ul>
<li><a href="http://www.elvenware.com/charlie/development/web/JavaScript/NodeJs.html#using-express">Node on Elvenware</a></li>
</ul>
</div></body></html>