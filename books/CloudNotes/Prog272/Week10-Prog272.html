<!DOCTYPE html><html lang="en" dir="ltr"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><title>Week10-Prog272</title><link rel="shortcut icon" href="/charlie/images/favicon.png"><!-- Latest compiled and minified CSS--><link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap.min.css"><!-- Optional theme--><link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap-theme.min.css"><link href="/libs/css/BootstrapIndex.css" rel="stylesheet" type="text/css"><link href="/css/style.css" rel="stylesheet" type="text/css"><script src="/libs/scripts/jquery.min.js"></script><script src="//netdna.bootstrapcdn.com/bootstrap/3.0.0/js/bootstrap.min.js"></script><script src="/libs/scripts/elvenware.js" type="text/javascript"></script><script src="/libs/scripts/Control.js"></script></head><body><div class="navbar navbar-inverse"><div class="container"><div class="navbar-header"><button type="button" data-toggle="collapse" data-target=".navbar-collapse" class="navbar-toggle"><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><a href="/index.html" class="navbar-brand">Elvenware</a></div><div class="collapse navbar-collapse"><ul class="nav navbar-nav"><li class="active"><a href="/index.html">Home</a></li><li><a href="/contents.html">About</a></li><li class="dropdown"><a href="#" data-toggle="dropdown" class="dropdown-toggle">Dropdown<b class="caret"></b></a><ul class="dropdown-menu"><li class="dropdown-header">Core Code</li><li><a href="/development/index.html">Strongly Typed</a></li><li><a href="/development/web/index.html">Web & Scripts</a></li><li><a href="/development/cloud/index.shtml">Cloud</a></li><li class="divider"></li><li class="dropdown-header">OS and Tools</li><li><a href="/os/index.html">OS</a></li><li><a href="/development/database/index.html">Database</a></li><li><a href="/books/index.html">My Writing</a></li><li class="divider"></li><li class="dropdown-header">Art</li><li><a href="/charlie/Art/index.html">Poems & Photos</a></li><li><a href="/books/reading/index.html">Book Reviews</a></li><li><a href="/spirit/index.html">Spiritual</a></li><li class="divider"></li><li class="dropdown-header">Links</li><li><a href="/charlie/links.html">My Links</a></li><li><a href="http://www.github.com/charliecalvert">GitHub</a></li><li><a href="http://sourceforge.net/projects/elvenware/">Sourceforge</a></li></ul></li></ul></div><!-- /.nav-collapse--></div></div><div class="container"><figure><img alt="Elvenware" src="/charlie/images/elvenwarelogo.png"/></figure><h1>Week10-Prog272</h1><p>Index of Week10-Prog272:</p><ul><!--TOC_Start--><li><a href="#routing-links">Routing Links</a></li>
<li><a href="#slides">Slides</a></li>
<li><a href="#elvenware">Elvenware</a></li>
<li><a href="#callbacks">Callbacks</a></li>
<li><a href="#turn-it-in">Turn it in</a></li>
<li><a href="#links">Links</a></li>
<li><a href="#route-parameters">Route Parameters</a></li>
<li><a href="#step-one-find-route-parameters">Step One: Find Route Parameters</a></li>
<li><a href="#step-two-run-route-parameters-on-aws">Step Two: Run Route Parameters on AWS</a></li>
<li><a href="#step-three-copy-and-link">Step Three: Copy and Link</a></li>
<li><a href="#step-four-set-port">Step Four: Set Port</a></li>
<li><a href="#step-five-start-upstart">Step Five: Start Upstart</a></li>
<li><a href="#step-six-edit-elastic-ip">Step Six: Edit Elastic IP</a></li>
<li><a href="#step-seven-install">Step Seven: Install</a></li>
<li><a href="#turn-it-in">Turn it in</a></li>
<li><a href="#domain-names">Domain Names</a></li>
<li><a href="#pricing">Pricing</a></li>
<li><a href="#turn-it-in">Turn it in</a></li>
<li><a href="#domain-ec2">Domain Names on EC2</a></li>
<li><a href="#domain-github">Domain Names on GitHub IO</a></li><!--TOC_End--></ul><h1>Week 10 Overview</h1><p>Core topics:</p>
<ul>
<li>Express Routing</li>
<li>AWS</li>
<li>Domain Names</li>
</ul>
<h1 id="routing-links">Routing Links</h1>
<h2 id="slides">Slides</h2>
<ul>
<li><a href="http://bit.ly/noderoutes">http://bit.ly/noderoutes</a></li>
<li><a href="http://bit.ly/unittestasync">http://bit.ly/unittestasync</a></li>
<li><a href="http://bit.ly/ajaxjq">http://bit.ly/ajaxjq</a></li>
</ul>
<h2 id="elvenware">Elvenware</h2>
<ul>
<li><a href="http://www.elvenware.com/charlie/development/web/JavaScript/NodeJs.html">Node on Elvenware</a></li>
</ul>
<hr class="style-eight"><h1 id="callbacks">Callbacks</h1>
<p>Create an Express project called <strong>Week10-Callbacks</strong>. Add a JavaScript file called <strong>Callbacks.js</strong> and place it in the <strong>public/javascripts</strong>. Link that file into your project.</p>
<p>In <strong>Callbacks.js</strong> create a function named <strong>callbackHandler</strong> that takes three parameters. The first parameter is
a callback (that is, a function), the other two parameters are integers.</p>
<p>Now call the <strong>callbackHandler</strong> function three times:</p>
<ul>
<li>First pass a function that adds the second and third parameters.</li>
<li>Pass a function that returns the remainder from dividing two numbers (modulus operator)</li>
<li>Pass a function that converts the second parameter from miles to feet</li>
</ul>
<p>To install jQuery:</p>
<pre><code>bower install jquery --save
</code></pre><p>Make sure you load them:</p>
<pre><code>doctype html
html(lang=&#39;en&#39;)
  head
    meta(charset=&#39;UTF-8&#39;)
    meta(name=&#39;viewport&#39;, content=&#39;width=device-width&#39;)
    title= title
    block css
      link(rel=&#39;stylesheet&#39;, href=&#39;/css/style.css&#39;)
    block js
      script(src=&#39;components/jquery/dist/jquery.js&#39;)
      script(src=&#39;js/Callbacks.js&#39;)
      script(src=&#39;http://localhost:35729/livereload.js&#39;)
  body
    block content
</code></pre><p>Show Message: </p>
<pre><code>function showMessage(message) {
    $(&quot;#myList&quot;).append(&quot;&lt;li&gt;&quot; + message + &quot;&lt;/li&gt;&quot;);
}
</code></pre><p>Get JSON:</p>
<pre><code>function callRoute() {
    showMessage(&#39;callRoute was called&#39;);
    $.getJSON(&#39;/getNine&#39;, function(json) {
       showMessage(JSON.stringify(json));
        showMessage(json.result);
    });
}
</code></pre><p>Callback:</p>
<pre><code>function callbackHandler(func, a, b) {
    return func(a, b);
}
</code></pre><p>The <strong>callbackHandler</strong> function that you create should use jQuery to display the results of your function calls. Use
a list to display the result:</p>
<p>The HTML:</p>
<pre><code>&lt;ul id=&quot;myList&quot;&gt; &lt;/ul&gt;
</code></pre><p>In Jade, that would be:</p>
<pre><code>ul#myList
</code></pre><p>The JavaScript to display the result of your function calls:</p>
<pre><code>$(&quot;#myList&quot;).append(&quot;&lt;li&gt;&quot; + result + &quot;&lt;/li&gt;&quot;);
</code></pre><h2 id="turn-it-in">Turn it in</h2>
<p>Place it in your git folder under the name Week10-Callbacks. Provide a link to your folder.</p>
<h2 id="links">Links</h2>
<p>The following links should help you complete this assignment.</p>
<ul>
<li><a href="https://github.com/charliecalvert/JsObjects/tree/master/JavaScript/Functions">JsObjects Callback Demos</a></li>
<li><a href="https://github.com/charliecalvert/JsObjects/tree/master/JavaScript/Functions">JsObjects Function This</a></li>
<li><a href="http://elvenware.com/charlie/books/CloudNotes/Prog282/Week02.html">Week02 Notes</a></li>
<li><a href="http://bit.ly/FunctionalJavascript">http://bit.ly/FunctionalJavascript</a></li>
</ul>
<hr class="style-eight"><h2 id="route-parameters">Route Parameters</h2>
<p>The goal of this assignment is to get the RouteParameters program running on:</p>
<ul>
<li>AWS</li>
<li>A mobile devices</li>
</ul>
<p>This is not a coding assignment. It is just an exercise. You will, however, 
have to demonstrate an understanding of the program we will be running.</p>
<ul>
<li><a href="http://youtu.be/ft_ih30yqIY">Video</a></li>
</ul>
<h2 id="step-one-find-route-parameters">Step One: Find Route Parameters</h2>
<p>The Route Parameters program can be found on JsObjects. Here is the web app version:</p>
<ul>
<li><a href="https://github.com/charliecalvert/JsObjects/tree/master/JavaScript/NodeCode/NodeRoutesParams">Web App</a></li>
</ul>
<p>Here is the Cordova version:</p>
<ul>
<li><a href="https://github.com/charliecalvert/JsObjects/tree/master/Cordova/CordovaNodeRoutes">Cordova App</a></li>
</ul>
<p>It has a fairly simple interface. Here it is as a web app:</p>
<p><img src="https://drive.google.com/uc?id=0B25UTAlOfPRGVG02a25FZENnMk0" alt="RouteParameters on AWS"></p>
<p>And here it is as Cordova application:</p>
<p><img class="small" src="https://drive.google.com/uc?id=0B25UTAlOfPRGc1JqUWh1Tk5fZUE" alt="Isit 322 Final Home Page"></p>
<h2 id="step-two-run-route-parameters-on-aws">Step Two: Run Route Parameters on AWS</h2>
<p>First, make sure you have the most recent copy of JsObjects on your AWS instance:</p>
<pre><code>$ ssh ubuntu@&lt;SOME-ELASTIC-IP&gt;
Welcome to Ubuntu 14.04.2 LTS (GNU/Linux 3.13.0-44-generic x86_64)

 * Documentation:  https://help.ubuntu.com/

  System information as of Thu Mar 19 15:18:36 UTC 2015

  System load:  0.0               Processes:           99
  Usage of /:   19.5% of 7.74GB   Users logged in:     0
  Memory usage: 10%               IP address for eth0: 172.31.33.228
  Swap usage:   0%

  Graph this data and manage this system at:
    https://landscape.canonical.com/

  Get cloud support with Ubuntu Advantage Cloud Guest:
    http://www.ubuntu.com/business/services/cloud

10 packages can be updated.
9 updates are security updates.


Last login: Thu Mar 19 15:18:36 2015 from c-24-22-247-196.hsd1.wa.comcast.net
Agent pid 15723
ubuntu@ip-172-31-33-228:~
$ cd Git
ubuntu@ip-172-31-33-228:~/Git
$ git clone http://github.com/charliecalvert/JsObjects.git
</code></pre><p>The key line, of course, is this one:</p>
<pre><code> git clone http://github.com/charliecalvert/JsObjects.git
</code></pre><h2 id="step-three-copy-and-link">Step Three: Copy and Link</h2>
<p>Copy the Route Params project to a folder of your choosing outside
of JsObjects:</p>
<pre><code>    cd &lt;TO SOME FOLDER OF YOUR CHOOSING SUCH AS ~/Source&gt;
    cp -r ~/Git/JsObjects/JavaScript/NodeCode/NodeRoutesParams/ .
</code></pre><p>Now we need to create a symbolic link to our project. We want it to
appear that our project is in the <strong>~/bin directory</strong>. To do this, create
a symbolic link. The simplest way to do that is to navigate to the
folder that contains your project. For instance, if you project is in
<strong>Source</strong> directory, then navigate to the source directory. Then
create the symbolic link like this:</p>
<pre><code>$ ln -s ~/Source/NodeRoutesParams/ ~/bin/NodeRoutesParams
</code></pre><p>If all works out, you can see the symbolic link in your <strong>bin</strong> directory
by issuing a command like this:</p>
<pre><code>$ ls -l ~/bin
</code></pre><p>You should see that NodeParams is a symbolic link to your Source/NodeRoutesParams
directory:</p>
<pre><code>NodeRoutesParams -&gt; /home/charlie/Source/NodeRoutesParams/
</code></pre><h2 id="step-four-set-port">Step Four: Set Port</h2>
<p>In <strong>bin/www</strong>:</p>
<pre><code>#!/usr/bin/env node
var debug = require(&#39;debug&#39;)(&#39;expressapp&#39;);
var app = require(&#39;../app&#39;);

app.set(&#39;port&#39;, process.env.PORT || 30101);
</code></pre><p>Go to your AWS console. Go to Security Groups, edit the rules for your security
group to open up port 30101. If there is any confusion, you can find the security
group associated with your instance on the <strong>instances</strong> page in the AWS console.
In particular, select your instance, and look down and to your right.</p>
<ul>
<li>Type: Custom TCP</li>
<li>Protocol: TCP</li>
<li>Port Range: 30101 (Can we write: 30101-30105?)</li>
<li>Source: Anywhere</li>
</ul>
<h2 id="step-five-start-upstart">Step Five: Start Upstart</h2>
<p>Upstart can be used to keep your program running after you close 
your shell and to ensure that it restarts automatically when you
reboot the system. Take a momement to learn about upstart:</p>
<ul>
<li>[UpStart on Elvenware][elfUpstate]</li>
<li><a href="http://upstart.ubuntu.com/index.html">UpStart home page</a></li>
</ul>
<p>Our upstart script is called <strong>NodeRoutesParams</strong>. If you look inside it, you will see that
it assumes your copy of NodeRoutesParams is in <strong>~/bin</strong>:</p>
<pre><code>exec /usr/bin/nodejs $HOME/bin/NodeRoutesParams/bin/www &gt;&gt; /var/log/node.log 2&gt;&amp;1
</code></pre><p>That is why we created a symbolic link in that folder. That way, regardless of where
you keep <strong>NodeRoutesParams</strong> on your system, our script can find it.    </p>
<p>Copy the <strong>NodeRoutesParams</strong> file to the <strong>/etc/init</strong> directory:</p>
<pre><code>sudo cp NodeRoutesParams.conf /etc/init/.
</code></pre><p>Start the program</p>
<pre><code>sudo start NodeRoutesParams
</code></pre><p>Stop the program</p>
<pre><code>sudo stop NodesRoutesParams
</code></pre><p>If you reboot the system, your program will start automatically.</p>
<p>Error messages and and other output are in: /var/log/node.log </p>
<p>Browse to your instance:</p>
<pre><code>&lt;elasticIp&gt;:30101/
</code></pre><p>For instance, if you were testing all this out on your copy of Lubunutu,
you would do this:</p>
<pre><code>127.0.0.1:30101/    
</code></pre><h2 id="step-six-edit-elastic-ip">Step Six: Edit Elastic IP</h2>
<p>Navigate into your copied version of <strong>CordovaNodeRoutes</strong> </p>
<p>Edit <strong>Control.js</strong>:</p>
<pre><code>cd ~/Git/JsObjects/Cordova/CordovaNodeRoutes/
geany www/javascripts/Control.js    
</code></pre><p>Change the IP address to your elastic IP and the port to the number
you set up in the previous step:</p>
<pre><code>var Control = (function() {

        // Constructor
        function Control() {
        $(&quot;button&quot;).click(function(event) {
            var id = event.target.id;
            var route = &#39;http://52.11.190.176:30101/routeParams/&#39; + id;
            $(&quot;#clientRoute&quot;).html(&#39;ClientRoute: &#39; + route);
            $.getJSON(route, function(response) {
                // $(&#39;#response&#39;).html(JSON.stringify(response));
                $(&#39;#route&#39;).html(&quot;ROUTE: &quot; + response.route);
                $(&#39;#result&#39;).html(&quot;RESULT: &quot; + response.result);
                $(&#39;#query&#39;).html(&quot;QUERY: &quot; + JSON.stringify(response.query));
                $(&#39;#params&#39;).html(&quot;PARAMS: &quot; + JSON.stringify(response.params));
                $(&#39;#id&#39;).html(&quot;ID: &quot; + response.id);

                // elf.utilities.showMessage(choice, true);
            });
        });
</code></pre><p>The relevant line is this one:</p>
<pre><code>var route = &#39;http://&lt;CHANGE ME&gt;:30101/routeParams/&#39; + id;
</code></pre><p>Save your work.</p>
<h2 id="step-seven-install">Step Seven: Install</h2>
<p>Now install this cordova application on your phone or on AndroidX86
running in VirtualBox. </p>
<p>First use ADB to ensure that you are connected to your device:</p>
<pre><code>$ adb devices
List of devices attached 
e8e5bc06    device
</code></pre><p>If you are using your phone you don&#39;t have to 
explicitly connect adb. But if you are using VirtualBox, you
have to run <strong>adb connect <IP OF ANDROIDX86>.</strong></p>
<p>Remember these commands:</p>
<ul>
<li>cordova platform add android</li>
<li>cordova build android</li>
<li>adb install platforms/android/ant-build/CordovaApp-debug.apk</li>
</ul>
<p><strong>NOTE</strong>:<em>On some systems it may be <strong>MainActivity</strong> instead of <strong>CordovaApp</strong>.</em></p>
<p>To uninstall it:</p>
<ul>
<li>adb uninstall com.elvenware.elven_node_routes</li>
</ul>
<p>Details are here: <a href="http://bit.ly/elven-android-studio">http://bit.ly/elven-android-studio</a></p>
<h2 id="turn-it-in">Turn it in</h2>
<p>Create screen shots of your web app and cordova app running. Attach
these screen shots when you submit the assignment. Also include
the address of your instance running on AWS at your Elastic IP
and assignment Port.</p>
<hr class="style-eight"><H2>Domains</H2><p>We decided not to do this assignment, but I'm keepign the material here in case you want to review it.</p><hr><h1 id="domain-names">Domain Names</h1>
<ul>
<li>Go to GoDaddy.</li>
<li>Buy two one dollar, one year, domain names.</li>
<li>Point one at yourname.github.io.</li>
<li>The other at your elastic ip on AWS.</li>
</ul>
<h2 id="pricing">Pricing</h2>
<p>The .work domains are cheap.</p>
<p><img src="https://drive.google.com/uc?id=0B25UTAlOfPRGVWtzamdCaWI5TFE" alt="One Year"></p>
<p><img src="https://drive.google.com/uc?id=0B25UTAlOfPRGdHlwcDcyY3VJOG8" alt="Ten Year"></p>
<h2 id="turn-it-in">Turn it in</h2>
<p>Turn in screenshots of your domain names in the browser.
A text file showing a run of whois from the command line in Linux. Be sure to include the sections that read:</p>
<ul>
<li>Domain Name</li>
<li>Registrar</li>
<li>Sponsoring Registrar</li>
<li>Whois Server</li>
<li>Referral URL</li>
<li>Name Server</li>
</ul>
<p>Submit your domain names linked to a default home page (index.html) that reads:</p>
<ul>
<li>My Isis322 Domain Name</li>
<li>The shows an image stored on Flickr.</li>
</ul>
<hr><h2 id="domain-ec2">Domain Names on EC2</h2>
<p>Go to Godaddy and manage your domain. On the <strong>DNS Zone File Page</strong>
set the A record to your elastic IP.</p>
<ul>
<li><a href="http://stackoverflow.com/a/17569106/253576">http://stackoverflow.com/a/17569106/253576</a><h2 id="domain-github">Domain Names on GitHub IO</h2>
</li>
</ul>
<p>Create a CNAME document in the root of your repository. Mine looks like this:</p>
<pre><code>www.ccalvert.net
</code></pre><p>On GitHub, go to setings. Look for the section on your GitHub pages.    </p>
<p>That&#39;s the total contents of the file.</p>
<p>Go to your GoDaddy account. </p>
<p>Go to the domain page.</p>
<p>Choose to manage your domain.</p>
<p>In the DNS zone file page, set the CNAME alias for www to:</p>
<p>username@github.io.</p>
<ul>
<li><a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#104;&#x74;&#x74;&#x70;&#115;&#58;&#47;&#47;&#109;&#101;&#100;&#105;&#117;&#x6d;&#46;&#99;&#x6f;&#109;&#47;&#64;&#76;&#111;&#x76;&#x65;&#x74;&#x74;&#76;&#x6f;&#118;&#101;&#x74;&#x74;&#x2f;&#103;&#x69;&#116;&#x68;&#117;&#98;&#x2d;&#x70;&#x61;&#103;&#x65;&#115;&#x2d;&#x67;&#111;&#x64;&#x61;&#100;&#x64;&#x79;&#x2d;&#102;&#48;&#51;&#49;&#x38;&#x63;&#x32;&#x66;&#x32;&#x35;&#x61;">&#104;&#x74;&#x74;&#x70;&#115;&#58;&#47;&#47;&#109;&#101;&#100;&#105;&#117;&#x6d;&#46;&#99;&#x6f;&#109;&#47;&#64;&#76;&#111;&#x76;&#x65;&#x74;&#x74;&#76;&#x6f;&#118;&#101;&#x74;&#x74;&#x2f;&#103;&#x69;&#116;&#x68;&#117;&#98;&#x2d;&#x70;&#x61;&#103;&#x65;&#115;&#x2d;&#x67;&#111;&#x64;&#x61;&#100;&#x64;&#x79;&#x2d;&#102;&#48;&#51;&#49;&#x38;&#x63;&#x32;&#x66;&#x32;&#x35;&#x61;</a></li>
</ul>
</div></body></html>