<!DOCTYPE html><html lang="en" dir="ltr"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width initial-scale=1.0"><title>NpmUtilities</title><link href="/css/first-style.css" rel="stylesheet"><link rel="shortcut icon" href="/images/favicon.png"><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet"><link href="/css/highlight/googlecode.css" rel="stylesheet" type="text/css"><link href="/css/style.css" rel="stylesheet"><script src="https://code.jquery.com/jquery-1.12.0.min.js"></script><script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<!-- Latest compiled and minified CSS --><script src="/js/elven-help.js"></script></head><body><nav class="navbar navbar-inverse"><div class="container"><div class="navbar-header"><button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><a class="navbar-brand" href="/">Elvenware</a></div><div class="navbar-collapse collapse" id="navbar"><ul class="nav navbar-nav"><li class="trigger-collapse" ng-class="{ active: isActive('/')}"><a href="/">Home</a></li><li><a href="/about.html">About</a></li></ul></div></div></nav><div class="container"><figure><img class="elf-normal" alt="Elvenware" src="/images/elvenwarelogo.png"/></figure><h1>NpmUtilities</h1><p>Welcome to NpmUtilities</p><ul><!--TOC_Start--><li><a href="#overview">Overview</a></li>
<li><a href="#step-one">Step One</a></li>
<li><a href="#step-two">Step Two</a></li>
<li><a href="#step-three">Step Three</a></li>
<li><a href="#step-four">Step Four</a></li>
<li><a href="#step-five">Step Five</a></li>
<li><a href="#turn-it-in">Turn it in</a></li>
<li><a href="#pad-number">Pad Number</a></li>
<li><a href="#hint">Hint</a></li><!--TOC_End--></ul></div><div class="container"><a class="anchor" id="overview"></a>
<h2>Overview</h2>
<p>In this project we are going to start creating some utilities and put them in our NPM package. We will then create a project and use our utilities.</p>
<a class="anchor" id="step-one"></a>
<h2>Step One</h2>
<p>Put the following utilities in you <strong>npm package</strong> in a file called <strong>utils.js</strong>:</p>
<ul>
<li>writeFile(fileName, contents)</li>
<li>readFile(fileName)</li>
<li>padNumber(numberToPad, width, padValue)</li>
</ul>
<p>Maybe <strong>utils.js</strong> should look something like this, as a starting point:</p>
<pre><code class="lang-javascript"><span class="hljs-built_in">module</span>.exports = {
    <span class="hljs-attr">writeFile</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fileName, contents, callback</span>) </span>{
        callback({ <span class="hljs-string">"result"</span>: <span class="hljs-string">"writeFile Result TBD"</span>});
    },
    <span class="hljs-attr">readFile</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fileName, callback</span>) </span>{
        callback({ <span class="hljs-string">"result"</span>: <span class="hljs-string">"readFile Result TBD"</span>});
    },
    <span class="hljs-attr">padNumber</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">numberToPad, width, padValue</span>) </span>{
        <span class="hljs-keyword">return</span> { <span class="hljs-string">"result"</span>: <span class="hljs-string">"numberToPad result TBD"</span>};
    }
};
</code></pre>
<p>And then we need to ask our npm module <strong>index.js</strong> file to pass this along to the rest of the world:</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">var</span> utils = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./utils'</span>);

exports.getPackageDescription = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">var</span> myDescription = <span class="hljs-string">"This is Charlie Calvert's isit322 test package"</span>;
  <span class="hljs-built_in">console</span>.log(myDescription);
  <span class="hljs-keyword">return</span> myDescription;
};

exports.getNine = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{ <span class="hljs-keyword">return</span> <span class="hljs-number">9</span>; };

exports.utils = utils;
</code></pre>
<p>Do you see what is going on here? We <strong>requre</strong> our <strong>utils</strong> module at the top of the file. Then we export it at the bottom.</p>
<p>Update the version of your package and then push it to NPM:</p>
<pre><code><span class="hljs-built_in">npm</span> version minor
<span class="hljs-built_in">npm</span> publish
</code></pre><a class="anchor" id="step-two"></a>
<h2>Step Two</h2>
<p>Create a project</p>
<pre><code class="lang-bash"><span class="hljs-attribute">CreateAllExpress</span> Week03-UseNpmPackage
</code></pre>
<p>Install your package. For instance, I type:</p>
<pre><code class="lang-bash">npm <span class="hljs-keyword">install</span> isit322-calvert <span class="hljs-comment">--save</span>
</code></pre>
<p>Commands you can use to learn more about a package:</p>
<p>  npm show <PACKAGE NAME></p>
<p>For instance:</p>
<pre><code class="lang-bash">  <span class="hljs-built_in">npm</span> show isit322-kariungi
  <span class="hljs-built_in">npm</span> show isit322-calvert
</code></pre>
<p>Typical output:</p>
<pre><code>{ <span class="hljs-attribute">name</span>: <span class="hljs-string">'isit322-calvert'</span>,
  <span class="hljs-attribute">description</span>: <span class="hljs-string">'My test package'</span>,
  <span class="hljs-string">'dist-tags'</span>: { <span class="hljs-attribute">latest</span>: <span class="hljs-string">'1.1.3'</span> },
  <span class="hljs-attribute">versions</span>: [ <span class="hljs-string">'1.0.0'</span>, <span class="hljs-string">'1.0.1'</span>, <span class="hljs-string">'1.0.2'</span>, <span class="hljs-string">'1.1.0'</span>, <span class="hljs-string">'1.1.1'</span>, <span class="hljs-string">'1.1.2'</span>, <span class="hljs-string">'1.1.3'</span> ],
  <span class="hljs-attribute">maintainers</span>: [ <span class="hljs-string">'charliecalvert &lt;xxx@xxx.com&gt;'</span> ],
  <span class="hljs-attribute">time</span>:
   { <span class="hljs-attribute">modified</span>: <span class="hljs-string">'2016-02-04T03:12:54.452Z'</span>,
     <span class="hljs-attribute">created</span>: <span class="hljs-string">'2016-01-14T02:09:55.073Z'</span>,
     <span class="hljs-string">'1.0.0'</span>: <span class="hljs-string">'2016-01-14T02:09:55.073Z'</span>,
     <span class="hljs-string">'1.0.1'</span>: <span class="hljs-string">'2016-01-14T02:19:59.955Z'</span>,
     <span class="hljs-string">'1.0.2'</span>: <span class="hljs-string">'2016-01-14T02:59:12.265Z'</span>,
     <span class="hljs-string">'1.1.0'</span>: <span class="hljs-string">'2016-01-20T01:53:08.120Z'</span>,
     <span class="hljs-string">'1.1.1'</span>: <span class="hljs-string">'2016-01-20T02:10:53.173Z'</span>,
     <span class="hljs-string">'1.1.2'</span>: <span class="hljs-string">'2016-01-20T02:18:01.199Z'</span>,
     <span class="hljs-string">'1.1.3'</span>: <span class="hljs-string">'2016-02-04T03:12:54.452Z'</span> },
  <span class="hljs-attribute">keywords</span>: [ <span class="hljs-string">'npm'</span>, <span class="hljs-string">'test'</span> ],
  <span class="hljs-attribute">repository</span>:
   { <span class="hljs-attribute">type</span>: <span class="hljs-string">'git'</span>,
     <span class="hljs-attribute">url</span>: <span class="hljs-string">'git@bitbucket:ccalvert/isit322-calvert-2016.git'</span> },
  <span class="hljs-attribute">author</span>: <span class="hljs-string">'Charlie Calvert'</span>,
  <span class="hljs-attribute">license</span>: <span class="hljs-string">'MIT'</span>,
  <span class="hljs-attribute">readmeFilename</span>: <span class="hljs-string">''</span>,
  <span class="hljs-attribute">version</span>: <span class="hljs-string">'1.1.3'</span>,
  <span class="hljs-attribute">main</span>: <span class="hljs-string">'index.js'</span>,
  <span class="hljs-attribute">scripts</span>: { <span class="hljs-attribute">test</span>: <span class="hljs-string">'echo "Error: no test specified" &amp;&amp; exit 1'</span> },
  <span class="hljs-attribute">dist</span>:
   { <span class="hljs-attribute">shasum</span>: <span class="hljs-string">'8a17e79386028001a3f84cd304be1e266ef57085'</span>,
     <span class="hljs-attribute">tarball</span>: <span class="hljs-string">'http://registry.npmjs.org/isit322-calvert/-/isit322-calvert-1.1.3.tgz'</span> },
  <span class="hljs-attribute">directories</span>: {} }
</code></pre><p>Or</p>
<pre><code><span class="hljs-selector-tag">npm</span> <span class="hljs-selector-tag">show</span> <span class="hljs-selector-tag">isit322-kariungi</span> <span class="hljs-selector-tag">version</span>
1<span class="hljs-selector-class">.2</span><span class="hljs-selector-class">.1</span>
</code></pre><a class="anchor" id="step-three"></a>
<h2>Step Three</h2>
<p>Now we want to be able to call each of these functions from our npm <strong>utils</strong> module. On the server side, here is how to use one function as I defined it above:</p>
<pre><code class="lang-javascript"><span class="hljs-attribute">var utils</span> = require(<span class="hljs-string">'isit322-calvert'</span>).utils;
</code></pre>
<p>Or, if you are willing to trade a bit of typing for some additional flexibility, like this:</p>
<pre><code class="lang-javascript"><span class="hljs-attribute">var isit</span> = require(<span class="hljs-string">'isit322-calvert'</span>);
<span class="hljs-attribute">var utils</span> = isit.utils;
</code></pre>
<p><strong>NOTE</strong>: <em>You should, of course, be loading your NPM package, not mine. Where I write calvert, you should be writing your last name.</em></p>
<p>Now use one of the methods from your package:</p>
<pre><code class="lang-javascript">router.get(<span class="hljs-string">'/readFile'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(request, response)</span> </span>{
    utils.readFile(<span class="hljs-string">'sam.txt'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(result)</span> </span>{
        response.send(result);
    });
});
</code></pre>
<a class="anchor" id="step-four"></a>
<h2>Step Four</h2>
<p>On the client side, something like this:</p>
<pre><code class="lang-javascript">$(<span class="hljs-built_in">document</span>).ready(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{ <span class="hljs-string">'use strict'</span>;
    $.getJSON(<span class="hljs-string">'/readFile'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">result</span>) </span>{
        $(<span class="hljs-string">'#readFile'</span>).html(<span class="hljs-built_in">JSON</span>.stringify(result));
    }).done(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
     showDebug( <span class="hljs-string">"readFile second success"</span> );
    })
    .fail(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">jqxhr, textStatus, error</span>) </span>{
        showDebug( <span class="hljs-string">"readFile error: "</span> + jqxhr.status + <span class="hljs-string">' '</span> + textStatus + <span class="hljs-string">' '</span> + error );
    })
    .always(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        showDebug( <span class="hljs-string">"readFile complete"</span> );
    });
});
</code></pre>
<p>Back on the server side, add this to <strong>index.jade</strong>:</p>
<pre><code class="lang-javascript"><span class="hljs-meta">pre#</span><span class="bash">readFile</span>
</code></pre>
<a class="anchor" id="step-five"></a>
<h2>Step Five</h2>
<p>You should call all the functions in your npm library. I suppose that should both the two in <strong>index.js</strong> and the ones in <strong>utils.js</strong>. Show the results from each call in a separate <strong>PRE</strong> tag.</p>
<p>You should fully implement all the methods in the npm package. You will need, of course, to use <a href="https://nodejs.org/api/fs.html#fs_fs_readfile_file_options_callback">fs.readFile</a> and <a href="https://nodejs.org/api/fs.html#fs_fs_writefile_file_data_options_callback">fs.writeFile</a>.</p>
<p>And you will need to require <strong>fs</strong>:</p>
<pre><code class="lang-javascript"><span class="hljs-attribute">var fs</span> = require(<span class="hljs-string">'fs'</span>);
</code></pre>
<p>You will also have to pass the name of files to read and write to the server. For now, you can hardcode the values you pass from the client to the server, like this:</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">var</span> fileToRead = { <span class="hljs-attr">fileName</span>: <span class="hljs-string">'qux.txt'</span> };
$.getJSON(<span class="hljs-string">'/readFile'</span>, fileToRead,  <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">result</span>) </span>{
    $(<span class="hljs-string">'#readFile'</span>).html(<span class="hljs-built_in">JSON</span>.stringify(result));
});
</code></pre>
<p>I also want you to pass in the arguments that padNumber receives. In other words, when you call getJSON, I want you to pass values such as 5, 3 and &#39;0&#39; to the server side. On the server, you should use the <strong>request.query</strong> object to get the values passed from the client to the server. As shown above, When calling <strong>getJSON</strong>, use the second parameter to create an object that specifies the values you want to pass. A brief related discussion is found here:</p>
<ul>
<li><a href="http://www.elvenware.com/charlie/development/web/JavaScript/NodeJs.html#node-parameters">Elvenwre Node Parameters</a></li>
</ul>
<p>Of course, if you want to build a real front with buttons and input controls, you can, but that is not a requirement at this time. But you should read and write real files on the server side.</p>
<a class="anchor" id="turn-it-in"></a>
<h2>Turn it in</h2>
<p>Push your work from your local drive to your repository and submit the assignment. Best to mention github url when submitting assignment.</p>
<a class="anchor" id="pad-number"></a>
<h2>Pad Number</h2>
<p>Given the number 5, the following call sets <strong>result</strong> to the string &#39;005&#39;:</p>
<pre><code class="lang-javascript"><span class="hljs-attribute">var result</span> = padNumber(5, 3, <span class="hljs-string">'0'</span>);
</code></pre>
<p>But of course, in our code, <strong>padNumber</strong> would be a method of the utils object:</p>
<pre><code class="lang-javascript"><span class="hljs-attribute">var result</span> = utils.padNumber(5, 3, <span class="hljs-string">'0'</span>);
</code></pre>
<a class="anchor" id="hint"></a>
<h2>Hint</h2>
<p>I found that I would install my package, only to find it did not work right. At that point, I could:</p>
<ul>
<li>Create unit tests in my NPM package to prove that my code worked as expected. Once I felt they were working, I would increment the patch number (<strong>npm patch</strong>) and then run <strong>npm publish</strong>. Back in my project I would edit <strong>package.json</strong> by manually incrementing the version number for <strong>isit322-lastname</strong>. For instance, package ~0.0.3 would become ~0.0.4 or whatever number matched the latest version for my package. Then I would run <strong>npm install</strong> to get the updated package.</li>
<li>And/or, in my project, I could simply edit the files for my package directly in <strong>node_modules/isit322-lastname</strong> until they started to work. Then I would <em>meld</em> the updated files with my original package, and then run <strong>npm patch</strong> and <strong>npm publish</strong> and so on.</li>
</ul>
</div></body></html>