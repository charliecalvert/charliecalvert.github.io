<!DOCTYPE html><html lang="en" dir="ltr"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width initial-scale=1.0"><title>HyperlinkExplorer</title><link rel="shortcut icon" href="/charlie/images/favicon.png"><!-- Latest compiled and minified CSS--><link rel="stylesheet" href="/components/bootstrap/dist/css/bootstrap.min.css"><!-- Optional theme--><link rel="stylesheet" href="/components/bootstrap/dist/css/bootstrap-theme.min.css"><link href="/libs/css/BootstrapIndex.css" rel="stylesheet" type="text/css"><link href="/css/style.css" rel="stylesheet" type="text/css"><link href="/css/highlight/googlecode.css" rel="stylesheet" type="text/css"><script src="/components/jquery/dist/jquery.js"></script><script src="/components/angular/angular.js"></script><script src="/components/angular-route/angular-route.js"></script><script src="/components/bootstrap/dist/js/bootstrap.min.js"></script><script src="/libs/scripts/elvenware.js" type="text/javascript"></script><script src="/libs/scripts/Control.js"></script></head><body><div class="navbar navbar-inverse"><div class="container"><div class="navbar-header"><button type="button" data-toggle="collapse" data-target=".navbar-collapse" class="navbar-toggle"><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><a href="/" class="navbar-brand">Elvenware</a></div><div class="collapse navbar-collapse"><ul class="nav navbar-nav"><li class="active"><a href="/index.html">Home</a></li><li><a href="/about">About</a></li><li class="dropdown"><a href="#/" data-toggle="dropdown" class="dropdown-toggle">Dropdown<b class="caret"></b></a><ul class="dropdown-menu"><li class="dropdown-header">Core Code</li><li><a href="/development/index.html">Strongly Typed</a></li><li><a href="/development/web/index.html">Web & Scripts</a></li><li><a href="/development/cloud/index.shtml">Cloud</a></li><li class="divider"></li><li class="dropdown-header">OS and Tools</li><li><a href="/os/index.html">OS</a></li><li><a href="/development/database/index.html">Database</a></li><li><a href="/books/index.html">My Writing</a></li><li class="divider"></li><li class="dropdown-header">Art</li><li><a href="/charlie/Art/index.html">Poems & Photos</a></li><li><a href="/books/reading/index.html">Book Reviews</a></li><li><a href="/spirit/index.html">Spiritual</a></li><li class="divider"></li><li class="dropdown-header">Links</li><li><a href="/charlie/links.html">My Links</a></li><li><a href="http://www.github.com/charliecalvert">GitHub</a></li><li><a href="http://sourceforge.net/projects/elvenware/">Sourceforge</a></li></ul></li></ul></div><!-- /.nav-collapse--></div></div><div class="container"><figure><img alt="Elvenware" src="/charlie/images/elvenwarelogo.png"/></figure><h1>HyperlinkExplorer</h1><h3>Table of Contents</h3><ul><!--TOC_Start--><li><a href="#overview">Overview</a></li>
<li><a href="#hyperlink-explorer">Hyperlink Explorer</a></li>
<li><a href="#updates">Updates</a></li>
<li><a href="#data-directory">Create a Spec Data Directory</a></li>
<li><a href="#test-your-work">Test your work</a></li>
<li><a href="#the-logger">The logger</a></li>
<li><a href="#delicious-tests">Delicious Tests</a></li>
<li><a href="#other-tests">Other Tests</a></li>
<li><a href="#favicon">Favicon</a></li>
<li><a href="#tests-clean">Tests Clean</a></li><!--TOC_End--></ul><h2 id="overview">Overview</h2>
<p>We further refine the midterm, getting ready for the final.</p>
<h2 id="hyperlink-explorer">Hyperlink Explorer</h2>
<p>It&#39;s time to give our project a name. We&#39;ll call it the Hyperlink Explorer.</p>
<p>Copy your midterm into a new folder:</p>
<pre><code><span class="hljs-keyword">cp</span> -r Week08-Midterm Week10-HyperExplorer
</code></pre><p>Open the project in WebStorm or your editor of choice.</p>
<p>Make the necessary changes regarding names.</p>
<p>Change the name of the class called elfMidterm to <strong>elfHyperExplorer</strong>. As a result of this change you will probably also need to make a change to your <strong>document.ready</strong> function.</p>
<h2 id="updates">Updates</h2>
<p>Copy in the most recent tests from the templates directory:</p>
<pre><code class="lang-bash">cp <span class="hljs-variable">$ELF</span>_TEMPLATES/UnitTest/HyperExplorer/test*.js spec/.
</code></pre>
<p>Unless you have made your own modifications to these files, simply copy in the most recent mixins:</p>
<pre><code class="lang-bash">cp <span class="hljs-variable">$ELF</span>_TEMPLATES/JadeMixins/mixin*.jade views/.
</code></pre>
<p>If you did modify them, then do a diff or meld to update the files, being sure that the left and right iteration buttons have ID&#39;s of <strong>leftButton</strong> and <strong>rightButton</strong>.</p>
<h2 id="data-directory">Create a Spec Data Directory</h2>
<p>Something like this:</p>
<pre><code class="lang-bash"><span class="hljs-title">mkdir</span> spec/<span class="hljs-typedef"><span class="hljs-keyword">data</span></span>
<span class="hljs-title">git</span> mv spec/bitly-links.js spec/<span class="hljs-typedef"><span class="hljs-keyword">data</span>/.</span>
</code></pre>
<p>Copy your <strong>delicious-javascript-links.js</strong> file from the DelicousQuery project into <strong>spec/data</strong>.</p>
<h2 id="test-your-work">Test your work</h2>
<p>My callDelicious method looks like this:</p>
<pre><code class="lang-javascript">callDelicious: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">subject</span>) </span>{
<span class="hljs-pi">        'use strict'</span>;
        <span class="hljs-keyword">var</span> feedUrl = <span class="hljs-string">'http://feeds.delicious.com/v2/json/charliecalvert/'</span> + subject;
        $.ajax({
            url: feedUrl,

            dataType: <span class="hljs-string">'jsonp'</span>,

            success: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">data</span>) </span>{
                elfDelicious.deliciousLinks = data;
                $(<span class="hljs-string">'#urlDelicious'</span>).empty();
                $.each(elfDelicious.deliciousLinks, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">index, deliciousLink</span>) </span>{
                    elfDelicious.appendUrl(index, deliciousLink);
                });
                $(<span class="hljs-string">'#deliciousDetails'</span>).html(<span class="hljs-built_in">JSON</span>.stringify(elfDelicious.deliciousLinks, <span class="hljs-literal">null</span>, <span class="hljs-number">4</span>));
            }
        });
    },
</code></pre>
<p>Move the following functions from DeliciousQuery to an object called <strong>elfDeliciousUtils</strong>:</p>
<ul>
<li>&#39;filter&#39;</li>
<li>&#39;getAllUrls&#39;</li>
<li>&#39;getDescriptionTag&#39;</li>
<li>&#39;getMap&#39;</li>
<li>&#39;getMapBig&#39;</li>
<li>&#39;getMapMidSize&#39;</li>
<li>&#39;getOwnerNameMap&#39;</li>
</ul>
<p>Copy in the delicious test suite:</p>
<pre><code>cp <span class="hljs-variable">$ELF</span>_TEMPLATES/UnitTest/HyperExplorer/test-delicious.js spec/.
</code></pre><p>Make sure they all pass.</p>
<h2 id="the-logger">The logger</h2>
<p>In <strong>elf-log.js</strong></p>
<pre><code class="lang-javascript">(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
<span class="hljs-pi">
    'use strict'</span>;

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ElfLog</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">this</span>.debugLevel = <span class="hljs-keyword">this</span>.logLevelWarn;
    }

    <span class="hljs-comment">//var levels = ['error', 'warn', 'info', 'silent'];</span>
    <span class="hljs-keyword">var</span> that;

    ElfLog.prototype.logLevelError = <span class="hljs-number">0</span>;
    ElfLog.prototype.logLevelWarn = <span class="hljs-number">1</span>;
    ElfLog.prototype.logLevelDetails = <span class="hljs-number">2</span>;
    ElfLog.prototype.logLevelInfo = <span class="hljs-number">3</span>;
    ElfLog.prototype.logLevelSilent = <span class="hljs-number">4</span>;

    ElfLog.prototype.debugLevel = <span class="hljs-literal">undefined</span>;

    ElfLog.prototype.setLevel = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">level</span>) </span>{
        <span class="hljs-keyword">this</span>.debugLevel = level;
    };

    ElfLog.prototype.log = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">level, message</span>) </span>{
        <span class="hljs-comment">// console.log("Level:", level, 'debugLevel: ', this.debugLevel);</span>
        <span class="hljs-keyword">if</span> (level &gt;= <span class="hljs-keyword">this</span>.debugLevel) {
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> message !== <span class="hljs-string">'string'</span>) {
                message = <span class="hljs-built_in">JSON</span>.stringify(message);
            }
            <span class="hljs-built_in">console</span>.log(level+<span class="hljs-string">': '</span>+message);
        }
    };

    that = <span class="hljs-keyword">new</span> ElfLog();
    <span class="hljs-built_in">window</span>.elfLog = that;
})();
</code></pre>
<p>Use it like this:</p>
<pre><code class="lang-javascript">elfLog.<span class="hljs-built_in">set</span>Level(elfLog.<span class="hljs-keyword">log</span>LevelDetails); // Done <span class="hljs-keyword">once</span> per application
elfLog.<span class="hljs-keyword">log</span>(elfLog.<span class="hljs-keyword">log</span>LevelDetails, 'ElfDisplay.Render index: ' + index);
<span class="hljs-comment">## Movement Tests</span>

Make sure you have created spec/fixtures/bitly.html:
</code></pre>
<p>jade views/bitly.jade --out spec/fixtures/</p>
<pre><code>
Copy over **test-movement** <span class="hljs-built_in">and</span> <span class="hljs-keyword">make</span> sure <span class="hljs-keyword">all</span> the tests pas<span class="hljs-variable">s:</span>

```bash
<span class="hljs-keyword">cp</span> $ELF_TEMPLATES/UnitTest/HyperExplorer/test-movement.js spec/.
</code></pre><p>Key Points:</p>
<ul>
<li>If you spy on function, it is not really called. We can just check if it is called.<ul>
<li>Therefore, don&#39;t check methods down stream of it to see if they are called</li>
</ul>
</li>
<li>We need to click the right button before we can expect the left button to do anything</li>
</ul>
<p>The output we want:</p>
<pre><code>Test Movement
    ✓ expects a button <span class="hljs-keyword">with</span> an id <span class="hljs-keyword">of</span> <span class="hljs-comment">#leftButton</span>
    ✓ expects a button <span class="hljs-keyword">with</span> an id <span class="hljs-keyword">of</span> <span class="hljs-comment">#rightButton</span>
    ✓ shows <span class="hljs-literal">that</span> elfMovement.left <span class="hljs-keyword">is</span> called <span class="hljs-keyword">when</span> selecting left button
    ✓ shows <span class="hljs-literal">that</span> elfMovement.right <span class="hljs-keyword">is</span> called <span class="hljs-keyword">when</span> selecting right button
    ✓ shows <span class="hljs-literal">that</span> elfDisplay.render <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> called <span class="hljs-keyword">when</span> selecting only left button
    ✓ shows <span class="hljs-literal">that</span> elfDisplay.render <span class="hljs-keyword">is</span> called <span class="hljs-keyword">when</span> selecting right <span class="hljs-keyword">then</span> left button
    ✓ shows <span class="hljs-literal">that</span> elfDisplay.render <span class="hljs-keyword">is</span> called <span class="hljs-keyword">when</span> selecting right button
    ✓ shows <span class="hljs-literal">that</span> elfDisplay.showRecord <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> called <span class="hljs-keyword">when</span> selecting only left button
    ✓ shows <span class="hljs-literal">that</span> elfDisplay.showRecord <span class="hljs-keyword">is</span> called <span class="hljs-keyword">when</span> selecting right <span class="hljs-keyword">then</span> left button
    ✓ shows <span class="hljs-literal">that</span> elfDisplay.showRecord <span class="hljs-keyword">is</span> called <span class="hljs-keyword">when</span> selecting right button
    ✓ shows <span class="hljs-literal">that</span> elfDisplay.showRecord gets valid data
    ✓ shows <span class="hljs-literal">that</span> movement.right called even <span class="hljs-keyword">if</span> we click many times past end <span class="hljs-keyword">of</span> array
    ✓ shows <span class="hljs-literal">that</span> the right boundary condition <span class="hljs-keyword">is</span> checked
    ✓ shows <span class="hljs-literal">that</span> the right boundary condition gets valid data
</code></pre><h2 id="delicious-tests">Delicious Tests</h2>
<p>Make sure you have created spec/fixtures/delicious.html:</p>
<pre><code>jade views/delicious<span class="hljs-class">.jade</span> --out spec/fixtures/
</code></pre><p>Make sure that there is no checkbox selected by default.</p>
<pre><code class="lang-jade"><span class="hljs-tag">div</span><span class="hljs-class">.panel</span><span class="hljs-class">.panel-default</span>
    <span class="hljs-tag">div</span><span class="hljs-class">.panel-heading</span> Select one or more CheckBoxes to search Delicious
    <span class="hljs-tag">div</span><span class="hljs-class">.panel-body</span>
        <span class="hljs-tag">div</span>
            input#<span class="hljs-function"><span class="hljs-title">chJavaScript</span><span class="hljs-params">(type=<span class="hljs-string">'checkbox'</span>, name=<span class="hljs-string">'deliciousCheckBox'</span>, value=<span class="hljs-string">'JavaScript'</span>)</span></span>
            <span class="hljs-function"><span class="hljs-title">label</span><span class="hljs-params">(for=<span class="hljs-string">'chJavaScript'</span>)</span></span> JavaScript
        <span class="hljs-tag">div</span>
            input#<span class="hljs-function"><span class="hljs-title">chBootstrap</span><span class="hljs-params">(type=<span class="hljs-string">'checkbox'</span>, name=<span class="hljs-string">'deliciousCheckBox'</span>, value=<span class="hljs-string">'Bootstrap'</span>)</span></span>
            <span class="hljs-function"><span class="hljs-title">label</span><span class="hljs-params">(for=<span class="hljs-string">'chBootstrap'</span>)</span></span>  Bootstrap
        <span class="hljs-tag">div</span>
            input#<span class="hljs-function"><span class="hljs-title">chNodeJs</span><span class="hljs-params">(type=<span class="hljs-string">'checkbox'</span>, name=<span class="hljs-string">'deliciousCheckBox'</span>, value=<span class="hljs-string">'Node'</span>)</span></span>
            <span class="hljs-function"><span class="hljs-title">label</span><span class="hljs-params">(for=<span class="hljs-string">'chNodeJs'</span>)</span></span>  NodeJs
</code></pre>
<p>Copy in <strong>text-delicious-fixtures.js</strong>:</p>
<pre><code class="lang-bash">cp <span class="hljs-variable">$ELF</span>_TEMPLATES/UnitTest/HyperExplorer/test-delicious-fixture.js spec/.
</code></pre>
<p>Note that if we are spying on a method that has an onclick event, we need to initialize the event after we have spied on the method:</p>
<pre><code class="lang-javascript">it<span class="hljs-list">(<span class="hljs-quoted">'expects</span> selecting #chBootstrap to cause displayCheckBoxSelection to have been called', function<span class="hljs-list">()</span> {
    var checkBox = document.getElementById<span class="hljs-list">(<span class="hljs-quoted">'chBootstrap</span>')</span><span class="hljs-comment">;</span>
    spyOn<span class="hljs-list">(<span class="hljs-keyword">elfDelicious</span>, <span class="hljs-quoted">'displayCheckboxSelection</span>')</span><span class="hljs-comment">;</span>
    elfDelicious.deliciousSetup<span class="hljs-list">()</span><span class="hljs-comment">;</span>
    $<span class="hljs-list">(<span class="hljs-keyword">checkBox</span>)</span>.trigger<span class="hljs-list">(<span class="hljs-quoted">'click</span>')</span><span class="hljs-comment">;</span>
    expect<span class="hljs-list">(<span class="hljs-keyword">elfDelicious</span>.displayCheckboxSelection)</span>.toHaveBeenCalled<span class="hljs-list">()</span><span class="hljs-comment">;</span>
})</span><span class="hljs-comment">;</span>
</code></pre>
<h2 id="other-tests">Other Tests</h2>
<p>Ignore these for now.</p>
<pre><code class="lang-javascript">it<span class="hljs-list">(<span class="hljs-quoted">'checks</span> that elfBitly.getLinks calls elfDisplay.renderTable', function<span class="hljs-list">()</span> {
    spyOn<span class="hljs-list">(<span class="hljs-keyword">elfDisplay</span>, <span class="hljs-quoted">'renderTable</span>')</span><span class="hljs-comment">;</span>
    elfBitly.getLinks<span class="hljs-list">(<span class="hljs-keyword">elfDownloads</span>.dataTypes.dtBitly)</span><span class="hljs-comment">;</span>
    expect<span class="hljs-list">(<span class="hljs-keyword">elfDisplay</span>.renderTable)</span>.toHaveBeenCalled<span class="hljs-list">()</span><span class="hljs-comment">;</span>
})</span><span class="hljs-comment">;</span>

it<span class="hljs-list">(<span class="hljs-quoted">'checks</span> elfBitly.getLinks calls elfDisplay.render', function<span class="hljs-list">()</span> {
    spyOn<span class="hljs-list">(<span class="hljs-keyword">elfDisplay</span>, <span class="hljs-quoted">'render</span>')</span><span class="hljs-comment">;</span>
    elfBitly.getLinks<span class="hljs-list">(<span class="hljs-keyword">elfDownloads</span>.dataTypes.dtBitly)</span><span class="hljs-comment">;</span>
    expect<span class="hljs-list">(<span class="hljs-keyword">elfDisplay</span>.render)</span>.toHaveBeenCalled<span class="hljs-list">()</span><span class="hljs-comment">;</span>
})</span><span class="hljs-comment">;</span>

it<span class="hljs-list">(<span class="hljs-quoted">'checks</span> elfBitly.getLinks calls elfBitly.getUrl', function<span class="hljs-list">()</span> {
    spyOn<span class="hljs-list">(<span class="hljs-keyword">elfBitly</span>, <span class="hljs-quoted">'getUrl</span>')</span><span class="hljs-comment">;</span>
    elfBitly.getLinks<span class="hljs-list">(<span class="hljs-keyword">elfDownloads</span>.dataTypes.dtBitly)</span><span class="hljs-comment">;</span>
    expect<span class="hljs-list">(<span class="hljs-keyword">elfBitly</span>.getUrl)</span>.toHaveBeenCalled<span class="hljs-list">()</span><span class="hljs-comment">;</span>
})</span><span class="hljs-comment">;</span>

it<span class="hljs-list">(<span class="hljs-quoted">'shows</span> we can call getLinkHistoryArray', function<span class="hljs-list">()</span> {
    elfBitly.getLinks<span class="hljs-list">(<span class="hljs-keyword">elfDownloads</span>.dataTypes.dtBitly)</span><span class="hljs-comment">;</span>
    var historyArray = elfBitly.getLinkHistoryArray<span class="hljs-list">()</span><span class="hljs-comment">;</span>
    expect<span class="hljs-list">(<span class="hljs-keyword">historyArray</span>.length)</span>.toBe<span class="hljs-list">(<span class="hljs-number">50</span>)</span><span class="hljs-comment">;</span>
})</span><span class="hljs-comment">;</span>

it<span class="hljs-list">(<span class="hljs-quoted">'shows</span> getLinkHistoryItem sets elfBitly.linkIndex', function<span class="hljs-list">()</span> {
    elfBitly.getLinks<span class="hljs-list">(<span class="hljs-keyword">elfDownloads</span>.dataTypes.dtBitly)</span><span class="hljs-comment">;</span>
    var historyArray = elfBitly.getLinkHistoryItem<span class="hljs-list">(<span class="hljs-number">12</span>, true)</span><span class="hljs-comment">;</span>
    expect<span class="hljs-list">(<span class="hljs-keyword">elfBitly</span>.linkIndex)</span>.toBe<span class="hljs-list">(<span class="hljs-number">12</span>)</span><span class="hljs-comment">;</span>
})</span><span class="hljs-comment">;</span>
</code></pre>
<p>Here are some results:</p>
<pre><code>Test Delicous Fixture
    ✓ expects <span class="hljs-tag">a</span> checkbox with an id of <span class="hljs-id">#chJavaScript</span>
    ✓ expects <span class="hljs-tag">a</span> checkbox with an id of <span class="hljs-id">#chJavaScript</span> to be <span class="hljs-tag">a</span> checkbox
    ✓ expects <span class="hljs-tag">a</span> checkbox with an id of <span class="hljs-id">#chBootstrap</span>
    ✓ expects <span class="hljs-tag">a</span> checkbox with an id of <span class="hljs-id">#chBootstrap</span> to be <span class="hljs-tag">a</span> checkbox
    ✓ expects <span class="hljs-tag">a</span> checkbox with an id of <span class="hljs-id">#chNodeJs</span>
    ✓ expects <span class="hljs-tag">a</span> checkbox with an id of <span class="hljs-id">#chNodeJs</span> to be <span class="hljs-tag">a</span> checkbox
    ✓ expects selecting <span class="hljs-id">#chBootstrap</span> to cause displayCheckBoxSelection to have been called
    ✓ expects selecting <span class="hljs-id">#chBootstrap</span> to cause callDelicious to be called
    ✓ expects selecting <span class="hljs-id">#chBootstrap</span> to cause callDelicious to be called with bootstrap
    ✓ expects selecting <span class="hljs-id">#chJavaScript</span> to cause callDelicious to be called with javascript
    ✓ expects selecting <span class="hljs-id">#chNodeJs</span> to cause callDelicious to be called with nodejs
    ✓ selecting <span class="hljs-id">#chNodeJs</span> &amp; <span class="hljs-id">#chJavaScript</span> to cause callDelicious to be called with javascript+nodejs
</code></pre><h2 id="favicon">Favicon</h2>
<p>Be sure your favicon is set up correctly in <strong>app.js</strong> around line 18. The correct code will probably look like this:</p>
<pre><code class="lang-javascript">app.<span class="hljs-keyword">use</span>(favicon(path.<span class="hljs-keyword">join</span>(__dirname, <span class="hljs-string">'public'</span>, <span class="hljs-string">'favicon.png'</span>)));
</code></pre>
<h2 id="tests-clean">Tests Clean</h2>
<p>The following should all come back clean and work:</p>
<ul>
<li>grunt jscs</li>
<li>grunt jshint</li>
<li>grunt check</li>
<li>grunt fixture</li>
<li>grunt test</li>
<li>karma start</li>
<li>npm start</li>
<li>npm test</li>
</ul>
<p>There are some exceptions. In the <strong>spec/data</strong> directory you should have one or more files with names like <strong>bitly-links.js</strong> and <strong>delicious-links.js</strong>. In <strong>Gruntfile.js</strong> you can exclude these files from your <strong>jscs</strong> checks:</p>
<pre><code class="lang-javascript"><span class="hljs-tag">jscs</span>: <span class="hljs-rules">{
    <span class="hljs-rule"><span class="hljs-attribute">src</span>:<span class="hljs-value"> [<span class="hljs-string">'**/*.js'</span>, <span class="hljs-string">'!spec/data/*.js'</span>],
    options: {
        config: <span class="hljs-string">'.jscsrc'</span>
    </span></span></span>}
},
</code></pre>
</div></body></html>