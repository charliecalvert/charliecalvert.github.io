<!DOCTYPE html><html lang="en" dir="ltr"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width initial-scale=1.0"><title>HyperlinkExplorer</title><link href="/css/first-style.css" rel="stylesheet"><link rel="shortcut icon" href="/images/favicon.png"><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet"><link href="/css/highlight/googlecode.css" rel="stylesheet" type="text/css"><link href="/css/style.css" rel="stylesheet"><script src="https://code.jquery.com/jquery-1.12.0.min.js"></script><script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<!-- Latest compiled and minified CSS --><script src="/js/elven-help.js"></script></head><body><nav class="navbar navbar-inverse"><div class="container"><div class="navbar-header"><button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><a class="navbar-brand" href="/">Elvenware</a></div><div class="navbar-collapse collapse" id="navbar"><ul class="nav navbar-nav"><li class="trigger-collapse" ng-class="{ active: isActive('/')}"><a href="/">Home</a></li><li><a href="/about.html">About</a></li></ul></div></div></nav><div class="container"><figure><img class="elf-normal" alt="Elvenware" src="/images/elvenwarelogo.png"/></figure><h1>HyperlinkExplorer</h1><p>Welcome to HyperlinkExplorer</p><ul><!--TOC_Start--><li><a href="#overview">Overview</a></li>
<li><a href="#hyperlink-explorer">Hyperlink Explorer</a></li>
<li><a href="#updates">Updates</a></li>
<li><a href="#data-directory">Create a Spec Data Directory</a></li>
<li><a href="#test-your-work">Test your work</a></li>
<li><a href="#delicious-utils">Delicious Utils</a></li>
<li><a href="#the-logger">The logger</a></li>
<li><a href="#movement-tests">Movement Tests</a></li>
<li><a href="#delicious-tests">Delicious Tests</a></li>
<li><a href="#other-tests">Other Tests</a></li>
<li><a href="#favicon">Favicon</a></li>
<li><a href="#tests-clean">Tests Clean</a></li><!--TOC_End--></ul></div><div class="container"><a class="anchor" id="overview"></a>
<h2>Overview</h2>
<p>We further refine the midterm, getting ready for the final.</p>
<a class="anchor" id="hyperlink-explorer"></a>
<h2>Hyperlink Explorer</h2>
<p>It&#39;s time to give our project a name. We&#39;ll call it the Hyperlink Explorer.</p>
<p>Copy your midterm into a new folder:</p>
<pre>cp -r Week08-Midterm Week10-HyperExplorer
</pre>
<p>Open the project in WebStorm or your editor of choice.</p>
<p>Make the necessary changes regarding names.</p>
<p>Change the name of the class called elfMidterm to <strong>elfHyperExplorer</strong>. As a result of this change you will probably also need to make a change to your <strong>document.ready</strong> function.</p>
<a class="anchor" id="updates"></a>
<h2>Updates</h2>
<p>Copy in the most recent tests from the templates directory:</p>
<pre>cp $ELF_TEMPLATES/UnitTest/HyperExplorer/test*.js spec/.
</pre>
<p>Unless you have made your own modifications to these files, simply copy in the most recent mixins:</p>
<pre>cp $ELF_TEMPLATES/JadeMixins/mixin*.jade views/.
</pre>
<p>If you did modify them, then do a diff or meld to update the files, being sure that the left and right iteration buttons have ID&#39;s of <strong>leftButton</strong> and <strong>rightButton</strong>.</p>
<a class="anchor" id="data-directory"></a>
<h2>Create a Spec Data Directory</h2>
<p>Something like this:</p>
<pre>mkdir spec/data
git mv spec/bitly-links.js spec/data/.
</pre>
<p>Copy your <strong>delicious-javascript-links.js</strong> file from the DelicousQuery project into <strong>spec/data</strong>.</p>
<a class="anchor" id="test-your-work"></a>
<h2>Test your work</h2>
<p>My callDelicious method looks like this:</p>
<pre>callDelicious: function(subject) {
        'use strict';
        var feedUrl = 'http://feeds.delicious.com/v2/json/charliecalvert/' + subject;
        $.ajax({
            url: feedUrl,

            dataType: 'jsonp',

            success: function(data) {
                elfDelicious.deliciousLinks = data;
                $('#urlDelicious').empty();
                $.each(elfDelicious.deliciousLinks, function(index, deliciousLink) {
                    elfDelicious.appendUrl(index, deliciousLink);
                });
                $('#deliciousDetails').html(JSON.stringify(elfDelicious.deliciousLinks, null, 4));
            }
        });
    },
</pre>
<p>Copy in the delicious test suite:</p>
<pre>cp $ELF_TEMPLATES/UnitTest/HyperExplorer/test-delicious.js spec/.
</pre>
<p>Make sure they all pass.</p>
<a class="anchor" id="delicious-utils"></a>
<h2>Delicious Utils</h2>
<p>Move the following functions from DeliciousQuery to an object called <strong>elfDeliciousUtils</strong>:</p>
<ul>
<li>&#39;filter&#39;</li>
<li>&#39;getAllUrls&#39;</li>
<li>&#39;getDescriptionTag&#39;</li>
<li>&#39;getMap&#39;</li>
<li>&#39;getMapBig&#39;</li>
<li>&#39;getMapMidSize&#39;</li>
<li>&#39;getOwnerNameMap&#39;</li>
</ul>
<p>Something like this:</p>
<pre>var elfDeliciousUtils = {

    getAllUrls: function() {
        'use strict';
        // AND SO ON...
    },

    getMap: function() { ...

    // LOTS OF CODE OMITTED HERE
};
</pre>
<p>To see if you have construcuted it correctly, see the tests in <strong>charlie-test-delicious-analysis.js</strong>. To get the test to load, be sure something like this is in the file object in <strong>karma.conf.js</strong></p>
<pre>files: [
    // CODE OMITTED HERE
    'spec/test*.js',
    'spec/opt-test*.js',
    'spec/charlie-test*.js',
    // CODE OMITTED HERE
],
</pre>
<a class="anchor" id="the-logger"></a>
<h2>The logger</h2>
<p>In <strong>elf-log.js</strong></p>
<pre>(function() {

    'use strict';

    function ElfLog() {
        this.debugLevel = this.logLevelWarn;
    }

    //var levels = ['error', 'warn', 'info', 'silent'];
    var that;

    ElfLog.prototype.logLevelError = 0;
    ElfLog.prototype.logLevelWarn = 1;
    ElfLog.prototype.logLevelDetails = 2;
    ElfLog.prototype.logLevelInfo = 3;
    ElfLog.prototype.logLevelSilent = 4;

    ElfLog.prototype.debugLevel = undefined;

    ElfLog.prototype.setLevel = function(level) {
        this.debugLevel = level;
    };

    ElfLog.prototype.log = function(level, message) {
        // console.log("Level:", level, 'debugLevel: ', this.debugLevel);
        if (level >= this.debugLevel) {
            if (typeof message !== 'string') {
                message = JSON.stringify(message);
            }
            console.log(level+': '+message);
        }
    };

    that = new ElfLog();
    window.elfLog = that;
})();
</pre>
<p>Use it like this:</p>
<pre>elfLog.setLevel(elfLog.logLevelDetails); // Done once per application
elfLog.log(elfLog.logLevelDetails, 'ElfDisplay.Render index: ' + index);
</pre>
<a class="anchor" id="movement-tests"></a>
<h2>Movement Tests</h2>
<p>Make sure you have created spec/fixtures/bitly.html:</p>
<pre>jade views/bitly.jade --out spec/fixtures/
</pre>
<p>Copy over <strong>test-movement</strong> and make sure all the tests pass:</p>
<pre>cp $ELF_TEMPLATES/UnitTest/HyperExplorer/test-movement.js spec/.
</pre>
<p>Key Points:</p>
<ul>
<li>If you spy on function, it is not really called. We can just check if it is called.<ul>
<li>Therefore, don&#39;t check methods down stream of it to see if they are called</li>
</ul>
</li>
<li>We need to click the right button before we can expect the left button to do anything</li>
</ul>
<p>The output we want:</p>
<pre>Test Movement
    ✓ expects a button with an id of #leftButton
    ✓ expects a button with an id of #rightButton
    ✓ shows that elfMovement.left is called when selecting left button
    ✓ shows that elfMovement.right is called when selecting right button
    ✓ shows that elfDisplay.render is not called when selecting only left button
    ✓ shows that elfDisplay.render is called when selecting right then left button
    ✓ shows that elfDisplay.render is called when selecting right button
    ✓ shows that elfDisplay.showRecord is not called when selecting only left button
    ✓ shows that elfDisplay.showRecord is called when selecting right then left button
    ✓ shows that elfDisplay.showRecord is called when selecting right button
    ✓ shows that elfDisplay.showRecord gets valid data
    ✓ shows that movement.right called even if we click many times past end of array
    ✓ shows that the right boundary condition is checked
    ✓ shows that the right boundary condition gets valid data
</pre>
<a class="anchor" id="delicious-tests"></a>
<h2>Delicious Tests</h2>
<p>Make sure you have created spec/fixtures/delicious.html:</p>
<pre>jade views/delicious.jade --out spec/fixtures/
</pre>
<p>Make sure that there is no checkbox selected by default.</p>
<pre>div.panel.panel-default
    div.panel-heading Select one or more CheckBoxes to search Delicious
    div.panel-body
        div
            input#chJavaScript(type='checkbox', name='deliciousCheckBox', value='JavaScript')
            label(for='chJavaScript') JavaScript
        div
            input#chBootstrap(type='checkbox', name='deliciousCheckBox', value='Bootstrap')
            label(for='chBootstrap')  Bootstrap
        div
            input#chNodeJs(type='checkbox', name='deliciousCheckBox', value='Node')
            label(for='chNodeJs')  NodeJs
</pre>
<p>Copy in <strong>text-delicious-fixtures.js</strong>:</p>
<pre>cp $ELF_TEMPLATES/UnitTest/HyperExplorer/test-delicious-fixture.js spec/.
</pre>
<p>Note that if we are spying on a method that has an onclick event, we need to initialize the event after we have spied on the method:</p>
<pre>it('expects selecting #chBootstrap to cause displayCheckBoxSelection to have been called', function() {
    var checkBox = document.getElementById('chBootstrap');
    spyOn(elfDelicious, 'displayCheckboxSelection');
    elfDelicious.deliciousSetup();
    $(checkBox).trigger('click');
    expect(elfDelicious.displayCheckboxSelection).toHaveBeenCalled();
});
</pre>
<a class="anchor" id="other-tests"></a>
<h2>Other Tests</h2>
<p>Ignore these for now.</p>
<pre>it('checks that elfBitly.getLinks calls elfDisplay.renderTable', function() {
    spyOn(elfDisplay, 'renderTable');
    elfBitly.getLinks(elfDownloads.dataTypes.dtBitly);
    expect(elfDisplay.renderTable).toHaveBeenCalled();
});

it('checks elfBitly.getLinks calls elfDisplay.render', function() {
    spyOn(elfDisplay, 'render');
    elfBitly.getLinks(elfDownloads.dataTypes.dtBitly);
    expect(elfDisplay.render).toHaveBeenCalled();
});

it('checks elfBitly.getLinks calls elfBitly.getUrl', function() {
    spyOn(elfBitly, 'getUrl');
    elfBitly.getLinks(elfDownloads.dataTypes.dtBitly);
    expect(elfBitly.getUrl).toHaveBeenCalled();
});

it('shows we can call getLinkHistoryArray', function() {
    elfBitly.getLinks(elfDownloads.dataTypes.dtBitly);
    var historyArray = elfBitly.getLinkHistoryArray();
    expect(historyArray.length).toBe(50);
});

it('shows getLinkHistoryItem sets elfBitly.linkIndex', function() {
    elfBitly.getLinks(elfDownloads.dataTypes.dtBitly);
    var historyArray = elfBitly.getLinkHistoryItem(12, true);
    expect(elfBitly.linkIndex).toBe(12);
});
</pre>
<p>Here are some results:</p>
<pre>Test Delicous Fixture
    ✓ expects a checkbox with an id of #chJavaScript
    ✓ expects a checkbox with an id of #chJavaScript to be a checkbox
    ✓ expects a checkbox with an id of #chBootstrap
    ✓ expects a checkbox with an id of #chBootstrap to be a checkbox
    ✓ expects a checkbox with an id of #chNodeJs
    ✓ expects a checkbox with an id of #chNodeJs to be a checkbox
    ✓ expects selecting #chBootstrap to cause displayCheckBoxSelection to have been called
    ✓ expects selecting #chBootstrap to cause callDelicious to be called
    ✓ expects selecting #chBootstrap to cause callDelicious to be called with bootstrap
    ✓ expects selecting #chJavaScript to cause callDelicious to be called with javascript
    ✓ expects selecting #chNodeJs to cause callDelicious to be called with nodejs
    ✓ selecting #chNodeJs & #chJavaScript to cause callDelicious to be called with javascript+nodejs
</pre>
<a class="anchor" id="favicon"></a>
<h2>Favicon</h2>
<p>Be sure your favicon is set up correctly in <strong>app.js</strong> around line 18. The correct code will probably look like this:</p>
<pre>app.use(favicon(path.join(__dirname, 'public', 'favicon.png')));
</pre>
<a class="anchor" id="tests-clean"></a>
<h2>Tests Clean</h2>
<p>The following should all come back clean and work:</p>
<ul>
<li>grunt jscs</li>
<li>grunt jshint</li>
<li>grunt check</li>
<li>grunt fixture</li>
<li>grunt test</li>
<li>karma start</li>
<li>npm start</li>
<li>npm test</li>
</ul>
<p>There are some exceptions. In the <strong>spec/data</strong> directory you should have one or more files with names like <strong>bitly-links.js</strong> and <strong>delicious-links.js</strong>. In <strong>Gruntfile.js</strong> you can exclude these files from your <strong>jscs</strong> checks:</p>
<pre>jscs: {
    src: ['**/*.js', '!spec/data/*.js'],
    options: {
        config: '.jscsrc'
    }
},
</pre>
</div></body></html>