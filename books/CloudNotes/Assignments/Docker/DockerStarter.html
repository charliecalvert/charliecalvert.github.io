<!DOCTYPE html><html lang="en" dir="ltr"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width initial-scale=1.0"><title>DockerStarter</title><link href="/css/first-style.css" rel="stylesheet"><link rel="shortcut icon" href="/images/favicon.png"><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet"><link href="/css/highlight/googlecode.css" rel="stylesheet" type="text/css"><link href="/css/style.css" rel="stylesheet"><script src="https://code.jquery.com/jquery-1.12.0.min.js"></script><script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<!-- Latest compiled and minified CSS --><script src="/js/elven-help.js"></script></head><body><nav class="navbar navbar-inverse"><div class="container"><div class="navbar-header"><button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><a class="navbar-brand" href="/">Elvenware</a></div><div class="navbar-collapse collapse" id="navbar"><ul class="nav navbar-nav"><li class="trigger-collapse" ng-class="{ active: isActive('/')}"><a href="/">Home</a></li><li><a href="/about.html">About</a></li></ul></div></div></nav><div class="container"><figure><img class="elf-normal" alt="Elvenware" src="/images/elvenwarelogo.png"/></figure><h1>DockerStarter</h1><p>Welcome to DockerStarter</p><ul><!--TOC_Start--><li><a href="#overview">Overview</a></li>
<li><a href="#docker-install">Docker Install</a></li>
<li><a href="#docker-hub">Docker Hub</a></li>
<li><a href="#test">Test</a></li>
<li><a href="#docker-push">Docker Push</a></li>
<li><a href="#install-software">Install Software</a></li>
<li><a href="#create-user">Create User</a></li>
<li><a href="#save-new-image">Save New Image</a></li>
<li><a href="#learn-more-about-apache-on-docker">Learn More about Apache on Docker</a></li>
<li><a href="#install-node">Install Node on Docker Instance</a></li>
<li><a href="#delete-an-image">Delete an image</a></li>
<li><a href="#start-a-container">Start a container</a></li>
<li><a href="#references">References</a></li><!--TOC_End--></ul></div><div class="container"><a class="anchor" id="overview"></a>
<h2>Overview</h2>
<p>This assignment introduces Docker.</p>
<a class="anchor" id="docker-install"></a>
<h2>Docker Install</h2>
<p>There are two scripts in <strong>JsObjects/Utilities/InstallScripts</strong>:</p>
<ul>
<li>InstallDockerPart01</li>
<li>InstallDockerPart02</li>
</ul>
<p>Run the first. If it goes without error, then run the second. Type <strong>exit</strong> when it ends.</p>
<a class="anchor" id="docker-hub"></a>
<h2>Docker Hub</h2>
<p>Create an account and sign into the Docker Hub at <a href="https://hub.docker.com/">https://hub.docker.com/</a>.</p>
<p>From your local machine where you created your Docker image, login:</p>
<pre>$ docker login -u charliecalvert
Password:
Login Succeeded
</pre>
<p><a href="https://hub.docker.com/billing-plans/">https://hub.docker.com/billing-plans/</a></p>
<a class="anchor" id="test"></a>
<h2>Test</h2>
<pre>docker run -i hello-world
docker images
docker run -it ubuntu
</pre>
<a class="anchor" id="docker-push"></a>
<h2>Docker Push</h2>
<p>To push an image created by user <strong>charliecalvert</strong> called <strong>makehtml04</strong> to the cloud, do this:</p>
<pre><code><span class="hljs-symbol">docker</span> <span class="hljs-keyword">push </span>charliecalvert/makehtml04
</code></pre><a class="anchor" id="install-software"></a>
<h2>Install Software</h2>
<pre><code>apt-<span class="hljs-builtin-name">get</span> update
apt-<span class="hljs-builtin-name">get</span><span class="hljs-built_in"> upgrade
</span>apt-<span class="hljs-builtin-name">get</span> install git
apt-<span class="hljs-builtin-name">get</span> install build-essential
apt-<span class="hljs-builtin-name">get</span> install nano
apt-<span class="hljs-builtin-name">get</span> install curl
apt-<span class="hljs-builtin-name">get</span> install apache2<span class="hljs-built_in">
service </span>apache2 start
</code></pre><p>We are not installing LAMP because we don&#39;t need MySQL or the various scripting languages such as Python or PHP. All we need is Apache, so we are only install it.</p>
<a class="anchor" id="create-user"></a>
<h2>Create User</h2>
<pre><code><span class="hljs-symbol">useradd</span> -ms /<span class="hljs-keyword">bin/bash </span><span class="hljs-keyword">bcuser
</span><span class="hljs-symbol">usermod</span> -aG sudo <span class="hljs-keyword">bcuser
</span><span class="hljs-symbol">su</span> <span class="hljs-keyword">bcuser</span>
</code></pre><p>To confirm that all is as expected:</p>
<pre><code>whoami
<span class="hljs-built_in">pwd</span>
</code></pre><p>When we installed Apache, we created an <strong>/var/www/html</strong> directory. Use <strong>chown</strong> to give <strong>bcuser</strong> the right permissions to access it.</p>
<a class="anchor" id="save-new-image"></a>
<h2>Save New Image</h2>
<p>The changes you make to an image cause the images identifier to change. The identifier is a number like this:</p>
<pre><code>a92<span class="hljs-number">72b30f0b1</span>
</code></pre><p>This number appears in your command prompt.    </p>
<p>When inside Ubuntu, note the image you are using:</p>
<pre>docker commit -m "Added node 8.1 and updated os" -a "charlie" a9272b30f0b1 charliecalvert/makehtml00
docker images
docker run -it charliecalvert/makehtml00
</pre>
<p>And then later, if you make more changes:</p>
<pre><code>docker commit -m <span class="hljs-string">"Added user and JsObjects"</span> -<span class="hljs-selector-tag">a</span> <span class="hljs-string">"charlie"</span> <span class="hljs-number">21</span>a7589a83ee charliecalvert/makehtml01
</code></pre><a class="anchor" id="learn-more-about-apache-on-docker"></a>
<h2>Learn More about Apache on Docker</h2>
<p>Get the IP address:</p>
<p>  docker inspect -f &#39;{{range .NetworkSettings.Networks}}{{.IPAddress}}{{end}}&#39; 9a8cd9005efe</p>
<p>We are going to be running apache from our container, so we don&#39;t want it running on the VirtualBox copy of our Ubuntu server. Therefore, if apache2 is running on your VirtualBox copy of the Ubuntu Server, then do this:</p>
<pre><code>sudo<span class="hljs-built_in"> service </span>apache2 stop
</code></pre><p>Now start your container and ask the VirtualBox copy of your Ubuntu server to host the container&#39;s instance of apache on port 80:  </p>
<pre><code>docker <span class="hljs-built_in">run</span> -<span class="hljs-keyword">it</span> -p <span class="hljs-number">80</span>:<span class="hljs-number">80</span> charliecalvert/makehtml02
</code></pre><p>Note that inside the container, you may have to start apache2.</p>
<p>Map a drive on server to your container so you don&#39;t have save the container if you make changes:</p>
<pre><code>docker run -p <span class="hljs-number">80</span>:<span class="hljs-number">80</span> -d -v <span class="hljs-regexp">/Users/</span>dan<span class="hljs-regexp">/site:/</span>var<span class="hljs-regexp">/www/</span>site mysite
</code></pre><a class="anchor" id="install-node"></a>
<h2>Install Node on Docker Instance</h2>
<pre>curl -sL https://deb.nodesource.com/setup_8.x | bash -
apt-get install -y nodejs
</pre>
<a class="anchor" id="delete-an-image"></a>
<h2>Delete an image</h2>
<p>The basic command looks like this:</p>
<pre><code>docker rmi <span class="hljs-tag">&lt;<span class="hljs-name">ImageName</span>&gt;</span>
</code></pre><p>Like this:</p>
<pre><code><span class="hljs-attribute">docker</span> rmi charliecalvert/foobar
</code></pre><p>Sometimes, when you try that, you get this:</p>
<pre><code>$ docker rmi charliecalvert/foobar
<span class="hljs-keyword">Error </span>response from daemon: conflict: unable to remove repository reference "charliecalvert/foobar" (must force) - container a37009760711 is using its referenced image 982c61b58757
</code></pre><p>In that case, delete the referenced container with the <strong>rm</strong> command:</p>
<pre><code>$ docker rm a<span class="hljs-number">37009760711</span>
a<span class="hljs-number">37009760711</span>
</code></pre><p>Now you should be able to delete the image:</p>
<pre><code>ubuntu<span class="hljs-variable">@ip</span>-<span class="hljs-number">172</span>-<span class="hljs-number">31</span>-<span class="hljs-number">26</span>-<span class="hljs-number">184</span><span class="hljs-symbol">:~/DockerCode/MakeHtml</span>
<span class="hljs-variable">$ </span>docker rmi charliecalvert/foobar
<span class="hljs-symbol">Untagged:</span> charliecalvert/<span class="hljs-symbol">foobar:</span>latest
<span class="hljs-symbol">Deleted:</span> <span class="hljs-symbol">sha256:</span><span class="hljs-number">982</span>c61b5875720bbe5d3a8fa02c0e932734add5c366e2bb6c3d691b4798c128d
</code></pre><a class="anchor" id="start-a-container"></a>
<h2>Start a container</h2>
<p>If you have a container (not an image) called <strong>epic_jang</strong>, start it, and then hop into it:</p>
<pre><code>docker <span class="hljs-built_in">start</span> epic_jang
docker exec -<span class="hljs-keyword">it</span> epic_jang bash
</code></pre><p>To leave the container and return to the server, type <strong>exit</strong>.</p>
<p>Stop it like this:</p>
<pre><code>docker <span class="hljs-built_in">stop</span> epic_jang
</code></pre><p>Alternately, you can <strong>commit</strong> the container to an image and then run the image:</p>
<pre><code>docker commit epic_jang foo
docker <span class="hljs-built_in">run</span> -<span class="hljs-keyword">it</span> foo
</code></pre><a class="anchor" id="references"></a>
<h2>References</h2>
<p>These are useful:</p>
<ul>
<li><a href="https://docs.docker.com/glossary/">Docker Glossary</a></li>
</ul>
<p>This is for later:</p>
<ul>
<li><a href="https://writing.pupius.co.uk/apache-and-php-on-docker-44faef716150">https://writing.pupius.co.uk/apache-and-php-on-docker-44faef716150</a></li>
<li><a href="https://www.linode.com/docs/websites/hosting-a-website">https://www.linode.com/docs/websites/hosting-a-website</a></li>
</ul>
</div></body></html>