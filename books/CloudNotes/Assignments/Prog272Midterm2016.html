<!DOCTYPE html><html lang="en" dir="ltr"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width initial-scale=1.0"><title>Prog272Midterm2016</title><link href="/css/first-style.css" rel="stylesheet"><link rel="shortcut icon" href="/images/favicon.png"><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet"><link href="/css/highlight/googlecode.css" rel="stylesheet" type="text/css"><link href="/css/style.css" rel="stylesheet"><script src="https://code.jquery.com/jquery-1.12.0.min.js"></script><script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<!-- Latest compiled and minified CSS --><script src="/js/elven-help.js"></script></head><body><nav class="navbar navbar-inverse"><div class="container"><div class="navbar-header"><button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><a class="navbar-brand" href="/">Elvenware</a></div><div class="navbar-collapse collapse" id="navbar"><ul class="nav navbar-nav"><li class="trigger-collapse" ng-class="{ active: isActive('/')}"><a href="/">Home</a></li><li><a href="/about.html">About</a></li></ul></div></div></nav><div class="container"><figure><img class="elf-normal" alt="Elvenware" src="/images/elvenwarelogo.png"/></figure><h1>Prog272Midterm2016</h1><p>Welcome to Prog272Midterm2016</p><ul><!--TOC_Start--><li><a href="#overview">Overview</a></li>
<li><a href="#energy-json">Energy Json</a></li>
<li><a href="#energy-view">Energy View</a></li>
<li><a href="#msn-types">MSN Types</a></li>
<li><a href="#page-steps">Create New Page Steps</a></li>
<li><a href="#testing">Testing</a></li>
<li><a href="#menu">Menu</a></li>
<li><a href="#turn-it-in">Turn it in</a></li>
<li><a href="#hints">Hints</a></li>
<li><a href="#hard-test">The Hardest Test</a></li>
<li><a href="#jscs">JSCS</a></li>
<li><a href="#getjson-tests">getJSON Tests</a></li>
<li><a href="#client-renewables">client-renewables</a></li><!--TOC_End--></ul></div><div class="container"><a class="anchor" id="overview"></a>
<h2>Overview</h2>
<p>We are now turning a major corner in the course. Rather than learning new technologies, we are going to spend most of our time refactoring code and adding new features.</p>
<p>A well designed architecture supports the <a href="https://en.wikipedia.org/wiki/Open/closed_principle">Open Closed Principle</a>:</p>
<ul>
<li><em><strong>Modules, Classes and Functions should be open to extension by closed to modification.</strong></em></li>
</ul>
<p>Along with <a href="https://en.wikipedia.org/wiki/Loose_coupling">loose coupling</a> the <a href="https://en.wikipedia.org/wiki/Single_responsibility_principle">single-responsibility princeple</a> and <a href="https://en.wikipedia.org/wiki/Test-driven_development">TDD</a> the open closed principle is one of the foundations of good software design. My classes are not really about Linux, git, Angular, jQuery, or express. They are about how to build applications using our core ideas:</p>
<ul>
<li><a href="http://agiledata.org/essays/tdd.html">Test Driven Development (TDD)</a></li>
<li><a href="http://edn.embarcadero.com/article/30372">Loose Coupling</a></li>
<li><a href="http://www.oodesign.com/single-responsibility-principle.html">The Single Responsibility Principle</a></li>
<li><a href="http://www.oodesign.com/open-close-principle.html">The Open Closed Principle</a></li>
</ul>
<p>Another important design principle not emphasized in this class is the <a href="http://www.oodesign.com/dependency-inversion-principle.html">Dependency Inversion Principle</a>.</p>
<p>Slide decks that might be useful:</p>
<ul>
<li>Agile Overview: <a href="http://bit.ly/1qf6V4t">http://bit.ly/1qf6V4t</a></li>
<li>Refactoring: <a href="http://bit.ly/elfrefactor">http://bit.ly/elfrefactor</a></li>
</ul>
<p>As a general rule, these are the rules, ideas and guiding principles that make possible agile development:</p>
<ul>
<li><a href="http://www.agilemanifesto.org/">http://www.agilemanifesto.org/</a></li>
<li><a href="http://www.agilemanifesto.org/principles.html">http://www.agilemanifesto.org/principles.html</a></li>
</ul>
<a class="anchor" id="energy-json"></a>
<h2>Energy Json</h2>
<p>We now want to start working with the file called <strong>data/RenewableTypes.json</strong>. I for see a problem here that we ought to address right off. We are already working with a file called <strong>Renewables</strong>. It will be too confusing if we are always trying to distinguish between <strong>RenewablesTypesByYear</strong> and <strong>RenewablesByYear</strong>. To avoid this, let&#39;s use <strong>git mv</strong> to rename  <strong>data/RenewableTypes.json</strong> to <strong>data/HighTechEnergy.json</strong>.</p>
<a class="anchor" id="energy-view"></a>
<h2>Energy View</h2>
<p>It is now time to start viewing and working with <strong>HighTechEnergy.json</strong>.</p>
<p>Clearly partition the <em>energy</em> files from the rest by creating a folders called <strong>high-tech-energy</strong> in <strong>public/javascripts</strong> and <strong>views</strong>.</p>
<p>Put the following files in <strong>public/javascript/high-tech-energy</strong>:</p>
<ul>
<li>energy-overview.js  </li>
<li>energy-types.js  </li>
<li>msn-types.js</li>
</ul>
<p>In <strong>views/high-tech-energy</strong>, place these files</p>
<ul>
<li>energy-overview-page.jade</li>
<li>energy-types-page.jade</li>
</ul>
<p><img src="https://s3.amazonaws.com/bucket01.elvenware.com/images/prog272-midterm-2016-02.png" alt="Part Way"></p>
<p><strong>Figure 01</strong>: <em>Just getting far enough to see you can load the data.</em></p>
<p><img src="https://s3.amazonaws.com/bucket01.elvenware.com/images/prog272-midterm-2016-01.png" alt="Part Way"></p>
<p><strong>Figure 02</strong>: <em>Just getting far enough to see you can load the types.</em></p>
<p><img src="https://s3.amazonaws.com/bucket01.elvenware.com/images/prog272-midterm-2016-01a.png" alt="A bit more"></p>
<p><strong>Figure 02a</strong>: <em>Making a bit more progress on displaying types.</em></p>
<a class="anchor" id="msn-types"></a>
<h2>MSN Types</h2>
<p>Here is one way to implement the <strong>public/javascripts/high-tech-energy/msn-types.js</strong> file. Some of you have done it on the server, some of you did it by yourself. But if you need help with it, here is my version, which is on the client:</p>
<pre><code class="lang-javascript">define(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
<span class="hljs-meta">    'use strict'</span>;

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getMsnTypes</span>(<span class="hljs-params">energyTypes</span>) </span>{
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'getMsnTypes called'</span>);
        <span class="hljs-keyword">var</span> currentMsn = {
            <span class="hljs-attr">msn</span>: <span class="hljs-literal">null</span>,
            <span class="hljs-attr">description</span>: <span class="hljs-string">''</span>
        };
        <span class="hljs-keyword">var</span> msnTypes = [];

        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">insertNewCurrentMsn</span>(<span class="hljs-params">energyType</span>) </span>{
            currentMsn = <span class="hljs-built_in">Object</span>.create(currentMsn);
            currentMsn.msn = energyType.MSN;
            currentMsn.description = energyType.Description;
            msnTypes.push(currentMsn);
        }

        insertNewCurrentMsn(energyTypes[<span class="hljs-number">0</span>]);

        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isUnique</span>(<span class="hljs-params">msn</span>) </span>{
            <span class="hljs-keyword">var</span> result = <span class="hljs-literal">true</span>;
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; msnTypes.length; i++) {
                <span class="hljs-keyword">if</span> (msn === msnTypes[i].msn) {
                    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'msn vs c.msn'</span>, msn, currentMsn.msn);
                    result = <span class="hljs-literal">false</span>;
                    <span class="hljs-keyword">break</span>;
                }
            }
            <span class="hljs-keyword">return</span> result;
        }

        energyTypes.forEach(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">energyType, index</span>) </span>{
            <span class="hljs-comment">// console.log('energyType index and index length', index, msnTypes.length);</span>
            energyType.Year = energyType.YYYYMM.substr(<span class="hljs-number">0</span>, <span class="hljs-number">4</span>);
            energyType.Month = energyType.YYYYMM.substr(<span class="hljs-number">4</span>);
            <span class="hljs-keyword">if</span> (energyType.MSN !== currentMsn.msn) {
                <span class="hljs-keyword">if</span> (isUnique(energyType.MSN)) {
                    <span class="hljs-comment">//console.log('isUnique');</span>
                    insertNewCurrentMsn(energyType);
                }
            }
        });
        <span class="hljs-keyword">return</span> msnTypes;
    }

    <span class="hljs-keyword">return</span> getMsnTypes;
});
</code></pre>
<a class="anchor" id="page-steps"></a>
<h3>Create New Page Steps</h3>
<p>Executive Summary</p>
<p>In <strong>public/javascripts</strong></p>
<ul>
<li>Modify <strong>control.js</strong> to call <strong>renewables.init</strong></li>
<li>Create your main object in page: <strong>renewables/renewables-index.js</strong></li>
<li>In the requirejs based <strong>main.js</strong> load <strong>renewables/renewables-index.js</strong></li>
<li>In <strong>renewables/renewables-index.js</strong>: load <strong>view/renewables-index.jade</strong></li>
</ul>
<p>In Views:</p>
<ul>
<li>Create corresponding jade file: <strong>renewables-by-index.jade</strong></li>
<li>Add launch button or menu item to <strong>index.jade</strong></li>
</ul>
<p>See this project: <a href="https://github.com/charliecalvert/JsObjects/tree/master/JavaScript/UnitTests/JasmineRequireJs">Jasmine Require Js</a></p>
<a class="anchor" id="testing"></a>
<h2>Testing</h2>
<p>Again, see this project which gives a working demonstration of how to set up jasmine to test a requirejs project</p>
<ul>
<li><a href="https://github.com/charliecalvert/JsObjects/tree/master/JavaScript/UnitTests/JasmineRequireJs">Jasmine Require Js</a></li>
</ul>
<p>Pay special attention to the <strong>karma.conf.js</strong> file. Some key points in it are called out later in this section.</p>
<p>But first, make sure you have some key packages installed:</p>
<pre>
npm install karma-requirejs --save-dev
npm install requirejs --save-dev
npm install jasmine-jquery --save-dev
</pre>

<p>Your <strong>karma.conf.js</strong> file should use the requirejs framework. Explicitly load <strong>main-test.js</strong> and explicitly ignore <strong>public/javascripts/main.js</strong>.</p>
<pre><code class="lang-javascript"><span class="hljs-string">frameworks:</span> [<span class="hljs-string">'jasmine'</span>, <span class="hljs-string">'requirejs'</span>],
<span class="hljs-symbol">
files:</span> [
    <span class="hljs-string">'public/components/jquery/dist/jquery.min.js'</span>,
    <span class="hljs-comment">//'public/components/requirejs/require.js',</span>
    <span class="hljs-string">'node_modules/jasmine-jquery/lib/*.js'</span>, {
<span class="hljs-symbol">        pattern:</span> <span class="hljs-string">'spec/test-*.js'</span>,
<span class="hljs-symbol">        included:</span> <span class="hljs-literal">false</span>
    }, {
<span class="hljs-symbol">        pattern:</span> <span class="hljs-string">'spec/data/client-renewables.js'</span>,
<span class="hljs-symbol">        included:</span> <span class="hljs-literal">false</span>
    }, {
<span class="hljs-symbol">        pattern:</span> <span class="hljs-string">'public/javascripts/**/*.js'</span>,
<span class="hljs-symbol">        included:</span> <span class="hljs-literal">false</span>
    },
    <span class="hljs-string">'spec/main-test.js'</span>,
    <span class="hljs-string">'*.html'</span>
],

<span class="hljs-comment">// list of files to exclude</span>
<span class="hljs-string">exclude:</span> [<span class="hljs-string">'public/javascripts/main.js'</span>],
</code></pre>
<p>Remove the <strong>plugins</strong> section from the end of <strong>karma.conf.js</strong>:</p>
<pre><code class="lang-javascript"><span class="hljs-attribute">singleRun</span>: false

<span class="sml">/*
  <span class="hljs-type">YOU</span> <span class="hljs-type">CAN</span> <span class="hljs-type">JUST</span> <span class="hljs-type">DELETE</span> <span class="hljs-type">IT</span>, <span class="hljs-type">BUT</span> <span class="hljs-type">I</span> <span class="hljs-type">WANT</span> <span class="hljs-type">TO</span> <span class="hljs-type">SHOW</span> <span class="hljs-type">YOU</span> <span class="hljs-type">WHAT</span> <span class="hljs-type">TO</span> <span class="hljs-type">DELETE</span>
plugins: [<span class="hljs-symbol">'karma</span>-jasmine',
    <span class="hljs-symbol">'karma</span>-spec-reporter',
    <span class="hljs-symbol">'karma</span>-phantomjs-launcher',
    <span class="hljs-symbol">'karma</span>-chrome-launcher'
] */</span>
</code></pre>
<p>Once again, don&#39;t forget the JasmineRequireJs project linked at the beginning of this section.</p>
<p>We need to create a requirejs file explicitly for our tests. Call the file <strong>spec/main-test.js</strong>.</p>
<pre><code class="lang-javascript"><span class="hljs-comment">/**
 * @author Charlie Calvert
 */</span>

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">loadTestsIntoArray</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> tests = [];
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> file <span class="hljs-keyword">in</span> <span class="hljs-built_in">window</span>.__karma__.files) {
        <span class="hljs-keyword">if</span> (<span class="hljs-regexp">/test-/</span>.test(file)) {
            <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'Loaded test:'</span>, file);
            tests.push(file);
        }
    }
    <span class="hljs-keyword">return</span> tests;
}

<span class="hljs-built_in">require</span>.config({
    <span class="hljs-attr">baseUrl</span>: <span class="hljs-string">'/base'</span>,

    <span class="hljs-attr">paths</span>: {
        <span class="hljs-attr">control</span>: <span class="hljs-string">'public/javascripts/control'</span>,
        <span class="hljs-attr">home</span>: <span class="hljs-string">'public/javascripts/home'</span>,
        <span class="hljs-attr">renewables</span>: <span class="hljs-string">'public/javascripts/renewables/renewables'</span>,
        <span class="hljs-comment">// THE REST LEFT AS AN EXERCISE</span>
    },
    <span class="hljs-attr">deps</span>: loadTestsIntoArray(),
    <span class="hljs-attr">callback</span>: <span class="hljs-built_in">window</span>.__karma__.start
});
</code></pre>
<p>It is one of the oddities of karma that <strong>/base</strong> points to the root of your project.</p>
<p>A simple test of the home page would look like this:</p>
<pre><code class="lang-javascript">define([<span class="hljs-string">'home'</span>], <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">home</span>) </span>{


    describe(<span class="hljs-string">'Home Page Suite'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
<span class="hljs-meta">
        'use strict'</span>;

        it(<span class="hljs-string">'expects true to be true'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
            expect(<span class="hljs-literal">true</span>).toBe(<span class="hljs-literal">true</span>);
        });

        it(<span class="hljs-string">'expects home.color to be red'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
            expect(home.color).toBe(<span class="hljs-string">'red'</span>);
        });

        it(<span class="hljs-string">'expects home.size to be big'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
            expect(home.size).toBe(<span class="hljs-string">'big'</span>);
        });

    });

});
</code></pre>
<p>You will find the tests for the midterm here:</p>
<ul>
<li><a href="https://github.com/charliecalvert/JsObjects/tree/master/Utilities/Templates/UnitTest/SolarVoyager">JsObjects/Utilities/Templates/UnitTest/SolarVoyager</a></li>
</ul>
<p>Copy those files into your spec directory, and make sure they all pass.</p>
<p>Check regularly for updates. All the tests should pass.</p>
<a class="anchor" id="menu"></a>
<h2>Menu</h2>
<pre>
extends layout

block content
    header.navbar.navbar-inverse.navbar-fixed-top.bs-docs-nav(role='banner')
        .container
            .navbar-header
                button.navbar-toggle(type='button', data-toggle='collapse', data-target='.bs-navbar-collapse')
                    span.sr-only Toggle navigation
                    span.icon-bar
                    span.icon-bar
                    span.icon-bar
                a.navbar-brand(href='/') Solar Explorer
            nav.collapse.navbar-collapse.bs-navbar-collapse(role="navigation")
                ul.nav.navbar-nav
                    li.trigger-collapse(ng-class="{ active: isActive('/')}")
                        a.homeMenu Home
                    li.collapse.dropdown
                        a.dropdown-toggle(data-toggle='dropdown')
                            | Renewables
                            b.caret
                        ul.dropdown-menu(role='menu')
                            li.trigger-collapse(ng-class="{ active: isActive('/renewables')}")
                                a.renewablesMenu Renewables
                                                        // YOU FILL IN THESE TWO ITEMS        
                    li.collapse.dropdown
                        a.dropdown-toggle(data-toggle='dropdown')
                            | Energy
                            b.caret
                        ul.dropdown-menu(role='menu')
                                                        // BASED ON THE DROP DOWN SHOWN ABOVE
                                                        // YOU DEFINE EnerygyOverview and EnergyTypes
                    li.trigger-collapse(ng-class="{ active: isActive('/about')}")
                        a.aboutMenu About
    .container

        h1= title
        p Welcome to #{title}

        button.homeMenu.btn.btn-primary Home
        button.renewablesMenu.btn.btn-info Renewables
        button.renewablesByIndexMenu.btn.btn-danger Renewables by Index
        button.renewablesByYearMenu.btn.btn-warning Renewables by Year
        button.aboutMenu.btn.btn-success About

        div
            button.highTechEnergyOverviewMenu.btn.btn-info High Tech Energy Overview
            button.highTechEnergyTypesMenu.btn.btn-danger High Tech Energy Types


    #elf-view

  pre#debug
</pre>


<a class="anchor" id="turn-it-in"></a>
<h2>Turn it in</h2>
<p>Make sure the tests from JsObjects pass and <strong>grunt check</strong> passes. Put your work in a branch called <strong>week08</strong> or <strong>week08-midterm</strong>. Be sure to tell me the branch it is in when you turn in the assignment.</p>
<p>Make sure both <strong>karma start</strong> and <strong>node jasmine-runner</strong> pass without error. Use the latest versions of the tests from JsObjects. When preparing your tests for the midterm, please make sure all of the following works:</p>
<pre><code>grunt<span class="hljs-built_in"> check
</span>node jasmine-runner.js
karma start
</code></pre><p>If you have any <strong>fits</strong> or <strong>fdescribes</strong> in your code, please remove them so I can see all your tests running. Make sure you have the latest tests from JsObjects.</p>
<a class="anchor" id="hints"></a>
<h2>Hints</h2>
<p>Be sure you renamed work.js to home.js. Rename all associated buttons, menus and files.</p>
<a class="anchor" id="hard-test"></a>
<h2>The Hardest Test</h2>
<p>There are several ways to solve this problem. However, I should mention that to get the test called <em>&#39;expects get renewable to be defined&#39;</em> in <strong>spec/test-renewables.js</strong> to pass, I made some changes to the way my code is structured in <strong>public/javascript/renewables-page.js</strong>:</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">var</span> renewables = {
        <span class="hljs-attr">color</span>: <span class="hljs-string">'red'</span>,
        <span class="hljs-attr">size</span>: <span class="hljs-string">'big'</span>,
        <span class="hljs-attr">renewablesList</span>: [],         &lt; ==== HERE
        getRenewable: getRenewable, &lt; ==== HERE
        init: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
                <span class="hljs-built_in">console</span>.log(renewables.color);
</code></pre>
<p>Then in <strong>getRenewable</strong>, I wrote code like this:</p>
<pre><code class="lang-javascript">$.getJSON(<span class="hljs-string">'/renewables'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span></span>(response) {                
                renew<span class="hljs-type">ables</span>.renew<span class="hljs-type">ablesList</span> = response.renew<span class="hljs-type">ables</span>; &lt; ==== HERE                
                showRenew<span class="hljs-type">able</span>(renew<span class="hljs-type">ables</span>.renew<span class="hljs-type">ablesList</span>[index]); &lt; ==== HERE
});
</code></pre>
<a class="anchor" id="jscs"></a>
<h2>JSCS</h2>
<p>It is okay to turn a JSCS test off in specific cases like this:</p>
<pre><code class="lang-javascript"><span class="hljs-comment">// jscs:disable requireDotNotation</span>
<span class="hljs-selector-tag">return</span> {
    <span class="hljs-attribute">year</span>: renewable.Year,
    <span class="hljs-attribute">solar</span>: renewable[<span class="hljs-string">'Solar (quadrillion Btu)'</span>],
    <span class="hljs-attribute">geo</span>: renewable[<span class="hljs-string">'Geothermal (quadrillion Btu)'</span>],
    <span class="hljs-attribute">otherBiomass</span>: renewable[<span class="hljs-string">'Other biomass (quadrillion Btu)'</span>],
    <span class="hljs-attribute">wind</span>: renewable[<span class="hljs-string">'Wind power (quadrillion Btu)'</span>],
    <span class="hljs-attribute">liquidBiofuels</span>: renewable[<span class="hljs-string">'Liquid biofuels (quadrillion Btu)'</span>],
    <span class="hljs-attribute">wood</span>: renewable[<span class="hljs-string">'Wood biomass (quadrillion Btu)'</span>],
    <span class="hljs-attribute">hydropower</span>: renewable[<span class="hljs-string">'Hydropower (quadrillion Btu)'</span>]
};
<span class="hljs-comment">// jscs:enable requireDotNotation</span>
</code></pre>
<p>Note the jscs:enable and jscs:disable directives.</p>
<ul>
<li><p><a href="http://jscs.info/overview#error-suppression">http://jscs.info/overview#error-suppression</a></p>
</li>
<li><p><a href="http://stackoverflow.com/questions/25223149/is-there-any-way-for-jscs-to-ignore-rules-per-file-block-or-line">http://stackoverflow.com/questions/25223149/is-there-any-way-for-jscs-to-ignore-rules-per-file-block-or-line</a></p>
</li>
</ul>
<p>Just don&#39;t do it at random. Only in small, isolated cases like this where we really have a good reason to go against the JSCS formatting rules.</p>
<a class="anchor" id="getjson-tests"></a>
<h2>getJSON Tests</h2>
<p>The order in which you declare the event handlers for getJSON can matter because of the way I have set up the tests. I do them in this order:</p>
<ul>
<li>fail</li>
<li>done</li>
<li>always</li>
</ul>
<p>Like this:</p>
<pre><code class="lang-javascript">$.getJSON(<span class="hljs-string">'/renewables'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">response</span>) </span>{
     <span class="hljs-comment">// CODE OMITTED HERE</span>
     })
     .fail(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a, b, c</span>) </span>{
             <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'Error'</span>, a, b, c);
             $(<span class="hljs-string">'#debug'</span>).html(<span class="hljs-string">'Error occured: '</span>, a.status);
     })
     .done(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
             <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'second success'</span>);
     })
     .always(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
             <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'complete'</span>);
     });
</code></pre>
<p>This matters because my test calls each of them in a specific order. From <strong>test-renewables.js</strong> in <strong>expects getRenewable to be defined</strong>:</p>
<pre><code class="lang-javascript"><span class="hljs-selector-tag">return</span> {
     <span class="hljs-attribute">fail</span>: <span class="hljs-built_in">function</span>() {
             return {
                     done: <span class="hljs-built_in">function</span>() {
                             return {
                                     always: <span class="hljs-built_in">function</span>() {}
                             };
                     }
             };
     }
};
</code></pre>
<a class="anchor" id="client-renewables"></a>
<h2>client-renewables</h2>
<p>This is the mock data used in the hard test from <strong>test-renewables</strong>. Put it in <strong>spec/data/client-renewables.js</strong>:</p>
<pre><code class="lang-javascript">define(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
<span class="hljs-meta">    'use strict'</span>;
    <span class="hljs-keyword">return</span> [{
        <span class="hljs-string">"Year"</span>: <span class="hljs-string">"2017"</span>,
        <span class="hljs-string">"Solar (quadrillion Btu)"</span>: <span class="hljs-string">"0.8045307"</span>,
        <span class="hljs-string">"Geothermal (quadrillion Btu)"</span>: <span class="hljs-string">"0.2349284"</span>,
        <span class="hljs-string">"Other biomass (quadrillion Btu)"</span>: <span class="hljs-string">"0.50916"</span>,
        <span class="hljs-string">"Wind power (quadrillion Btu)"</span>: <span class="hljs-string">"2.202328"</span>,
        <span class="hljs-string">"Liquid biofuels (quadrillion Btu)"</span>: <span class="hljs-string">"1.2329197"</span>,
        <span class="hljs-string">"Wood biomass (quadrillion Btu)"</span>: <span class="hljs-string">"1.9860924"</span>,
        <span class="hljs-string">"Hydropower (quadrillion Btu)"</span>: <span class="hljs-string">"2.5859957"</span>
    }, {
        <span class="hljs-string">"Year"</span>: <span class="hljs-string">"2016"</span>,
        <span class="hljs-string">"Solar (quadrillion Btu)"</span>: <span class="hljs-string">"0.6298938"</span>,
        <span class="hljs-string">"Geothermal (quadrillion Btu)"</span>: <span class="hljs-string">"0.232438"</span>,
        <span class="hljs-string">"Other biomass (quadrillion Btu)"</span>: <span class="hljs-string">"0.5113525"</span>,
        <span class="hljs-string">"Wind power (quadrillion Btu)"</span>: <span class="hljs-string">"2.0395132492"</span>,
        <span class="hljs-string">"Liquid biofuels (quadrillion Btu)"</span>: <span class="hljs-string">"1.2406718727"</span>,
        <span class="hljs-string">"Wood biomass (quadrillion Btu)"</span>: <span class="hljs-string">"1.9724914"</span>,
        <span class="hljs-string">"Hydropower (quadrillion Btu)"</span>: <span class="hljs-string">"2.5965158"</span>
    }, {
    etc...
});
</code></pre>
</div></body></html>