<!DOCTYPE html><html lang="en" dir="ltr"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width initial-scale=1.0"><title>Prog219Midterm2016</title><link rel="shortcut icon" href="/charlie/images/favicon.png"><!-- Latest compiled and minified CSS--><link rel="stylesheet" href="/components/bootstrap/dist/css/bootstrap.min.css"><!-- Optional theme--><link rel="stylesheet" href="/components/bootstrap/dist/css/bootstrap-theme.min.css"><!-- link(href='/libs/css/BootstrapIndex.css', rel='stylesheet', type='text/css')--><link href="/css/style.css" rel="stylesheet" type="text/css"><link href="/css/highlight/googlecode.css" rel="stylesheet" type="text/css"><script src="/components/jquery/dist/jquery.js"></script><script src="/components/angular/angular.js"></script><script src="/components/angular-route/angular-route.js"></script><script src="/components/bootstrap/dist/js/bootstrap.min.js"></script><!-- script(src='/libs/scripts/elvenware.js', type='text/javascript')--><!-- script(src="/libs/scripts/Control.js")--><!-- script(src='http://localhost:35729/livereload.js')--></head><body><div class="navbar navbar-inverse"><div class="container"><div class="navbar-header"><button type="button" data-toggle="collapse" data-target=".navbar-collapse" class="navbar-toggle"><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><a href="/" class="navbar-brand">Elvenware</a></div><div class="collapse navbar-collapse"><ul class="nav navbar-nav"><li class="active"><a href="/index.html">Home</a></li><li><a href="/about">About</a></li><li class="dropdown"><a href="#/" data-toggle="dropdown" class="dropdown-toggle">Dropdown<b class="caret"></b></a><ul class="dropdown-menu"><li class="dropdown-header">Core Code</li><li><a href="/development/index.html">Strongly Typed</a></li><li><a href="/development/web/index.html">Web & Scripts</a></li><li><a href="/development/cloud/index.shtml">Cloud</a></li><li class="divider"></li><li class="dropdown-header">OS and Tools</li><li><a href="/os/index.html">OS</a></li><li><a href="/development/database/index.html">Database</a></li><li><a href="/books/index.html">My Writing</a></li><li class="divider"></li><li class="dropdown-header">Art</li><li><a href="/charlie/Art/index.html">Poems & Photos</a></li><li><a href="/books/reading/index.html">Book Reviews</a></li><li><a href="/spirit/index.html">Spiritual</a></li><li class="divider"></li><li class="dropdown-header">Links</li><li><a href="/charlie/links.html">My Links</a></li><li><a href="http://www.github.com/charliecalvert">GitHub</a></li><li><a href="http://sourceforge.net/projects/elvenware/">Sourceforge</a></li></ul></li></ul></div><!-- /.nav-collapse--></div></div><div class="container"><figure><img alt="Elvenware" src="/charlie/images/elvenwarelogo.png"/></figure><h1>Prog219Midterm2016</h1><h3>Table of Contents</h3><ul><!--TOC_Start--><li><a href="#overview">Overview</a></li>
<li><a href="#new-files">New Files</a></li>
<li><a href="#angular-routes">Angular Routes</a></li>
<li><a href="#energy-types">Energy Types</a></li>
<li><a href="#msn-types">MSN Types</a></li>
<li><a href="#energy-selectors">Energy Selectors</a></li>
<li><a href="#turn-it-in">Turn it in</a></li>
<li><a href="#hints">Hints</a></li>
<li><a href="#karma">Karma</a></li><!--TOC_End--></ul><h2 id="overview">Overview</h2>
<p>We are now turning a major corner in the course. Rather than learning new technologies, we are going to spend most of our time refactoring code and adding new features.</p>
<p>A well designed architecture supports the <a href="https://en.wikipedia.org/wiki/Open/closed_principle">Open Closed Principle</a>:</p>
<ul>
<li><em><strong>Modules, Classes and Functions should be open to extension by closed to modification.</strong></em></li>
</ul>
<p>Along with <a href="https://en.wikipedia.org/wiki/Loose_coupling">loose coupling</a> the <a href="https://en.wikipedia.org/wiki/Single_responsibility_principle">single-responsibility princeple</a> and <a href="https://en.wikipedia.org/wiki/Test-driven_development">TDD</a> the open closed principle is one of the foundations of good software design. My classes are not really about Linux, git, Angular, jQuery, or express. They are about how to build applications using our core ideas:</p>
<ul>
<li><a href="http://agiledata.org/essays/tdd.html">Test Driven Development (TDD)</a></li>
<li><a href="http://edn.embarcadero.com/article/30372">Loose Coupling</a></li>
<li><a href="http://www.oodesign.com/single-responsibility-principle.html">The Single Responsibility Principle</a></li>
<li><a href="http://www.oodesign.com/open-close-principle.html">The Open Closed Principle</a></li>
</ul>
<p>Another important design principle not emphasized in this class is the <a href="http://www.oodesign.com/dependency-inversion-principle.html">Dependency Inversion Principle</a>.</p>
<p>Slide decks that might be useful:</p>
<ul>
<li>Agile Overview: <a href="http://bit.ly/1qf6V4t">http://bit.ly/1qf6V4t</a></li>
<li>Refactoring: <a href="http://bit.ly/elfrefactor">http://bit.ly/elfrefactor</a></li>
</ul>
<p>As a general rule, these are the rules, ideas and guiding principles that make possible agile development:</p>
<ul>
<li><a href="http://www.agilemanifesto.org/">http://www.agilemanifesto.org/</a></li>
<li><a href="http://www.agilemanifesto.org/principles.html">http://www.agilemanifesto.org/principles.html</a></li>
</ul>
<h2 id="new-files">New Files</h2>
<p>Create:</p>
<ul>
<li><strong>EnergyTypesController</strong> in <strong>public/javascripts/energy-types/energy-types.js</strong></li>
<li><strong>energy-types-page.jade</strong> in <strong>views/energy-types/</strong></li>
<li><strong>energy-types.jade</strong> in <strong>views/energy-types/</strong></li>
</ul>
<p>When you load <strong>energy-types.js</strong> in <strong>layout.jade</strong>, don&#39;t forget that you need to specify the directory where it lives.</p>
<p>In <strong>public/javascripts</strong> we also want to create a <em>home</em> page. For now, it can be very simple:</p>
<pre>
h1 Home
</pre>

<h2 id="angular-routes">Angular Routes</h2>
<p>As we add more pages to our app, we have to be sure that our menu and button selections will properly load them. This means making changes to <strong>public/javascripts/app.js</strong>. The routes we need to establish or keep include:</p>
<ul>
<li>home (HomeController)</li>
<li>renewable (main) (MainController, RewnewableController)</li>
<li>simple-format (SimpleFormatController)</li>
<li>renewable-by-year (RenewableByYearController)</li>
<li>energy-types (EnergyTypesController)</li>
<li>energy-selector (EnergySelectorController)</li>
<li>about (AboutController)</li>
</ul>
<p>When you load <strong>energy-types.js</strong> in <strong>layout.jade</strong>, don&#39;t forget that you need to specify the directory where it lives.</p>
<p>Make sure menu collapses in mobile device mode:</p>
<pre>
li.trigger-collapse(ng-class="{ active: isActive('/')}")
</pre>

<pre><code class="lang-javascript">$(<span class="hljs-built_in">document</span>).ready(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    $(<span class="hljs-string">".navbar-nav li.trigger-collapse a"</span>).click(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>) </span>{
        $(<span class="hljs-string">".navbar-collapse"</span>).collapse(<span class="hljs-string">'hide'</span>);
    });
});
</code></pre>
<h2 id="energy-types">Energy Types</h2>
<p>We are not done with this page, but for the midterm, it should look something like this. The design is not important, but the functionality is. In other words, be creative about the way it looks, but be sure your page contains only these features:</p>
<ul>
<li>Menu</li>
<li>The permanent elements from index.jade such as the title <strong>Solar Explorer</strong>.</li>
<li>A title for the loaded page: <strong>Energy Types</strong></li>
<li>A dynamic record count showing how the length of the array you loaded (7008)</li>
<li>The ability to iterate over all 7008 records</li>
<li>A static list of all the unique MSN types</li>
</ul>
<p>My page looks like this at the time of this writing:</p>
<p><img src="https://s3.amazonaws.com/bucket01.elvenware.com/images/prog219-midterm-2016-01.png" alt="Energy Types"></p>
<p><strong>Figure 01</strong>: <em>Note the three bootstrap panels used to display the data in the energy types page.</em></p>
<p>Note that my static MSN list and iterable record list are shown inside of bootstrap panels. You don&#39;t have to use them, but it is a reasonable way to organize a page.</p>
<pre>
h1 Energy Types


.panel.panel-default
    .panel-heading Iterate over All Energy Types
    .panel-body
        input(type="number", data-ng-model="index", min="0")
        br
        energy-types

// The remaining to panels are left as an exercise.
</pre>

<h2 id="msn-types">MSN Types</h2>
<p>A single energy type looks like this:</p>
<pre><code class="lang-json">{
    "<span class="hljs-attr">MSN</span>": <span class="hljs-string">"FFPRBUS"</span>,
    "<span class="hljs-attr">YYYYMM</span>": <span class="hljs-string">"194913"</span>,
    "<span class="hljs-attr">Value</span>": <span class="hljs-string">"28.748176"</span>,
    "<span class="hljs-attr">Column_Order</span>": <span class="hljs-string">"1"</span>,
    "<span class="hljs-attr">Description</span>": <span class="hljs-string">"Total Fossil Fuels Production"</span>,
    "<span class="hljs-attr">Unit</span>": <span class="hljs-string">"Quadrillion Btu"</span>
}
</code></pre>
<p>There are two oddities here:</p>
<ul>
<li>The MSN property. Here it is FFPREBUS, which we see in the Description stands for &quot;Fossile Fuel Produciton.&quot;</li>
<li>The YYYYMM property, which contains the year and a month: 1949 is the 13, is the month. I believe they are using 13 to say that they don&#39;t track months for this year, and that this is the production for the entire year. Starting around 1972 they will begin tracking production by month, and then the month field will be easier to understand.</li>
</ul>
<p>We want to know all the available MSN types. Just scanning through the file will reveal that there are several different types, such as FFPRBUS and NUETBUS. Since we have 7008 records, it is a bit hard to manually track down all the different types and their counts. So let&#39;s write code to do it, and also to break out our years and months.</p>
<p>It might be possible to use Angular filters to find our MSN types, but I would prefer to do it myself. This would be a fairly simple task if we only wanted to find the unique MSN types. But it is better to find both the type and the accompanying description. That can get a bit fussy, so I will just give you the code, which I put in <strong>public/javascripts/energy-types/msn-types.js</strong>:</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">var</span> elfApp = angular.module(<span class="hljs-string">'elfApp'</span>);

elfApp.factory(<span class="hljs-string">'msnTypes'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getMsnTypes</span>(<span class="hljs-params">energyTypes</span>) </span>{
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'getMsnTypes called'</span>);
        <span class="hljs-keyword">var</span> currentMsn = {msn: <span class="hljs-literal">null</span>, description: <span class="hljs-string">''</span>};
        <span class="hljs-keyword">var</span> msnTypes = [];

        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">insertNewCurrentMsn</span>(<span class="hljs-params">energyType</span>) </span>{
            currentMsn = <span class="hljs-built_in">Object</span>.create(currentMsn);
            currentMsn.msn = energyType.MSN;
            currentMsn.description = energyType.Description;
            msnTypes.push(currentMsn);
        }

        insertNewCurrentMsn(energyTypes[<span class="hljs-number">0</span>]);

        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isUnique</span>(<span class="hljs-params">msn</span>) </span>{
            <span class="hljs-keyword">var</span> result = <span class="hljs-literal">true</span>;
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; msnTypes.length; i++) {
                <span class="hljs-keyword">if</span> (msn === msnTypes[i].msn) {
                    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'msn vs c.msn'</span>, msn, currentMsn.msn);
                    result = <span class="hljs-literal">false</span>;
                    <span class="hljs-keyword">break</span>;
                }
            }
            <span class="hljs-keyword">return</span> result;
        }

        energyTypes.forEach(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">energyType, index</span>) </span>{
            <span class="hljs-comment">// console.log('energyType index and index length', index, msnTypes.length);</span>
            energyType.Year = energyType.YYYYMM.substr(<span class="hljs-number">0</span>, <span class="hljs-number">4</span>);
            energyType.Month = energyType.YYYYMM.substr(<span class="hljs-number">4</span>);
            <span class="hljs-keyword">if</span> (energyType.MSN !== currentMsn.msn) {
                <span class="hljs-keyword">if</span> (isUnique(energyType.MSN)) {
                    <span class="hljs-comment">//console.log('isUnique');</span>
                    insertNewCurrentMsn(energyType);
                }
            }
        });
        <span class="hljs-keyword">return</span> msnTypes;
    }

    <span class="hljs-keyword">return</span> getMsnTypes
});
</code></pre>
<p>We can use it like this:</p>
<pre><code class="lang-javascript">$scope.getEnergyTypes = <span class="hljs-keyword">function</span> () {
        $http.get(<span class="hljs-string">'data/EnergyTypes.json'</span>)
            .then(function (response) {                
                $scope.msnTypes = msnTypes(response.data);
                etc... // CODE HERE LEFT AS EXERCISE
              }, function errorCallback(response) {
          console.log(<span class="hljs-string">'Error:'</span>, response.status, response.statusText);
      });
};
</code></pre>
<h2 id="energy-selectors">Energy Selectors</h2>
<p>The goal of the Energy Selectors page is to allow the user to click on an MSN type and see only the records of that type. There are about 7008 objects in our array, and each MSN type encapsulates about 584 of those records.</p>
<p><img src="https://s3.amazonaws.com/bucket01.elvenware.com/images/prog219-midterm-2016-02.png" alt="MSN Selection"></p>
<p><strong>Figure 02</strong> Top portion of the page for selecting a subset of the msn types.</p>
<p><img src="https://s3.amazonaws.com/bucket01.elvenware.com/images/prog219-midterm-2016-03.png" alt="MSN Selection"></p>
<p><strong>Figure 03</strong> Bottom portion of the page for selecting a subset of the msn types.</p>
<h2 id="turn-it-in">Turn it in</h2>
<p>The usual</p>
<h2 id="hints">Hints</h2>
<p>Various Hints</p>
<h3 id="karma">Karma</h3>
<p>In karma.conf.js, make sure you are loading all your new files:</p>
<pre><code class="lang-javascript">'public/javascripts/<span class="hljs-keyword">*</span><span class="hljs-keyword">*</span>/<span class="hljs-keyword">*</span>.js',
</code></pre>
</div></body></html>