<!DOCTYPE html><html lang="en" dir="ltr"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width initial-scale=1.0"><title>ReactProps</title><link href="/css/first-style.css" rel="stylesheet"><link rel="shortcut icon" href="/images/favicon.png"><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/cerulean/bootstrap.min.css" rel="stylesheet"><link href="/css/highlight/googlecode.css" rel="stylesheet" type="text/css"><link href="/css/style.css" rel="stylesheet"><script src="https://code.jquery.com/jquery-1.12.0.min.js"></script><script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<!-- Latest compiled and minified CSS --><script src="/js/elven-help.js"></script></head><body><nav class="navbar navbar-inverse"><div class="container"><div class="navbar-header"><button type="button" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar" class="navbar-toggle collapsed"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><a href="/" class="navbar-brand">Elvenware</a></div><div id="navbar" class="navbar-collapse collapse">       <ul class="nav navbar-nav"><li ng-class="{ active: isActive('/')}" class="trigger-collapse"><a href="/">Home</a></li><li><a href="/about.html">About</a></li></ul></div></div></nav><div class="container"><figure><img alt="Elvenware" src="/images/elvenwarelogo.png" class="elf-normal"/></figure><h1>ReactProps</h1><p>Welcome to ReactProps</p><ul><!--TOC_Start--><li><a href="#react-props">React Props</a></li>
<li><a href="#git-no-components">No Components in Git Ignore</a></li>
<li><a href="#enospc">ENOSPC Error</a></li>
<li><a href="#props-single-node">Props Singe Node Error</a></li>
<li><a href="#tag">Tag</a></li>
<li><a href="#bower">Bower</a></li>
<li><a href="#new-branch">New Branch</a></li>
<li><a href="#images-and-css">Images and CSS</a></li>
<li><a href="#modularize">Modularize</a></li>
<li><a href="#props">Props</a></li>
<li><a href="#query-the-github-api">Query the GitHub API</a></li>
<li><a href="#proper-mocking">Proper Mocking</a></li>
<li><a href="#control-console">Control Console</a></li>
<li><a href="#refactor-tests">Refactor Tests</a></li>
<li><a href="#turn-it-in">Turn it in</a></li><!--TOC_End--></ul></div><div class="container"><a class="anchor" id="react-props"></a>
<h2>React Props</h2>
<p>We will learn a bit about React props by continuing to expand the <strong>week02-rest-basics</strong> program. We will try to understand properties, and to see how they can be passed from one component to another.</p>
<a class="anchor" id="git-no-components"></a>
<h2>No Components in Git Ignore</h2>
<p>Unless you are sure you mean to do it. make sure that <strong>components</strong> is not listed in your <strong>.gitignore</strong> files.</p>
<a class="anchor" id="enospc"></a>
<h2>ENOSPC Error</h2>
<p>Please look here:</p>
<ul>
<li><a href="http://www.elvenware.com/charlie/development/web/JavaScript/JavaScriptReact.html#enospc">Elvenware React</a></li>
</ul>
<a class="anchor" id="props-single-node"></a>
<h2>Props Singe Node Error</h2>
<p>Please go here:</p>
<ul>
<li><a href="http://www.elvenware.com/charlie/development/web/JavaScript/JavaScriptReact.html#props-single-node">Elvenware React</a></li>
</ul>
<a class="anchor" id="tag"></a>
<h2>Tag</h2>
<p>Since we are often working on a single project that has multiple phases, I suggest creating a git tag marking your current status:</p>
<pre><code class="lang-bash">$ git <span class="hljs-keyword">tag</span> <span class="hljs-title">-a</span> v3.<span class="hljs-number">0.0</span> -m <span class="hljs-string">"Start Week03"</span>
$ git push origin v3.<span class="hljs-number">0.0</span>
$ git <span class="hljs-keyword">tag</span> <span class="hljs-title">-n1</span>
</code></pre>
<p>The first command creates a tag that has a message associated with it. The message works much like the message in a commit.</p>
<p>The second command pushes the tag from your local machine to the cloud.</p>
<p>The last command lists your tags and their message on one line. If you have only a single tag, it is not particularly useful, but once you have multiple tags you will see how helpful this can be. Increase the value of the number after -n? to see more information about your tag. You can read about tags here:</p>
<ul>
<li><a href="https://git-scm.com/book/en/v2/Git-Basics-Tagging">git tag docs</a></li>
</ul>
<a class="anchor" id="bower"></a>
<h2>Bower</h2>
<p>Modify the hidden file <strong>.bowerrc</strong> to reference <strong>public/bower-components</strong>.</p>
<p>Add <strong>bower-components</strong> to <strong>.gitignore</strong>:</p>
<pre><code><span class="hljs-comment"># Dependency directories</span>
node_modules
<span class="hljs-keyword">jspm_packages
</span><span class="hljs-keyword">bower-components</span>
</code></pre><p>Once again, be sure that you remove <strong>components</strong> from <strong>.gitignore</strong></p>
<p>Here is <strong>server/views/layout.jade</strong> after this change with <strong>bower-components</strong> instead of <strong>components</strong>:</p>
<pre><code class="lang-javascript">doctype <span class="hljs-selector-tag">html</span>
<span class="hljs-selector-tag">html</span>
  head
    title= title
    link(rel=<span class="hljs-string">'stylesheet'</span>, href=<span class="hljs-string">'/stylesheets/style.css'</span>)
    link(rel=<span class="hljs-string">'stylesheet'</span>, href=<span class="hljs-string">'/bower-components/bootstrap/dist/css/bootstrap.css'</span>)
    <span class="hljs-comment">// CODE YOU NEED TO MODIFY OMITTED HERE</span>
  <span class="hljs-selector-tag">body</span>
    block <span class="hljs-attribute">content</span>
</code></pre>
<a class="anchor" id="new-branch"></a>
<h2>New Branch</h2>
<p>Create a new branch called <strong>Week03</strong>. You <strong>must</strong> put your homework for week three in this branch! (You can do it!)</p>
<pre><code class="lang-bash"><span class="hljs-symbol">git</span> <span class="hljs-keyword">branch </span>Week03
<span class="hljs-symbol">git</span> checkout Week03
</code></pre>
<p>Write some code, commit your work. Push it:</p>
<pre><code class="lang-bash">git <span class="hljs-keyword">push</span> --<span class="hljs-keyword">set</span>-upstream origin Week03
</code></pre>
<a class="anchor" id="images-and-css"></a>
<h2>Images and CSS</h2>
<p>I found images here:</p>
<ul>
<li><a href="https://pixabay.com/en/gold-fish-aquarium-goldfish-fins-30831/">https://pixabay.com/en/gold-fish-aquarium-goldfish-fins-30831/</a></li>
<li><a href="https://pixabay.com/en/goldfish-fins-tropical-animal-47022/">https://pixabay.com/en/goldfish-fins-tropical-animal-47022/</a></li>
<li><a href="https://commons.wikimedia.org/wiki/File:Small_SVG_house_icon.svg">https://commons.wikimedia.org/wiki/File:Small_SVG_house_icon.svg</a></li>
<li><a href="https://commons.wikimedia.org/wiki/File:Flower-of-Life-91circles36arcs.svg">https://commons.wikimedia.org/wiki/File:Flower-of-Life-91circles36arcs.svg</a></li>
<li><a href="https://commons.wikimedia.org/wiki/File:Tree-of-Life_Flower-of-Life_Stage.svg">https://commons.wikimedia.org/wiki/File:Tree-of-Life_Flower-of-Life_Stage.svg</a>
-
Try also, this search in Chrome/Chromium:</li>
</ul>
<pre><code>http<span class="hljs-variable">s:</span>//www.google.<span class="hljs-keyword">com</span>/<span class="hljs-built_in">search</span>?q=svg+free+small
</code></pre><p>In Google, turn to the images page. Select tools, and select <strong>Labeled for non-commercial reuse</strong> or something similar.</p>
<p>Also, let&#39;s put our images and CSS in their own folders:</p>
<ul>
<li><strong>src/css</strong></li>
<li><strong>src/images</strong></li>
</ul>
<p>You will need to make some changes to your code after doing this. In fact, you may have to play with these paths several times over the course of this assignment.</p>
<a class="anchor" id="modularize"></a>
<h2>Modularize</h2>
<p>The key goal will be to move <strong>App.js</strong> to <strong>components/App.js</strong>. Then break <strong>App.js</strong> into discrete components such as <strong>components/Header.js</strong>, <strong>components/GetFoo.js</strong> and <strong>components/SmallNumbers.js</strong>.</p>
<p>The simplest way to proceed, I believe, is to copy <strong>App.js</strong> into <strong>SmallNumbers.js</strong>. Now delete everything from <strong>SmallNumbers</strong> that is not related to numbers. Go back to <strong>App.js</strong> and delete everything related to numbers from that file.</p>
<a class="anchor" id="props"></a>
<h2>Props</h2>
<p>In <strong>index.js</strong> pass in some default numbers to <strong>components/smallNumbers.js</strong>:</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">var</span> numbersInit = {
    <span class="hljs-attr">nine</span>: <span class="hljs-string">'0'</span>,
    <span class="hljs-attr">eight</span>: <span class="hljs-string">'0'</span>
};

ReactDOM.render(
  <span class="hljs-comment">// CODE OMITTED HERE</span>

     &lt;SmallNumbers numbers={numbersInit} /&gt;
  <span class="xml"><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>,
  <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'root'</span>)
);
</code></pre>
<p>And then use it in <strong>SmallNumbers.js</strong>:</p>
<pre><code class="lang-javascript"><span class="hljs-function"><span class="hljs-keyword">constructor</span><span class="hljs-params">(props)</span> <span class="hljs-comment">{
    super(props);
    this.state = {
        nine: props.numbers.nine,
        eight: props.numbers.eight
    }</span>
}</span>
</code></pre>
<a class="anchor" id="query-the-github-api"></a>
<h2>Query the GitHub API</h2>
<p>Install request: <strong>npm install --save request</strong></p>
<p>In <strong>server/routes/api.js</strong> add this method. If you have GitHub account, use yours, not mine:</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">var</span> request = <span class="hljs-keyword">require</span>(<span class="hljs-string">'request'</span>);

<span class="hljs-comment">// EXISTING CODE OMITTED HERE</span>
router.get(<span class="hljs-string">'/user'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(req, res, next)</span> </span>{
    <span class="hljs-keyword">var</span> options = {
        url: <span class="hljs-string">'https://api.github.com/users/charliecalvert'</span>,
        headers: {
            <span class="hljs-string">'User-Agent'</span>: <span class="hljs-string">'request'</span>
        }
    };

    request(options, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(error, response, body)</span> </span>{
        <span class="hljs-comment">// Print the error if one occurred</span>
        console.log(<span class="hljs-string">'error:'</span>, error);
        <span class="hljs-comment">// Print the response status code if a response was received</span>
        console.log(<span class="hljs-string">'statusCode:'</span>, response &amp;&amp; response.statusCode);
        <span class="hljs-comment">// Print the HTML for the Google homepage.</span>
        console.log(<span class="hljs-string">'body:'</span>, body);
        res.send({error: error, response: response, body: body});
    });

});

<span class="hljs-comment">## Tests</span>

<span class="hljs-keyword">As</span> you refactor your components, your tests might need to change. <span class="hljs-keyword">For</span> instance, <span class="hljs-keyword">if</span> you move the H1 <span class="hljs-keyword">for</span> your app into **components/Header.js**, you might need to change your tests. Consider this code:

```javascript
import App from <span class="hljs-string">'./App'</span>;

<span class="hljs-comment">// Code omitted here</span>

it.only(<span class="hljs-string">'renders and reads H1 text'</span>, () =&gt; {
    <span class="hljs-keyword">const</span> wrapper = shallow(&lt;App /&gt;);
    <span class="hljs-keyword">const</span> welcome = &lt;h2&gt;Welcome to React&lt;/h2&gt;;
    expect(wrapper.contains(welcome)).toEqual(<span class="hljs-keyword">true</span>);
});
</code></pre>
<p>It will likely end up like this:</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">import</span> Header <span class="hljs-keyword">from</span> <span class="hljs-string">'./components/Header'</span>;

<span class="hljs-comment">// Code omitted here</span>

it.only(<span class="hljs-string">'renders and reads H1 text'</span>, () =&gt; {
    <span class="hljs-keyword">const</span> wrapper = shallow(<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Header</span> /&gt;</span>);
    const welcome = <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>Welcome to React<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>;
    expect(wrapper.contains(welcome)).toEqual(true);
});</span>
</code></pre>
<a class="anchor" id="proper-mocking"></a>
<h2>Proper Mocking</h2>
<p>I made some progress on mocking our <strong>whatwg-fetch</strong>  calls with jest. Recall that our goal is to create a mock implementation of fetch that does not make an HTTP REST call over the network. This allows us to run our tests even if our server is not, or cannot, run.</p>
<p>This new implementation allows us to use <strong><em>exactly</em></strong> the same code in <strong>App.js</strong> when we are testing and when we are running our app normally. In particular, here are the imports in <strong>App.js</strong>, or wherever we are calling <strong>fetch</strong>:</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">import</span> React, { Component } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-string">'./App.css'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-string">'whatwg-fetch'</span>;
</code></pre>
<p>And here is our call to <strong>fetch</strong>:</p>
<pre><code class="lang-javascript">fetch(<span class="hljs-string">'/api/foo'</span>)
    .<span class="hljs-keyword">then</span>(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(response)</span> {</span>
        console.<span class="hljs-built_in">log</span>(<span class="hljs-string">'GETONE-FETCH-ONE'</span>);
        <span class="hljs-keyword">return</span> response.json();
    }).<span class="hljs-keyword">then</span>(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(json)</span> {</span>
        console.<span class="hljs-built_in">log</span>(<span class="hljs-string">'GETONE-FETCH-TWO'</span>);
        console.<span class="hljs-built_in">log</span>(<span class="hljs-string">'parsed json'</span>, json);
        that.setState(foo =&gt; (json));
    }).<span class="hljs-keyword">catch</span>(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(ex)</span> {</span>
        console.<span class="hljs-built_in">log</span>(<span class="hljs-string">'parsing failed'</span>, ex);
    });
</code></pre>
<p>As you can see, this code is back to our initial syntax. In particular, we are no longer passing this as the first parameter:</p>
<pre><code class="lang-javascript">fetch(<span class="hljs-keyword">this</span>, <span class="hljs-string">'/api/user'</span>) &lt;===== WE NO LONGER NEED <span class="hljs-keyword">this</span>. COMPARE TO CODE ABOVE.
fetch(<span class="hljs-string">'/api/user'</span>) &lt;===== THIS IS HOW IT SHOULD LOOK NOW.
</code></pre>
<p>So how do we perform this miracle? To make a long story short: we use the mock library built into Jest. Here is how to proceed:</p>
<ul>
<li>Create a new folder in the root of your project called: <strong><strong>mocks</strong></strong><ul>
<li>Two underscores, the word mocks, two more underscores</li>
</ul>
</li>
<li>Create a file in that directory called <strong>whatwg-fetch.js</strong></li>
</ul>
<p>First lets create a simple module that contains the data we will use in our mock:</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">const</span> getData = <span class="hljs-function">(<span class="hljs-params">url</span>) =&gt;</span> {
    <span class="hljs-keyword">switch</span> (url) {
        <span class="hljs-keyword">case</span> <span class="hljs-string">'/api/foo'</span>:
            <span class="hljs-keyword">return</span> {
                <span class="hljs-attr">foo</span>: <span class="hljs-string">'bar'</span>,
                <span class="hljs-attr">file</span>: <span class="hljs-string">'api.js'</span>
            };

        <span class="hljs-keyword">case</span> <span class="hljs-string">'/api/user'</span>:
            <span class="hljs-keyword">return</span> {
                <span class="hljs-attr">error</span>: {},
                <span class="hljs-attr">response</span>: {},
                <span class="hljs-attr">body</span>: <span class="hljs-built_in">JSON</span>.stringify({
                    <span class="hljs-attr">login</span>: <span class="hljs-string">'Robin Dudette'</span>
                })
            };

        <span class="hljs-keyword">default</span>:
            <span class="hljs-keyword">return</span> {}
    }
};

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> getData;
</code></pre>
<p>This code simply creates sets of data that mimic what our server would return given a call to a specific <strong>url</strong>.</p>
<p>Below is the source code for our new mock for <strong>fetch</strong>. Note in particular the call to <a href="https://facebook.github.io/jest/docs/jest-object.html#jestgenmockfrommodulemodulename">jest.genMockFromModule</a>. That call asks Jest to generate a mock object for the module we want to replace with a mock:</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">import</span> getData <span class="hljs-keyword">from</span> <span class="hljs-string">'./mock-data'</span>;

<span class="hljs-meta">'use strict'</span>;

<span class="hljs-keyword">const</span> whatwgFetch = jest.genMockFromModule(<span class="hljs-string">'whatwg-fetch'</span>);

<span class="hljs-keyword">var</span> fetch = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">url</span>) </span>{

    <span class="hljs-keyword">var</span> objectState = getData(url);

    <span class="hljs-keyword">var</span> response = {};
    response.json = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> objectState;
    };

    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"FETCH STATER"</span>, objectState);
    <span class="hljs-keyword">return</span> {
        <span class="hljs-attr">then</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">func</span>) </span>{
            <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'FETCH TEST ONE'</span>, func(response));
            <span class="hljs-keyword">return</span> {
                <span class="hljs-attr">then</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">func</span>) </span>{
                    <span class="hljs-comment">//func(JSON.stringify(stater));</span>
                    func(objectState);
                    <span class="hljs-keyword">return</span> {
                        <span class="hljs-attr">catch</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{

                        }
                    }
                }
            }
        }
    }
};

whatwgFetch.fetch = fetch;
<span class="hljs-built_in">window</span>.fetch = fetch;

<span class="hljs-built_in">module</span>.exports = whatwgFetch;
</code></pre>
<p>Over time, you can comment out the calls to <strong>console.log</strong>. But they might be helpful at first when you are trying to understand what is going on. Note in particular that we are now putting calls to the callbacks (func) passed into our labyrinthine series of <strong>return</strong> statements. The most important is the second call to <strong>then</strong> where we pass back the <strong>stater</strong> object. Recall that this is used as follows in our call to <strong>fetch</strong>:</p>
<pre><code class="lang-javascript">.then(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">json</span>) </span>{
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'GETONE-FETCH-TWO'</span>);
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'parsed json'</span>, json);
    that.setState(<span class="hljs-function"><span class="hljs-params">foo</span> =&gt;</span> (json));
})
</code></pre>
<a class="anchor" id="control-console"></a>
<h2>Control Console</h2>
<p>Here are Three steps to a poor man&#39;s logger:</p>
<ul>
<li>Declare a boolean in your constructor on your object called <strong>quiet</strong>.</li>
<li>Create a method on your object called <strong>debug</strong></li>
<li>Use <strong>debug</strong> instead of console.log</li>
</ul>
<p>Perhaps a bit like this:</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">constructor</span>() {
    <span class="hljs-keyword">super</span>();
    <span class="hljs-keyword">this</span>.state = {
        <span class="hljs-attr">file</span>: <span class="hljs-string">'File Result will be placed here.'</span>,
        <span class="hljs-attr">foo</span>: <span class="hljs-string">'waiting for express server'</span>
    };

    <span class="hljs-comment">// SET quiet TO false TO SEE DEBUG MESSAGES    </span>
    <span class="hljs-keyword">this</span>.quiet = <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">this</span>.debug(<span class="hljs-string">'GetFoo constructor called'</span>);
}

debug = <span class="hljs-function">(<span class="hljs-params">message</span>) =&gt;</span> {
    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.quiet) {
        <span class="hljs-built_in">console</span>.log(message);
    }
};

getFoo = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">const</span> that = <span class="hljs-keyword">this</span>;
    fetch(<span class="hljs-string">'/api/foo'</span>)
        .then(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">response</span>) </span>{
            that.debug(<span class="hljs-string">'GETONE-FETCH-ONE'</span>);
            <span class="hljs-keyword">return</span> response.json();
        }).then(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">json</span>) </span>{
            that.debug(<span class="hljs-string">'GETONE-FETCH-TWO'</span>);
            that.debug(<span class="hljs-string">'parsed json'</span>, json);
            that.setState(<span class="hljs-function"><span class="hljs-params">foo</span> =&gt;</span> (json));
        }).catch(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">ex</span>) </span>{
            <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'parsing failed'</span>, ex);
        });
};
</code></pre>
<a class="anchor" id="refactor-tests"></a>
<h2>Refactor Tests</h2>
<p>Refactor your tests into:</p>
<ul>
<li>App.test.js</li>
<li>GetFoo.test.js</li>
<li>Header.test.js</li>
<li>SmallNumbers.test.js</li>
</ul>
<p>Move tests into their own folder?</p>
<a class="anchor" id="turn-it-in"></a>
<h2>Turn it in</h2>
<p>Commit push, designate directory in your repo where you did your work when you turn in the assignment.</p>
</div></body></html>