<!DOCTYPE html><html lang="en" dir="ltr"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width initial-scale=1.0"><title>ReactReduxGitApi</title><link href="/css/first-style.css" rel="stylesheet"><link rel="shortcut icon" href="/images/favicon.png"><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet"><link href="/css/highlight/googlecode.css" rel="stylesheet" type="text/css"><link href="/css/style.css" rel="stylesheet"><script src="https://code.jquery.com/jquery-1.12.0.min.js"></script><script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<!-- Latest compiled and minified CSS --><script src="/js/elven-help.js"></script></head><body><nav class="navbar navbar-inverse"><div class="container"><div class="navbar-header"><button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><a class="navbar-brand" href="/">Elvenware</a></div><div class="navbar-collapse collapse" id="navbar"><ul class="nav navbar-nav"><li class="trigger-collapse" ng-class="{ active: isActive('/')}"><a href="/">Home</a></li><li><a href="/about.html">About</a></li></ul></div></div></nav><div class="container"><figure><img class="elf-normal" alt="Elvenware" src="/images/elvenwarelogo.png"/></figure><h1>ReactReduxGitApi</h1><p>Welcome to ReactReduxGitApi</p><ul><!--TOC_Start--><li><a href="#react-redux-git-api">React Redux Git API</a></li>
<li><a href="#reducer">Reducer</a></li>
<li><a href="#small-numbers">Small Numbers</a></li>
<li><a href="#small-numbers-implementation">Small Numbers Implementation</a></li>
<li><a href="#getfoo">GetFoo</a></li>
<li><a href="#turn-it-in">Turn it in</a></li><!--TOC_End--></ul></div><div class="container"><a class="anchor" id="react-redux-git-api"></a>
<h1>React Redux Git API</h1>
<p>We now want to apply Redux to GitExplorer.</p>
<a class="anchor" id="reducer"></a>
<h2>Reducer</h2>
<p>Let&#39;s start at the beginning. Create a file called <strong>assets/gist-reducer.js</strong>:</p>
<pre>const gistState = {

};

const gistReducer = (state = gistState, action) => {
    switch (action.type) {
        default:
            return state;
    }
};

export default gistReducer;
</pre>
<p>Now set up <strong>index.js</strong>:</p>
<pre>import {Provider} from 'react-redux';
import {createStore} from 'redux';
import gistReducer from './assets/gist-reducer';

let store = createStore(gistReducer);

ReactDOM.render(
    <div>
        <Provider store={store}>
            <Router>
                <DataMaven/>
            </Router>
        </Provider>
    </div>,
    document.getElementById('root')
);
</pre>
<a class="anchor" id="small-numbers"></a>
<h2>Small Numbers</h2>
<p>In <strong>SmallNumbers</strong>, strip out the state from the constructor or stop passing in props from <strong>DataMaven</strong>:</p>
<p>Here is how to call <strong>SmallNumbers</strong>:</p>
<pre><Route path='/get-numbers' component={SmallNumbers} />
</pre>
<p>Here is the constructor:</p>
<pre>constructor(props) {
    super(props);
    logger.log('SmallNumber props', this.props);
    this.getNine = this.getNine.bind(this);
    this.getEight = this.getEight.bind(this);
}
</pre>
<p>Now, lets move the state to the reducer:</p>
<pre>const gistState = {
  numbers: {
      nine: '0',
      eight: '0'
  }
};

const gistReducer = (state = gistState, action) => {
    switch (action.type) {
      case 'NUMBER_NINE':
        return Object.assign({}, state, {
            numbers: {
                nine: 9,
                eight: state.numbers.eight
            }
        });

      case 'NUMBER_EIGHT':
        return Object.assign({}, state, {
            numbers: {
                nine: state.numbers.nine,
                eight: 8
            }
        });

      default:
        return state;
    }
};

export default gistReducer;
</pre>
<p>We use <strong>Object.assign</strong> because we want our objects to be immutable. You may not change your state object, you must completely rebuild it. You must copy the old state into a new state and in the process add new values to the changed properties. That is what <strong>Object.assign</strong> does.</p>
<p>Alternatively:</p>
<pre>case 'NUMBER_EIGHT':
  return {
    numbers: {
      eight: '8',
      nine: state.numbers.nine
    }
  };
</pre>
<p>But that can get unwieldy if our <strong>state</strong> becomes complex.</p>
<a class="anchor" id="small-numbers-implementation"></a>
<h2>Small Numbers Implementation</h2>
<p>Then do this to connect <strong>SmallNumbers</strong> to Redux:</p>
<pre>import {connect} from 'react-redux';

// SMALL NUMBERS ITSELF HERE.
// AND AT THE BOTTOM:

const mapStateToProps = (state) => {
    return {
        numbers: state.numbers
    };
};

SmallNumbers = connect(mapStateToProps)(SmallNumbers);
</pre>
<p>There is no real need for <strong>mapDispatchToProps</strong> because our dispatch calls are so simple:</p>
<pre>getNine() {
  this.props.dispatch({type: 'NUMBER_NINE'});
};
</pre>
<a class="anchor" id="getfoo"></a>
<h2>GetFoo</h2>
<p>Get Foo is bit more complex, but still a very similar process:</p>
<p>In the reducer:</p>
<pre>const gistState = {
    getFoo: {
        foo: 'foo',
        file: 'api.js'
    },
    numbers: {
        nine: '0',
        eight: '0'
    }
};

const gistReducer = (state = gistState, action) => {
  switch (action.type) {
      case 'GETFOO':
          return Object.assign({}, state, {getFoo: action.getFoo});
      etc
  }      
}
</pre>
<p>And here is the connect object in <strong>GetFooConnect</strong>:</p>
<pre>/**
 * Created by charlie on 6/3/17.
 */

import 'whatwg-fetch';
import {connect} from 'react-redux';
import GetFoo from './GetFoo';
import ElfLogger from '../assets/ElfLogger';
const logger = new ElfLogger('get-foo-connect');

const mapStateToProps = (state) => {
    return {
        foo: state.getFoo.foo,
        file: state.getFoo.file
    };
};

const mapDispatchToProps = (dispatch) => {
    return {
        getBar: () => {
            dispatch({
                type: 'GETFOO',
                getFoo: {
                    foo: 'url-mock-bar',
                    file: 'url-mock-api.js'
                }
            });
        },
        getFoo: () => {
            fetch('/foo')
                .then(function(response) {
                      return response.json();
                }).then(function(json) {
                  dispatch({
                    type: 'GETFOO',
                    getFoo: json
                });
            }).catch(function(ex) {
                console.log('parsing failed', ex);
            });

        }
    };
};

const GetFooConnect = connect(mapStateToProps, mapDispatchToProps)(GetFoo);

export default GetFooConnect;
</pre>
<a class="anchor" id="turn-it-in"></a>
<h2>Turn it in</h2>
<p>add, commit, push, branch and/or tag. Tell me the branch, tag and folder. I&#39;m expecting it to be done in the folder called <strong>GitExplorer</strong>.</p>
</div></body></html>