<!DOCTYPE html><html lang="en" dir="ltr"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width initial-scale=1.0"><title>RestBasics</title><link href="/css/first-style.css" rel="stylesheet"><link rel="shortcut icon" href="/images/favicon.png"><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/cerulean/bootstrap.min.css" rel="stylesheet"><link href="/css/highlight/googlecode.css" rel="stylesheet" type="text/css"><link href="/css/style.css" rel="stylesheet"><script src="https://code.jquery.com/jquery-1.12.0.min.js"></script><script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<!-- Latest compiled and minified CSS --><script src="/js/elven-help.js"></script></head><body><nav class="navbar navbar-inverse"><div class="container"><div class="navbar-header"><button type="button" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar" class="navbar-toggle collapsed"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><a href="/" class="navbar-brand">Elvenware</a></div><div id="navbar" class="navbar-collapse collapse">       <ul class="nav navbar-nav"><li ng-class="{ active: isActive('/')}" class="trigger-collapse"><a href="/">Home</a></li><li><a href="/about.html">About</a></li></ul></div></div></nav><div class="container"><figure><img alt="Elvenware" src="/images/elvenwarelogo.png" class="elf-normal"/></figure><h1>RestBasics</h1><p>Welcome to RestBasics</p><ul><!--TOC_Start--><li><a href="#overview">Overview</a></li>
<li><a href="#get-started">Get Started</a></li>
<li><a href="#create-server">Create Server</a></li>
<li><a href="#create-client">Create Client</a></li>
<li><a href="#turn-it-in">Turn it in</a></li><!--TOC_End--></ul></div><div class="container"><a class="anchor" id="overview"></a>
<h2>Overview</h2>
<p>Use Rest with React.</p>
<a class="anchor" id="get-started"></a>
<h2>Get Started</h2>
<p>Create a directory called week02-rest-basics in your Repository.</p>
<p><strong>NOTE</strong>: <em>Let&#39;s try switching to all small letters for now, since npm is getting fussy about this issue.</em></p>
<a class="anchor" id="create-server"></a>
<h2>Create Server</h2>
<p>CreateAllExpress server</p>
<p>Let&#39;s put our server api in its own file. In <strong>routes</strong> folder create <strong>api.js</strong>:</p>
<pre>var express = require('express');
var router = express.Router();

/* GET home page. */
router.get('/foo', function(request, response, next) {
    var message = { 'result': 'success', 'foo': 'bar', 'file': 'api.js' };
    console.log('Foo called on server with message:', message);
    response.send(message);
});

module.exports = router;
</pre>
<p>Now we need to link in this new file. You know how to do this, but just to remind in: in app.js around lines 10 and 28:</p>
<pre>var api = require('./routes/api');
app.use('/api', api);
</pre>
<p>Set the port, in <strong>bin/www</strong>, to <strong>30026</strong>.
If you want, go ahead and start it:</p>
<pre>npm start
</pre>
<a class="anchor" id="create-client"></a>
<h2>Create Client</h2>
<p>You&#39;ll need to create a new bash tab, since the one we were using is now busy: CTRL-SHIFT-T. While still in <strong>week02-rest-basics</strong>, create your client:</p>
<pre>create-react-app client
cd client
npm run eject
</pre>
<p>The last command, which we probably won&#39;t use very often, creates a <strong>scripts</strong> directory and modifies <strong>package.json</strong>. Look at <strong>package.json</strong> to see the relationship between the two.</p>
<p><strong>NOTE</strong>: <em>Don&#39;t forget to set the <strong>Settings | Languages and Frameworks | JavaScript</strong> to <strong>React JSX</strong> Also, copy in <strong>.jscsrc</strong> from the <strong>server</strong> project.</em></p>
<p>In <strong>package.json</strong>, just before the dependencies section, add this:</p>
<pre>"proxy": "http://localhost:30026",
</pre>
<p>This tells our react app to forward requests for REST calls to our Express Server running on port 30026. See code in <strong>scripts/start.js</strong> for more details.</p>
<p>Install <strong>fetch</strong>, which we will use in lieu of <strong>$.ajax</strong> or <strong>$.getJSON</strong>. The <strong>fetch</strong> call is part of the ES6 standard, though it is not finalized anywhere yet, as far as I know.</p>
<pre>npm install --save whatwg-fetch
</pre>
<p>I believe you also need to add it to <strong>config/webpack.config.dev.js</strong> in the <strong>entry</strong> property:</p>
<pre>entry: [
    'whatwg-fetch',
    ... and so on
]
</pre>
<p>And here is <strong>app.js</strong>:</p>
<pre>import React, {Component} from 'react';
import logo from './logo.svg';
import './App.css';
import 'whatwg-fetch';

class App extends Component {
    constructor() {
        super();
        this.state = {
            file: 'Get Nine Result will be placed here.',
            foo: 'waiting for server'
        };
    }

    bar = () => {
        const that = this;
        fetch('/api/foo')
            .then(function(response) {
                return response.json();
            }).then(function(json) {
                console.log('parsed json', json);
                that.setState(foo => (json));
            }).catch(function(ex) {
                console.log('parsing failed', ex);
            });
    };

    render() {
        return (
            <div className="App">
                <div className="App-header">
                    <img src={logo} className="App-logo" alt="logo"/>
                    <h2>Welcome to React</h2>
                </div>

                <p className="App-intro">
                    state: {this.state.foo} file: {this.state.file}
                </p>
                <button onClick={this.bar}>Bar</button>
            </div>
        );
    }
}

export default App;
</pre>
<a class="anchor" id="turn-it-in"></a>
<h2>Turn it in</h2>
<p>Push, submit.</p>
</div></body></html>