<!DOCTYPE html><html lang="en" dir="ltr"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width initial-scale=1.0"><title>ReactGetAddress</title><link href="/css/first-style.css" rel="stylesheet"><link rel="shortcut icon" href="/images/favicon.png"><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet"><link href="/css/highlight/googlecode.css" rel="stylesheet" type="text/css"><link href="/css/style.css" rel="stylesheet"><script src="https://code.jquery.com/jquery-1.12.0.min.js"></script><script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<!-- Latest compiled and minified CSS --><script src="/js/elven-help.js"></script></head><body><nav class="navbar navbar-inverse"><div class="container"><div class="navbar-header"><button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><a class="navbar-brand" href="/">Elvenware</a></div><div class="navbar-collapse collapse" id="navbar"><ul class="nav navbar-nav"><li class="trigger-collapse" ng-class="{ active: isActive('/')}"><a href="/">Home</a></li><li><a href="/about.html">About</a></li></ul></div></div></nav><div class="container"><figure><img class="elf-normal" alt="Elvenware" src="/images/elvenwarelogo.png"/></figure><h1>ReactGetAddress</h1><p>Welcome to ReactGetAddress</p><ul><!--TOC_Start--><li><a href="#react-get-address">React Get Address</a></li>
<li><a href="#get-the-addresses">Get the Addresses</a></li>
<li><a href="#install-debug">Install Debug</a></li>
<li><a href="#write-utility">Write Utility</a></li>
<li><a href="#turn-it-in">Turn it in</a></li>
<li><a href="#hint-tagging">Hint Tagging</a></li>
<li><a href="#pad-number">Pad Number</a></li><!--TOC_End--></ul></div><div class="container"><a class="anchor" id="react-get-address"></a>
<h1>React Get Address</h1>
<p>We should:</p>
<ul>
<li>Download a set of adddress from the website govtrack.us. The address are in JSON format.</li>
<li>Create a program that generates about 100 addresses based on the JSON you downloaded.</li>
<li>Discover how to use the addresses in <strong>CongressAddress</strong>. In particular, use these addresses to update <strong>address-list.js</strong> and/or <strong>address-list.json</strong>.</li>
<li>Turn in the program, with code that shows your ability to use the addresses in <strong>CongressAddress</strong>.</li>
</ul>
<p>Do your work in a folder in the root of your project call <strong>GetAddress</strong>.</p>
<a class="anchor" id="get-the-addresses"></a>
<h2>Get the Addresses</h2>
<pre>curl https://www.govtrack.us/api/v2/role?current=true > govtrack-address.json
</pre>
<p>Study <strong>govtrack-address.json</strong> until it makes sense.</p>
<a class="anchor" id="install-debug"></a>
<h2>Install Debug</h2>
<p>If you have not done so already, enter the following code to install the frequently used <strong>debug</strong> package:</p>
<p>  npm install --save debug</p>
<p>Read about it here:</p>
<ul>
<li><a href="https://www.npmjs.com/package/debug">debug on npm</a>  </li>
</ul>
<p>If you get this error: <strong>Error: Cannot find module &#39;debug&#39;</strong> then that probably means you skipped this step and install <strong>debug</strong> with npm as shown above.</p>
<a class="anchor" id="write-utility"></a>
<h2>Write Utility</h2>
<p>Then in get-address.js:</p>
<pre>var fs=require("fs");
var debug = require('debug')('get-address');

debug('Testing debug');

function readFile(fileName, callback) {
    'use strict';
    if (!callback) {
        return new Promise(function(resolve, reject) {
            fs.readFile(fileName, 'utf8', function(err, fileContents) {
                if (err) {
                    reject(err);
                }
                resolve({
                    'result': fileContents
                });
            });
        });
    } else {
        fs.readFile(fileName, 'utf8', function(err, fileContents) {
            if (err) {
                throw (err);
            }
            callback({
                'result': fileContents
            });
        });
    }
}

function getAddress(value, char) {
    'use strict';
    return value.substring(0, value.lastIndexOf(char) -1);
}

function getZip(value, char) {
    'use strict';
    // YOU WRITE IT
    // ITS THE SAME SINGLE CALL AS GET ADDRESS, BUT INDEXES ARE DIFFERENT
    // UNCOMMENT NEXT LINE AND MODIFY IT
    // return value.substring(WHAT GOES HERE?, WHAT GOES HERE?);
}

function getCity(value, char, len) {
    'use strict';
    var start = value.lastIndexOf(char);
    return value.substring(start, start + len);
}

function writeIt(label, value, noComma) {
    var comma = noComma ? '"' : '",';
    console.log('\t\t' + '"' + label + '": ' + '"' + value + comma);
};

readFile('govtrack-address.json').then(function(objectReturned) {
    debug('Please notice that we don\'t get a string back but an: ', typeof objectReturned);
    debug('The object has a property:', Object.keys(objectReturned));
    debug('The type of the property is:', typeof objectReturned.result);

    var json = JSON.parse(objectReturned.result);
    debug('We were able to parse the JSON.');
    debug('Total records returned:', json.meta.limit);
    debug('First person found', JSON.stringify(json.objects[0].person.name));

    for (var i = 0; i < json.objects.length; i++) {
        console.log('{');
        writeIt('firstName:', json.objects[i].person.firstname);
        // GET LAST NAME
        writeIt('street:', getAddress(json.objects[i].extra.address, 'W'));
        // CITY STATE ZIP PHONE WEBSITE
        writeIt('email:', '');
        writeIt('contact:', json.objects[i].extra.contact_form || '', true);
        console.log('},');
    }
    //console.log('\n\nSTRINGIFY\n\n', JSON.stringify(gitUser, null, 4));
    debug('all done');
}).catch(function(e) {
    console.log(e);
});
</pre>
<p>Note that you won&#39;t see the debug unless you first execute this line at the bash prompt:</p>
<p>  export DEBUG=&#39;get-address&#39;</p>
<p>Then you can run the program:</p>
<p>  node get-address</p>
<p>At the start of the main method I point out that we get an object rather than a string back. That is as expected, but you need to be aware of that fact. In the debug statement I&#39;m trying to draw your attention to this issue.</p>
<p>The line that says &quot;We were able to parse the JSON&quot; is valid because <strong>JSON.parse</strong> would blow up if it failed, causing the catch block at the end of code to be triggered. In other words, if we could not parse the JSON, then this line would never be reached:</p>
<pre>debug('We were able to parse the JSON.');
</pre>
<p>If we did get that far, then the odds are that we could parse the JSON.</p>
<p>Some example output:</p>
<pre>{
    firstName: "Lamar",
    lastName: "Alexander",
    street: "455 Dirksen Senate Office Building",
    city: "Washington DC",
    state: "TN",
    zip: " 20510",
    phone: "202-224-4944",
    website: "https://www.alexander.senate.gov/public",
    email: "",
    contact: "http://www.alexander.senate.gov/public/index.cfm?p=Email"
},
{
    firstName: "Roger",
    lastName: "Wicker",
    street: "555 Dirksen Senate Office Building",
    city: "Washington DC",
    state: "MS",
    zip: " 20510",
    phone: "202-224-6253",
    website: "https://www.wicker.senate.gov",
    email: "",
    contact: "https://www.wicker.senate.gov/public/index.cfm/contact"
},
{
    firstName: "Timothy",
    lastName: "Kaine",
    street: "231 Russell Senate Office Building",
    city: "Washington DC",
    state: "VA",
    zip: " 20510",
    phone: "202-224-4024",
    website: "https://www.kaine.senate.gov",
    email: "",
    contact: "https://www.kaine.senate.gov/contact"
},
</pre>
<p>In the <strong>LearnLocalStorage</strong> assignment, I explain how to convert the output of this program to JSON.</p>
<ul>
<li><a href="http://www.ccalvert.net/books/CloudNotes/Assignments/Browser/LearnLocalStorage.html#create-json">Learn Local Storage JSON</a></li>
</ul>
<a class="anchor" id="turn-it-in"></a>
<h2>Turn it in</h2>
<p>Add, commit, push, then tag and/or branch.</p>
<p>We want to be able to either:</p>
<ul>
<li>The primary goal is to produce a valid JSON file called <strong>address-list.json</strong> containing all our addresses.</li>
<li>It would also be good to produce a valid <strong>address-list.js</strong> file</li>
</ul>
<p>If you can do either, that would fulfill the requirements of the assignment. If you can do both, that would be even better, but it is not required.</p>
<p>See also, this portion of the</p>
<a class="anchor" id="hint-tagging"></a>
<h2>Hint Tagging</h2>
<ul>
<li><a href="http://www.elvenware.com/charlie/development/cloud/Git.html#git-tag">Git Tag</a></li>
<li><a href="http://www.elvenware.com/charlie/development/cloud/Git.html#understanding-tags">Understanding Tags</a></li>
</ul>
<a class="anchor" id="pad-number"></a>
<h2>Pad Number</h2>
<pre>var padNumber = function(numberToPad, width, padValue) {
    padValue = padValue || '0';
    numberToPad += '';
    if (numberToPad.length >= width) {
        return numberToPad;
    } else {
        return new Array(width - numberToPad.length + 1).join(padValue) + numberToPad;
    }
};
</pre>
</div></body></html>