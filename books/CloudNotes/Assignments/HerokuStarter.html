<!DOCTYPE html><html lang="en" dir="ltr"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width initial-scale=1.0"><title>HerokuStarter</title><link rel="shortcut icon" href="/charlie/images/favicon.png"><!-- Latest compiled and minified CSS--><link rel="stylesheet" href="/components/bootstrap/dist/css/bootstrap.min.css"><!-- Optional theme--><link rel="stylesheet" href="/components/bootstrap/dist/css/bootstrap-theme.min.css"><!-- link(href='/libs/css/BootstrapIndex.css', rel='stylesheet', type='text/css')--><link href="/css/style.css" rel="stylesheet" type="text/css"><link href="/css/highlight/googlecode.css" rel="stylesheet" type="text/css"><script src="/components/jquery/dist/jquery.js"></script><script src="/components/angular/angular.js"></script><script src="/components/angular-route/angular-route.js"></script><script src="/components/bootstrap/dist/js/bootstrap.min.js"></script><!-- script(src='/libs/scripts/elvenware.js', type='text/javascript')--><!-- script(src="/libs/scripts/Control.js")--><!-- script(src='http://localhost:35729/livereload.js')--></head><body><div class="navbar navbar-inverse"><div class="container"><div class="navbar-header"><button type="button" data-toggle="collapse" data-target=".navbar-collapse" class="navbar-toggle"><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><a href="/" class="navbar-brand">Elvenware</a></div><div class="collapse navbar-collapse"><ul class="nav navbar-nav"><li class="active"><a href="/index.html">Home</a></li><li><a href="/about">About</a></li><li class="dropdown"><a href="#/" data-toggle="dropdown" class="dropdown-toggle">Dropdown<b class="caret"></b></a><ul class="dropdown-menu"><li class="dropdown-header">Core Code</li><li><a href="/development/index.html">Strongly Typed</a></li><li><a href="/development/web/index.html">Web & Scripts</a></li><li><a href="/development/cloud/index.shtml">Cloud</a></li><li class="divider"></li><li class="dropdown-header">OS and Tools</li><li><a href="/os/index.html">OS</a></li><li><a href="/development/database/index.html">Database</a></li><li><a href="/books/index.html">My Writing</a></li><li class="divider"></li><li class="dropdown-header">Art</li><li><a href="/charlie/Art/index.html">Poems & Photos</a></li><li><a href="/books/reading/index.html">Book Reviews</a></li><li><a href="/spirit/index.html">Spiritual</a></li><li class="divider"></li><li class="dropdown-header">Links</li><li><a href="/charlie/links.html">My Links</a></li><li><a href="http://www.github.com/charliecalvert">GitHub</a></li><li><a href="http://sourceforge.net/projects/elvenware/">Sourceforge</a></li></ul></li></ul></div><!-- /.nav-collapse--></div></div><div class="container"><figure><img alt="Elvenware" src="/charlie/images/elvenwarelogo.png"/></figure><h1>HerokuStarter</h1><h3>Table of Contents</h3><ul><!--TOC_Start--><li><a href="#deploy">Deploy</a></li>
<li><a href="#status">Status</a></li>
<li><a href="#delete">Delete</a></li>
<li><a href="#npm-and-bower">NPM and Bower</a></li>
<li><a href="#trouble-shoot">Trouble Shoot</a></li>
<li><a href="#create-solarexplorer">Create SolarExplorer</a></li>
<li><a href="#ssh">SSH</a></li>
<li><a href="#turn-it-in">Turn it in</a></li>
<li><a href="#hints">Hints</a></li><!--TOC_End--></ul><p>Join <a href="https://www.heroku.com/">heroku</a>. Note your user name and password, or save your account into LastPass or the like. For language, choose NodeJs.</p>
<p>Take a moment to think about heroku&#39;s pricing. We will be using the free tier:</p>
<ul>
<li><a href="https://www.heroku.com/pricing">https://www.heroku.com/pricing</a></li>
</ul>
<p>Make sure you have ruby installed. If you have it installed you will see the following if you type <strong>which ruby</strong></p>
<pre>
$ which ruby
/usr/bin/ruby
</pre>

<p>If you don&#39;t have it installed, install it like this:</p>
<pre>
sudo apt-get install ruby-full
</pre>

<p>On Cloud 9, heroku is already installed. But on Pristine Lubunutu you will need to install Heroku. The command is simple:</p>
<pre>
wget -O- https://toolbelt.heroku.com/install-ubuntu.sh | sh
</pre>

<p>Now Type <strong>heroku</strong> on Pristine or Lubuntu or <strong>heroku auth:login</strong> on Cloud 9. Log in with your heroku user name and password. On Pristine Lubuntu:</p>
<pre>
$ heroku
heroku-cli: Installing CLI... 22.7MB/22.7MBB
Enter your Heroku credentials.
Email: foobar@foo.com
Password (typing will be hidden):
Logged in as foobar@foo.com

 ▸    Add apps to this dashboard by favoriting them with heroku apps:favorites:add
See all add-ons with heroku addons
See all apps with heroku apps --all

See other CLI commands with heroku help
</pre>

<p>On Cloud Nine, or if you don&#39;t see the login pronpt when you type <strong>heroku</strong>, the try <strong>heroku auth:login</strong> instead:</p>
<pre>
heroku auth:login
Enter your Heroku credentials.
Email: foo@foobar.com
Password (typing will be hidden):
Logged in as foo@foobar.com
</pre>

<p>Make sure you have node 4.0 or greater installed. Check also for npm and git. You don&#39;t need the exact numbers, but they should not be wildly different:</p>
<p></pre>
$ node --version
v5.11.0
charlie@rohan-elf:~/temp
$ npm -v
3.8.6
charlie@rohan-elf:~/temp
$ git --version
git version 2.7.4
</pre></p>
<h2 id="deploy">Deploy</h2>
<p>Go to your ~/Source or ~/temp directory and run the following:</p>
<p><strong>NOTE</strong>: <em>Don&#39;t create your heroku project in your repository. If you do, you will end up with a repository nested in a repository, which you want to avoid.</em></p>
<pre>
CreateExpressProject lastname01
cd lastname01
git init
npm install
</pre>

<p>Now create the heroku app, executing this command from the root of your new project:</p>
<pre>
heroku create lastname01
</pre>

<p>And some details:</p>
<pre>
echo 'web: node bin/www' > Procfile
echo 'node_modules' > .gitignore
echo '.idea' >> .gitignore
echo '.c9' >> .gitignore
echo 'components' >> .gitignore
</pre>

<p>Perform a standard <strong>git add .</strong> and <strong>git commit -m &quot;First commit to heroku of XXX project&quot;</strong>. Customize the commit comment in any way want, the text I show is just a suggestion. Then push to git like this:</p>
<pre>
git push --set-upstream heroku master
</pre>

<p>Make sure you have your app running:</p>
<pre>
heroku ps:scale web=1h
</pre>

<p>On Pristine Lubuntu, but probably not on Cloud Nine, you can start your app in a browser like this:</p>
<pre>
heroku open
</pre>

<p>Push your app:</p>
<pre>
git push heroku master
</pre>

<p>All at once check list, but probably don&#39;t do the last command, open, on Cloud 9:</p>
<pre>
CreateExpressProject Heru02
cd Heru02/
npm install
git init
heroku create heru02
echo 'web: node bin/www' > Procfile
echo 'node_modules' > .gitignore
echo '.idea' >> .gitignore
echo '.c9' >> .gitignore
git add .
git commit -m "Initial commit"
git push --set-upstream heroku master
heroku open
</pre>

<h2 id="status">Status</h2>
<p>There&#39;s <strong>heroku apps:info</strong> from inside the folder of one of your apps:</p>
<pre>
$ heroku apps:info
=== heru03
Dynos:         
Git URL:       https://git.heroku.com/heru03.git
Owner:         foo@foobar.com
Region:        us
Repo Size:     8 KB
Slug Size:     14 MB
Stack:         cedar-14
Web URL:       https://heru03.herokuapp.com/
</pre>

<p>And <strong>heroku ps</strong></p>
<pre>
heroku ps
No dynos on ⬢ heru03
</pre>

<p>See how much time an app has left in its 18 hours:  <strong>heroku ps -a heru03</strong></p>
<h2 id="delete">Delete</h2>
<p>Delete an app from heroku with: heroku apps:destroy --app <APP_NAME></p>
<p>For example, to delete an app called boiling-brook-54970:</p>
<pre>
heroku apps:destroy --app boiling-brook-54970
▸    WARNING: This will delete ⬢ boiling-brook-54970 including all add-ons.
▸    To proceed, type boiling-brook-54970 or re-run this command with
▸    --confirm boiling-brook-54970

\> boiling-brook-54970
</pre>

<h2 id="npm-and-bower">NPM and Bower</h2>
<p>In NPM, we don&#39;t need dev dependencies. We need, however, to add manually install of bower and a <strong>postinstall</strong> step:</p>
<pre><code class="lang-javascript">{
  "<span class="hljs-attr">name</span>": <span class="hljs-string">"Week05-ExpressRoutesSolar"</span>,
  "<span class="hljs-attr">version</span>": <span class="hljs-string">"0.0.0"</span>,
  "<span class="hljs-attr">private</span>": <span class="hljs-literal">true</span>,
  "<span class="hljs-attr">scripts</span>": {
    "<span class="hljs-attr">start</span>": <span class="hljs-string">"node ./bin/www"</span>,
    "<span class="hljs-attr">postinstall</span>": <span class="hljs-string">"node_modules/bower/bin/bower install"</span>
  },
  "<span class="hljs-attr">dependencies</span>": {
    "<span class="hljs-attr">bower</span>": <span class="hljs-string">"~1.7.9"</span>,
    "<span class="hljs-attr">body-parser</span>": <span class="hljs-string">"~1.13.2"</span>,    
    "<span class="hljs-attr">cookie-parser</span>": <span class="hljs-string">"~1.3.5"</span>,
    "<span class="hljs-attr">debug</span>": <span class="hljs-string">"~2.2.0"</span>,
    "<span class="hljs-attr">express</span>": <span class="hljs-string">"~4.13.1"</span>,
    "<span class="hljs-attr">jade</span>": <span class="hljs-string">"~1.11.0"</span>,
    "<span class="hljs-attr">morgan</span>": <span class="hljs-string">"~1.6.1"</span>,
    "<span class="hljs-attr">serve-favicon</span>": <span class="hljs-string">"~2.3.0"</span>
  }
}
</code></pre>
<h2 id="trouble-shoot">Trouble Shoot</h2>
<p>I got an error with HTML that had this content:</p>
<pre>
Application Error

An error occurred in the application and your page could not be served. Please try again in a few moments.

If you are the application owner, check your logs for details.
</pre>

<p>I ran <strong>heroku logs</strong>:</p>
<pre>
2016-06-01T01:29:44.276435+00:00 heroku[router]: at=error code=H14 desc="No web processes running" method=GET path="/favicon.ico" host=charlie001.herokuapp.com request_id=f54879f9-c619-4eac-be05-6ec0d6eeec7a fwd="73.97.86.37" dyno= connect= service= status=503 bytes=
</pre>

<p>As you can see, I got error H14.</p>
<ul>
<li><a href="https://devcenter.heroku.com/articles/error-codes">https://devcenter.heroku.com/articles/error-codes</a></li>
</ul>
<p>To fix it, make sure you have at least one web dyno running. Here I check and find that I am running zero dynos by running <strong>heroku ps</strong>:</p>
<p></pre>
heroku ps
No dynos on ⬢ charlie001
</pre></p>
<p>From inside my repo I add a single web dyno with <strong>heroku ps:scale web=1</strong>:</p>
<pre>
heroku ps:scale web=1
Scaling dynos... done, now running web at 1:1X
</pre>

<p>I check again to see if it worked:</p>
<pre>
heroku ps
=== web (1X): node index.js (1)
web.1: up 2016/05/31 18:32:24 -0700 (~ 14s ago)
</pre>

<p>Now life is good.</p>
<p>If you want to stop running your dyno:</p>
<pre>
heroku ps:scale web=0
</pre>

<h2 id="create-solarexplorer">Create SolarExplorer</h2>
<p>Pick the branch in repository that you like. Go to your <strong>~/Source</strong> or <strong>~/temp</strong> directory and copy your <strong>SolarExplorer</strong> or <strong>SolarVoyager</strong> or whatever is the best version of your project, by issuing the command only once. Your command might look something likie this:</p>
<pre>
cd ~/temp
cp -r ~/Git/prog272-calvert-2016/SolarExplorer/ .
</pre>

<p>Remove from <strong>package.json</strong> your dev-dependencies. Run this command:</p>
<pre>
cd SolarVoyager
git init
npm install bower --save
</pre>

<p>And add a postinstall to the scripts section of package.json:</p>
<pre>
"scripts": {
   "start": "node ./bin/www",
   "postinstall": "node_modules/bower/bin/bower install"
 },
</pre>

<p>The package.json file might look a bit like this after you edit it:</p>
<pre><code class="lang-javascript">{
  "<span class="hljs-attr">name</span>": <span class="hljs-string">"Week05-ExpressRoutesSolar"</span>,
  "<span class="hljs-attr">version</span>": <span class="hljs-string">"0.0.0"</span>,
  "<span class="hljs-attr">private</span>": <span class="hljs-literal">true</span>,
  "<span class="hljs-attr">scripts</span>": {
    "<span class="hljs-attr">start</span>": <span class="hljs-string">"node ./bin/www"</span>,
    "<span class="hljs-attr">postinstall</span>": <span class="hljs-string">"node_modules/bower/bin/bower install"</span>
  },
  "<span class="hljs-attr">dependencies</span>": {
    "<span class="hljs-attr">body-parser</span>": <span class="hljs-string">"~1.13.2"</span>,
    "<span class="hljs-attr">bower</span>": <span class="hljs-string">"^1.7.9"</span>,
    "<span class="hljs-attr">cookie-parser</span>": <span class="hljs-string">"~1.3.5"</span>,
    "<span class="hljs-attr">debug</span>": <span class="hljs-string">"~2.2.0"</span>,
    "<span class="hljs-attr">express</span>": <span class="hljs-string">"~4.13.1"</span>,
    "<span class="hljs-attr">jade</span>": <span class="hljs-string">"~1.11.0"</span>,
    "<span class="hljs-attr">morgan</span>": <span class="hljs-string">"~1.6.1"</span>,
    "<span class="hljs-attr">serve-favicon</span>": <span class="hljs-string">"~2.3.0"</span>
  }
}
</code></pre>
<p>Then run <strong>git init</strong>.  And set up <strong>.gitignore</strong> we did above. Then run <strong>heroku create</strong>:</p>
<pre>
heroku create SolarExplorerCalvert
</pre>


<h2 id="ssh">SSH</h2>
<p>Don&#39;t do this section. It is not important.</p>
<p>Create new key called <strong>id_rsa</strong> if you don&#39;t have one already:</p>
<pre>
cd
ssh-keygen -t rsa -P '' -f ~/.ssh/id_rsa
cat ~/.ssh/id_rsa.pub >> ~/.ssh/authorized_keys
</pre>

<p>Add your public key to heroku with a command like this: <strong>heroku keys:add MyKey.pub </strong></p>
<p>List your keys: <strong>heroku keys</strong></p>
<p>ssh -v git@heroku.com</p>
<p>You want to see: <strong>Authenticated to heroku.com ([50.19.85.156]:22).</strong></p>
<p>I prefer not to use HTTPS. For instance, I&#39;m not happy if I see this because it shows I&#39;m using HTTPS:</p>
<pre>
git remote -v
origin    https://git.heroku.com/charlie001.git (fetch)
origin    https://git.heroku.com/charlie001.git (push)
</pre>

<p>To switch from using HTTPS to SSH, you can issue this command, but I have found it to be very dangerous:</p>
<pre>
git config --global url.ssh://git@heroku.com/.insteadOf https://git.heroku.com/
</pre>

<p>It would be simpler just to open <strong>.git/config</strong> and edit your git URLs by hand.</p>
<p>To check your work and confirm that you are now using SSH, run <strong>git remote -v</strong>:</p>
<pre>
$ git remote -v
origin    ssh://git@heroku.com/charlie001.git (fetch)
origin    ssh://git@heroku.com/charlie001.git (push)
</pre>

<h2 id="turn-it-in">Turn it in</h2>
<p>Send me the URL of your app</p>
<h2 id="hints">Hints</h2>
<p>The best docs are on the Heroku site. But there are others, such as:</p>
<ul>
<li><a href="https://scotch.io/tutorials/how-to-deploy-a-node-js-app-to-heroku">https://scotch.io/tutorials/how-to-deploy-a-node-js-app-to-heroku</a></li>
</ul>
</div></body></html>