<!DOCTYPE html><html lang="en" dir="ltr"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width initial-scale=1.0"><title>BitlyRefine</title><link href="/css/first-style.css" rel="stylesheet"><link rel="shortcut icon" href="/images/favicon.png"><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet"><link href="/css/highlight/googlecode.css" rel="stylesheet" type="text/css"><link href="/css/style.css" rel="stylesheet"><script src="https://code.jquery.com/jquery-1.12.0.min.js"></script><script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<!-- Latest compiled and minified CSS --><script src="/js/elven-help.js"></script></head><body><nav class="navbar navbar-inverse"><div class="container"><div class="navbar-header"><button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><a class="navbar-brand" href="/">Elvenware</a></div><div class="navbar-collapse collapse" id="navbar"><ul class="nav navbar-nav"><li class="trigger-collapse" ng-class="{ active: isActive('/')}"><a href="/">Home</a></li><li><a href="/about.html">About</a></li></ul></div></div></nav><div class="container"><figure><img class="elf-normal" alt="Elvenware" src="/images/elvenwarelogo.png"/></figure><h1>BitlyRefine</h1><p>Welcome to BitlyRefine</p><ul><!--TOC_Start--><li><a href="#overview">Overview</a></li>
<li><a href="#create-project">Create Project</a></li>
<li><a href="#display-updates">Display Updates</a></li>
<li><a href="#clear-controls">Clear Controls</a></li>
<li><a href="#elf-unity">Elf Unity</a></li>
<li><a href="#css-updates">CSS Updates</a></li>
<li><a href="#creating-a-table">Creating a table</a></li>
<li><a href="#jade-mixins">Jade Mixins</a></li>
<li><a href="#set-up-the-title">Set up the Title</a></li>
<li><a href="#unit-tests">Unit Tests</a></li>
<li><a href="#turn-it-in">Turn it in</a></li>
<li><a href="#all-tests">Copy All Tests</a></li>
<li><a href="#delicious-links">Delicious Links</a></li>
<li><a href="#test-directories">Test Directories</a></li><!--TOC_End--></ul></div><div class="container"><a class="anchor" id="overview"></a>
<h1>Overview</h1>
<p>Your goal is to refine the BitlyInteractive program into something reasonably attractive and easy to use.</p>
<p><a href="https://s3.amazonaws.com/bucket01.elvenware.com/images/BitlyRefine01.png"><img src="https://s3.amazonaws.com/bucket01.elvenware.com/images/BitlyRefine01Small.png" alt="BitlyRefine"></a></p>
<a class="anchor" id="create-project"></a>
<h2>Create Project</h2>
<p>Copy Week06-BitlyInteractive into Week07-BitlyRefine</p>
<pre><code><span class="hljs-symbol">cp</span> Week06-<span class="hljs-keyword">BitlyInteractive </span>Week07-<span class="hljs-keyword">BitlyRefine</span>
</code></pre><p>Update the project name to <strong>BitlyRefine</strong> in:</p>
<ul>
<li>bin/www</li>
<li>routes/index.js</li>
<li>package.json</li>
</ul>
<p><strong>NOTE</strong>: <em>I understand why you would want to work on a single project and keep updating it, but I want you to work one step at a time. I&#39;m expecting to see three directories: <strong>Week06-BitlyQuery</strong>, <strong>Week06-BitlyInteractive</strong>, and <strong>Week07-BitlyRefine</strong>. Each folder should contain the proper code for their respective assignments.</em></p>
<a class="anchor" id="display-updates"></a>
<h2>Display Updates</h2>
<p>Right now we have several methods that have to do with displaying the fields of a link object. These don&#39;t really belong in the main object found in <strong>control.js</strong>. Let&#39;s move then into their own file called display.</p>
<p>In particular, I&#39;m talking about the methods called:</p>
<ul>
<li>display</li>
<li>showRecord</li>
</ul>
<p>I want you to rename <strong>display</strong> to <strong>display.render</strong>. The object you create should have at least this much in it:</p>
<ul>
<li>display.render</li>
<li>display.showRecord</li>
<li>display.renderTable</li>
<li>display.showTableSelection</li>
</ul>
<p>The latter two methods can be empty for now. So your code might look something like this:</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">var</span> elfDisplay={

    <span class="hljs-attr">render</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
<span class="hljs-meta">        'use strict'</span>;
        <span class="hljs-comment">// VERY SIMILAR TO CODE FROM BitlyInteractive</span>
    },

    <span class="hljs-attr">renderTable</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">links</span>) </span>{
<span class="hljs-meta">        'use strict'</span>;
        <span class="hljs-comment">// CAN BE EMPTY FOR NOW</span>
    },

    <span class="hljs-attr">showRecord</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">bitlyLink</span>) </span>{
<span class="hljs-meta">        'use strict'</span>;
        <span class="hljs-comment">// VERY SIMILAR OR IDENTICAL TO CODE FROM BitlyInteractive</span>
    },

    <span class="hljs-attr">showTableSelection</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>) </span>{
<span class="hljs-meta">        'use strict'</span>;
        <span class="hljs-comment">// CAN BE EMPTY AT FIRST</span>
    }

};
</code></pre>
<p>Don&#39;t forget that you need to load your new JavaScript files in <strong>layout.jade</strong>. In particular you will need to load <strong>control.js</strong>, <strong>downloads.js</strong>, <strong>movement.js</strong> and <strong>display.js</strong>:</p>
<pre><code>script(<span class="hljs-attribute">src</span>=<span class="hljs-string">"javascripts/control.js"</span>)
script(<span class="hljs-attribute">src</span>=<span class="hljs-string">"javascripts/etc...
script(src="</span>javascripts/etc...
script(<span class="hljs-attribute">src</span>=<span class="hljs-string">"javascripts/etc...</span>
</code></pre><p>Don&#39;t forget to include the <strong>downloads</strong> module in the project. It was given to you in <a href="https://www.ccalvert.net/books/CloudNotes/Assignments/BitlyInteractive.html#the-downloads-module">bitly interactive</a>.</p>
<p>More information is available below in the Create Table section.</p>
<a class="anchor" id="clear-controls"></a>
<h2>Clear Controls</h2>
<p>You will also want to clear the table so that the user can see the new data when you switch back and forth between <strong>local</strong> and <strong>cloud</strong> data. The call should be made just before you want to fill in the table with new data.</p>
<pre><code class="lang-javascript">elfDownloads.clearControls = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
<span class="hljs-meta">    'use strict'</span>;
    $(<span class="hljs-string">'#tableLinks'</span>).empty();
};
</code></pre>
<a class="anchor" id="elf-unity"></a>
<h2>Elf Unity</h2>
<p>This is a refactoring issue. We want to take a halfway step to fixing the global namespace problem. Let&#39;s begin by making sure all our objects begin with the letters <strong>elf</strong>.</p>
<p>While you are doing the following, be sure you are running the unit tests. We are going to be changing variable names in multiple locations, and even when using Refactor in WebStorm, this can be complicated. As you make changes, run your unit tests and make sure they all pass. Also, check to make sure the interface works.</p>
<p>The refactor option in WebStorm can help with this process, but it can also make changes that you are not expecting. I think the unit tests are more help than the <strong>refactor</strong> option, but you may have a different opinion.</p>
<p><strong>NOTE</strong>: <em>Make changes one at a time. If you attempt to make too many changes at once, you won&#39;t know what is broken. Make a change, confirm that it works, then make the next change.</em></p>
<p>In particular, rename the main objects in your program as follows:</p>
<ul>
<li>elfBitly (This was <strong>bitlyUrlParser</strong> and is in <strong>control.js</strong>)</li>
<li>elfMovement (<strong>movement.js</strong>)</li>
<li>elfDisplay (<strong>display.js</strong>)</li>
<li>elfDownloads (<strong>downloads.js</strong>)</li>
</ul>
<p>We are not changing any file names, just the objects in the files.</p>
<p>Given these changes, we would call the <strong>renderTable</strong> method in <strong>display.js</strong> from a modified <strong>getBlitlyLinks</strong> method:</p>
<pre><code class="lang-javascript">getBitlyLinks: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">accessToken</span>) </span>{
<span class="hljs-meta">    'use strict'</span>;
    <span class="hljs-keyword">var</span> url = elfBitly.getUrl(accessToken);

    $.getJSON(url, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">result</span>) </span>{
        elfBitly.bitlyLinks = result;
        elfDisplay.render();
        elfDisplay.renderTable(elfBitly.getLinkHistoryArray());
        $(<span class="hljs-string">'#displayLinks'</span>).html(<span class="hljs-built_in">JSON</span>.stringify(result, <span class="hljs-literal">null</span>, <span class="hljs-number">4</span>));
    }).fail(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">jqxhr, textStatus, error</span>) </span>{
        <span class="hljs-keyword">var</span> err = textStatus + <span class="hljs-string">', '</span> + error;
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'Request Failed: '</span> + err);
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'url:'</span>, url);
    });
},
</code></pre>
<a class="anchor" id="css-updates"></a>
<h2>CSS Updates</h2>
<p>Create the <strong>.elfDiv</strong> class in styles.css</p>
<p>Set the border width in <strong>styles.css</strong></p>
<p>Changes to elfInput, including moving to its own file.</p>
<p>Describe the elfDivFolder</p>
<p>Here is my current <strong>public/stylesheets/style.css</strong> file:</p>
<pre><code><span class="hljs-selector-tag">body</span> {
  <span class="hljs-attribute">padding</span>: <span class="hljs-number">10px</span>;
  <span class="hljs-attribute">font</span>: <span class="hljs-number">14px</span> <span class="hljs-string">"Lucida Grande"</span>, Helvetica, Arial, sans-serif;
}

<span class="hljs-selector-tag">a</span> {
  <span class="hljs-attribute">color</span>: <span class="hljs-number">#00B7FF</span>;
}


<span class="hljs-selector-class">.elfDiv</span> {
  <span class="hljs-attribute">max-width</span>: <span class="hljs-number">800px</span>;
  <span class="hljs-attribute">border</span>: ridge <span class="hljs-number">1px</span> black;
  <span class="hljs-attribute">margin</span>: auto;
}

<span class="hljs-selector-class">.scroller</span> {
  <span class="hljs-attribute">height</span>: <span class="hljs-number">220px</span>;
  <span class="hljs-attribute">overflow</span>: auto;
}
</code></pre><p>Note that I have set the <strong>padding</strong> in the BODY tag to 10px rather than the default <strong>50px</strong> that we get by default in Express projects.</p>
<p>The <strong>elfDiv</strong> class ensures that the width of our panels is never larger than 800px, and that the panels are centered in the page. We center them by setting their margins to equivalent values: <strong>margin:auto</strong>.</p>
<p>The scroller class is used to help us scroll the table that we put inside a panel, as described elsewhere in this document.</p>
<a class="anchor" id="creating-a-table"></a>
<h2>Creating a table</h2>
<p>Our interface has a new section in it called <strong>Bitly Links Table</strong>. (See screen shot above.) Here are some hints on how to create it.</p>
<p>In <strong>elfDisplay</strong> fill in the <strong>renderTable</strong> method. In the code shown below, you will need to discover which fields of the <strong>link</strong> object you want to include to create results like that shown in the screenshot:</p>
<pre><code class="lang-javascript">    renderTable: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">links</span>) </span>{
<span class="hljs-meta">        'use strict'</span>;
        $.each(links, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">index, link</span>) </span>{
            <span class="hljs-keyword">var</span> title = <span class="hljs-string">"&lt;td&gt;"</span> + WHAT GOES HERE? +  <span class="hljs-string">"&lt;/td&gt;"</span>;
            <span class="hljs-keyword">var</span> keyword = <span class="hljs-string">"&lt;td&gt;"</span> + WHAT GOES HERE? + <span class="hljs-string">"&lt;/td&gt;"</span>;
            <span class="hljs-keyword">var</span> tableRowStart = <span class="hljs-string">"&lt;tr class='linkTitle' index="</span> + index + <span class="hljs-string">"&gt;"</span>;
            $(<span class="hljs-string">"#tableLinks"</span>).append(tableRowStart + WHAT GOES HERE? + <span class="hljs-string">"&lt;tr&gt;"</span>);
        });
        $(<span class="hljs-string">'.linkTitle'</span>).click(elfDisplay.showTableSelection);
    },
</code></pre>
<p>Notice that each <TR> has a class and custom attribute called <strong>index</strong> associated with it:</p>
<pre><code class="lang-javascript"><span class="hljs-attribute">var tableRowStart</span> = <span class="hljs-string">"&lt;tr class='linkTitle' index="</span> + index + <span class="hljs-string">"&gt;"</span>;
</code></pre>
<p>The <strong>jQuery</strong> code at the bottom of the method ensures that if the user clicks on one of these rows, then the <strong>elfDisplay.showTableSelection</strong> method will be called:</p>
<pre><code class="lang-javascript">showTableSelection: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>) </span>{
<span class="hljs-meta">    'use strict'</span>;
    <span class="hljs-keyword">var</span> index = $(event.currentTarget).attr(<span class="hljs-string">'index'</span>);
    <span class="hljs-keyword">var</span> link = elfBitly.getLinkHistory(index, <span class="hljs-literal">true</span>);
    <span class="hljs-comment">// CALL THE showRecord METHOD OF elfDisplay HERE.</span>
}
</code></pre>
<p>This code requires a moment&#39;s study. Each <TR> element has an attribute called <strong>index</strong> that is set to the offset of that particular row in our <strong>bitly-links.json</strong> file. We can use that index to display the appropriate link object in our main form. All we need to do, is get ahold of the value of the <strong>index</strong> attribute for the row the user clicked. To do that, we use the jQuery <strong>attr</strong> property. Make sure you understand this code. It is important to understand how to work with attributes of your HTML elements.</p>
<p>Here is the updated <strong>getLinkHistory</strong> method:</p>
<pre><code class="lang-javascript">getLinkHistory: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">index, setLinkIndex</span>) </span>{
<span class="hljs-meta">    'use strict'</span>;
    <span class="hljs-keyword">if</span> (setLinkIndex) {
        elfBitly.linkIndex = <span class="hljs-built_in">parseInt</span>(index);
    }
    <span class="hljs-keyword">return</span> elfBitly.bitlyLinks.data.link_history[index];

},
</code></pre>
<p>As you can see, it is has been modified to ensure that we continue to track the currently selected item in the <strong>linkIndex</strong> property of <strong>elfBitly</strong></p>
<p>Here is the Jade that we use to hold our table.</p>
<pre><code>+elfPanel(<span class="hljs-string">"Bitly Links Table"</span>)<span class="hljs-selector-class">.elfDiv</span>
    <span class="hljs-selector-tag">div</span><span class="hljs-selector-class">.scroller</span>
        <span class="hljs-selector-tag">table</span>.table#tableLinks
</code></pre><p>This jade and CSS <strong>scroller</strong> class found in <strong>styles.css</strong> ensure that our table has scroll bars and can be scrolled.</p>
<a class="anchor" id="jade-mixins"></a>
<h2>Jade Mixins</h2>
<p>Start dividing mixins into easy to comprehend files. When you are done, the top of <strong>index.jade</strong> might look something like this:</p>
<pre><code>extends layout
<span class="hljs-keyword">include</span> <span class="hljs-keyword">mixin</span>-radios
<span class="hljs-keyword">include</span> <span class="hljs-keyword">mixin</span>-inputs
<span class="hljs-keyword">include</span> <span class="hljs-keyword">mixin</span>-buttons
</code></pre><p>Here are my <strong>mixin-buttons.jade</strong> file:</p>
<pre><code>mixin forwardBack(leftFunction, rightFunction)
    button.btn.btn-success.btn-<span class="hljs-built_in">large</span>(<span class="hljs-built_in">type</span>='button', onclick= leftFunction)
       span.glyphicon.glyphicon-arrow-<span class="hljs-built_in">left</span>
       | &amp;nbsp; <span class="hljs-built_in">Left</span>
    span &amp;nbsp;
    button.btn.btn-success.btn-<span class="hljs-built_in">large</span>(<span class="hljs-built_in">type</span>='button', onclick= rightFunction)
       | <span class="hljs-built_in">Right</span> &amp;nbsp;
       span.glyphicon.glyphicon-arrow-<span class="hljs-built_in">right</span>

mixin downloadButton(title, downloadFunction)
    button.btn.btn-primary(<span class="hljs-built_in">type</span>='button', onclick= downloadFunction)
        | #{title} &amp;nbsp;&amp;nbsp;
        span.glyphicon.glyphicon-download

</code></pre><p>One could use them like this:</p>
<pre><code>+<span class="hljs-selector-tag">forwardBack</span>(<span class="hljs-string">"elfMovement.left()"</span>, <span class="hljs-string">"elfMovement.right()"</span>)
+<span class="hljs-selector-tag">downloadButton</span>(<span class="hljs-string">"Get Bitly Data"</span>, <span class="hljs-string">"downloads.getBitlyData()"</span>)
</code></pre><p>I have also moved the input controls into their own file called <strong>mixin-inputs.jade</strong>:</p>
<pre><code><span class="hljs-comment">// **************</span>
<span class="hljs-comment">// Vertical Input Controls</span>
<span class="hljs-comment">// **************</span>

mixin elfInput(labelText, <span class="hljs-keyword">name</span>, placeHolder)
   <span class="hljs-keyword">div</span>
      <span class="hljs-keyword">label</span>(<span class="hljs-keyword">for</span>=<span class="hljs-string">'subject'</span>) #<span class="hljs-comment">{labelText}</span>
      input(<span class="hljs-keyword">type</span>=<span class="hljs-string">'text'</span>, <span class="hljs-keyword">name</span>=<span class="hljs-keyword">name</span>, placeholder=placeHolder)&amp;attributes(attributes)

mixin elfInputVB(labelText, <span class="hljs-keyword">name</span>, placeHolder, labelType)
   - <span class="hljs-keyword">if</span> (typeof attributes.buttonType === <span class="hljs-string">'undefined'</span>) <span class="hljs-comment">{
   -        attributes.buttonType="btn-default";
   - }</span>

   <span class="hljs-keyword">div</span>
      <span class="hljs-keyword">label</span>.<span class="hljs-keyword">label</span>.<span class="hljs-keyword">label</span>-<span class="hljs-keyword">default</span>(<span class="hljs-keyword">for</span>=<span class="hljs-string">'subject'</span>) #<span class="hljs-comment">{labelText}</span>
      input(<span class="hljs-keyword">type</span>=<span class="hljs-string">'text'</span>, <span class="hljs-keyword">name</span>=<span class="hljs-keyword">name</span>, placeholder=placeHolder)&amp;attributes(attributes)


<span class="hljs-comment">// **************</span>
<span class="hljs-comment">// Horizontal Input Controls</span>
<span class="hljs-comment">// **************</span>
mixin elfInputA(labelText, <span class="hljs-keyword">name</span>, placeHolder)
   <span class="hljs-keyword">div</span>.row
      <span class="hljs-keyword">label</span>.col-md-<span class="hljs-number">2</span>.control-<span class="hljs-keyword">label</span>(<span class="hljs-keyword">for</span>=<span class="hljs-string">'textinput'</span>) #<span class="hljs-comment">{labelText}</span>
      .col-md-<span class="hljs-number">8</span>
         input.form-control.input-md(<span class="hljs-keyword">name</span>=<span class="hljs-keyword">name</span>, <span class="hljs-keyword">type</span>=<span class="hljs-string">'text'</span>, placeholder=placeholder)&amp;attributes(attributes)

mixin elfInputB(labelText, <span class="hljs-keyword">name</span>, placeHolder)
   <span class="hljs-keyword">div</span>.row
      h4
         span.col-md-<span class="hljs-number">2</span>.<span class="hljs-keyword">label</span>.<span class="hljs-keyword">label</span>-success #<span class="hljs-comment">{labelText}</span>
      .col-md-<span class="hljs-number">10</span>
         input.form-control.input-md(<span class="hljs-keyword">name</span>=<span class="hljs-keyword">name</span>, <span class="hljs-keyword">type</span>=<span class="hljs-string">'text'</span>, placeholder=placeholder)&amp;attributes(attributes)

mixin elfInputHorizontal(labelText, <span class="hljs-keyword">name</span>, placeHolder)
   .form-group
      span.col-xs-<span class="hljs-number">2</span>.<span class="hljs-keyword">label</span>.<span class="hljs-keyword">label</span>-success #<span class="hljs-comment">{labelText}</span>
      .col-xs-<span class="hljs-number">10</span>
         input.form-control.input-sm(<span class="hljs-keyword">name</span>=<span class="hljs-keyword">name</span>, <span class="hljs-keyword">type</span>=<span class="hljs-string">'text'</span>, placeholder=placeholder)&amp;attributes(attributes)
</code></pre><p>All this is in <strong>$ELF_TEMPLATES</strong>. Therefore the following code should get up to date, so long as you first ran <strong>git pull</strong> in JsObjects:</p>
<pre><code class="lang-bash">cp <span class="hljs-variable">$ELF_TEMPLATES</span>/JadeMixins/mixin-inputs<span class="hljs-selector-class">.jade</span> views/.
cp <span class="hljs-variable">$ELF_TEMPLATES</span>/JadeMixins/mixin-radios<span class="hljs-selector-class">.jade</span> views/.
cp <span class="hljs-variable">$ELF_TEMPLATES</span>/JadeMixins/mixin-buttons<span class="hljs-selector-class">.jade</span> views/.
</code></pre>
<p>Another way to handle this is with the file and directory comparison utility called <strong>meld</strong>. It is available in Pristine Lubuntu:</p>
<pre><code><span class="hljs-attribute">meld</span> views/ <span class="hljs-variable">$ELF_TEMPLATES</span>/JadeMixins
</code></pre><p><strong>NOTE</strong>: <em>I&#39;ve never tried it, but there is some chance that <a href="http://linuxcommand.org/lc3_adv_mc.php">Midnight Commander</a> might work on Cloud9. Perhaps you can use it to do directory comparisons.</em></p>
<p>To install midnight command: <strong>sudo apt-get install mc</strong></p>
<a class="anchor" id="set-up-the-title"></a>
<h2>Set up the Title</h2>
<p>In <strong>routes/index.js</strong> create a new variable for use when Jade is rendered into HTML. You should, of course, use your own name:</p>
<pre><code class="lang-javascript">res.render(<span class="hljs-string">'index'</span>, { <span class="hljs-string">title:</span> <span class="hljs-string">'Bitly-Refine'</span>, <span class="hljs-string">author:</span> <span class="hljs-string">'John von Neumann'</span> });
</code></pre>
<p>Change the title to show the author:</p>
<pre><code>    .<span class="hljs-keyword">jumbotron.elfDiv
</span>        h1= title
        p <span class="hljs-keyword">by </span>WHAT GOES HERE?
</code></pre><a class="anchor" id="unit-tests"></a>
<h2>Unit Tests</h2>
<p>There are many unit tests in $ELF_TEMPLATES/UnitTest/BitlyRefine. Copy them all into your <strong>spec</strong> folder and make sure they all pass.</p>
<p>There are some jasmine-jquery (fixture) tests in some of the specs. For instance, look for these calls to <strong>loadFixtures</strong> or <strong>elfFixtureUtil.loadFixture</strong> in:</p>
<ul>
<li>test-jade.js</li>
<li>test-interface.js</li>
</ul>
<p>To get these specs running correctly, see the <a href="https://www.ccalvert.net/books/CloudNotes/Assignments/GruntCheck03.html">GruntCheck03</a> assignment. In particular, make sure you have run the following without error:</p>
<ul>
<li>check-karma-grunt-config</li>
<li>grunt fixture</li>
</ul>
<p>Run <strong>check-karma-grunt-config</strong> first as it helps you with the setup. Once it is all green, then run <strong>grunt fixture</strong>. Also, take a moment to look at <strong>spec/test-fixture-util.js</strong>.</p>
<a class="anchor" id="turn-it-in"></a>
<h2>Turn it in</h2>
<p>Per usual.</p>
<a class="anchor" id="all-tests"></a>
<h2>Copy All Tests</h2>
<p>Be sure that you have copied in all the tests from JsObjects. First run this command to see if there are any differences between your <strong>specs</strong> directory and the ELF_TEMPLATES BitlyRefine specs:</p>
<pre><code class="lang-bash">diff spec<span class="hljs-regexp">/ $ELF_TEMPLATES/</span>UnitTest<span class="hljs-regexp">/BitlyRefine/</span>
</code></pre>
<p>If something is wrong, you might get results like this:</p>
<pre><code class="lang-bash">diff spec/test-basic.js /home/charlie/Git/JsObjects/Utilities/Templates/UnitTest/BitlyRefine/test-basic.js
98a99,110
<span class="hljs-meta">&gt;</span><span class="bash">     it(<span class="hljs-string">'shows we can call getLinkHistoryArray'</span>, <span class="hljs-function"><span class="hljs-title">function</span></span>() {</span>
<span class="hljs-meta">&gt;</span><span class="bash">         elfBitly.getBitlyLinks();</span>
<span class="hljs-meta">&gt;</span><span class="bash">         var historyArray = elfBitly.getLinkHistoryArray();</span>
<span class="hljs-meta">&gt;</span><span class="bash">         expect(historyArray.length).toBe(50);</span>
<span class="hljs-meta">&gt;</span><span class="bash">     });</span>
<span class="hljs-meta">&gt;</span><span class="bash"> </span>
<span class="hljs-meta">&gt;</span><span class="bash">     it(<span class="hljs-string">'shows getLinkHistoryItem sets elfBitly.linkIndex'</span>, <span class="hljs-function"><span class="hljs-title">function</span></span>() {</span>
<span class="hljs-meta">&gt;</span><span class="bash">         elfBitly.getBitlyLinks();</span>
<span class="hljs-meta">&gt;</span><span class="bash">         var historyArray = elfBitly.getLinkHistoryItem(12, <span class="hljs-literal">true</span>);</span>
<span class="hljs-meta">&gt;</span><span class="bash">         expect(elfBitly.linkIndex).toBe(12);</span>
<span class="hljs-meta">&gt;</span><span class="bash">     });</span>
<span class="hljs-meta">&gt;</span><span class="bash"> </span>
118a131
<span class="hljs-meta">&gt;</span><span class="bash"> </span>
diff spec/test-files.js /home/charlie/Git/JsObjects/Utilities/Templates/UnitTest/BitlyRefine/test-files.js
0a1,4
<span class="hljs-meta">&gt;</span><span class="bash"> /**</span>
<span class="hljs-meta">&gt;</span><span class="bash">  * Created by charlie on 11/9/15.</span>
<span class="hljs-meta">&gt;</span><span class="bash">  */</span>
<span class="hljs-meta">&gt;</span><span class="bash"> </span>
Only in /home/charlie/Git/JsObjects/Utilities/Templates/UnitTest/BitlyRefine/: test-fixture-util.js
Only in /home/charlie/Git/JsObjects/Utilities/Templates/UnitTest/BitlyRefine/: test-interface.js
Only in /home/charlie/Git/JsObjects/Utilities/Templates/UnitTest/BitlyRefine/: test-jade.js
Only in spec/: test-jasmine-jquery.js
diff spec/test-local-cloud.js /home/charlie/Git/JsObjects/Utilities/Templates/UnitTest/BitlyRefine/test-local-cloud.js
0a1,4

ETC ...
</code></pre>
<p>To fix this problem, consider running this command:</p>
<pre><code class="lang-bash">cp <span class="hljs-variable">$ELF_TEMPLATES</span><span class="hljs-regexp">/UnitTest/</span>BitlyRefine<span class="hljs-regexp">/* spec/</span>
</code></pre>
<p>Now the <strong>diff</strong> command should come back clean.</p>
<a class="anchor" id="delicious-links"></a>
<h2>Delicious Links</h2>
<p>elfDelicious.deliciousLInks should be declared like this:</p>
<pre><code class="lang-javascript"><span class="hljs-string">var</span> <span class="hljs-string">elfDelicious</span> <span class="hljs-string">=</span> <span class="hljs-string">{</span>

<span class="hljs-attr">    deliciousLinks:</span> <span class="hljs-literal">null</span><span class="hljs-string">,</span>
</code></pre>
<p>It should contain the contents of the delicious-javascript-links.js file which is part, I believe, of the Week0X.DeliciousQuery project. It is also in $ELF_TEMPLATES/WebServices. Once you find it, I would put it in Week1X-HyperExplore/spec/data directory. Make sure that Karma loads it by writing something like this in the files object of karma.conf.js:</p>
<pre><code>'spec/<span class="hljs-class"><span class="hljs-keyword">data</span>/*.js'</span>
</code></pre><p>That way both it and bitly-links.js will be loaded by karma. The file&#39;s contents should be loaded automatically and assigned to elfDelicious.deliciousLinks by this code in our tests:</p>
<pre><code class="lang-javascript">beforeEach(<span class="hljs-name">function</span>() {
    spyOn($, 'ajax').and.callFake(<span class="hljs-name">function</span>(<span class="hljs-name">ajaxObject</span>) {
        ajaxObject.success(<span class="hljs-name">deliciousLinks</span>)<span class="hljs-comment">;</span>
        return {
            fail: function() {}
        }<span class="hljs-comment">;</span>
    })<span class="hljs-comment">;</span>
})<span class="hljs-comment">;</span>
</code></pre>
<a class="anchor" id="test-directories"></a>
<h2>Test Directories</h2>
<p>In <strong>$ELF_TEMPLATES/UnitTest/HyperExplorer</strong> there are two directories called <strong>data</strong> and <strong>fixtures</strong>. Your data directory should hold files like:</p>
<ul>
<li>bitly-links.js</li>
<li>delicious-javascript-links.js</li>
<li>tweets.js</li>
<li>tweets-timeline.js</li>
</ul>
<p>There is also a fixture directory. Your fixture directory should hold files like this:</p>
<ul>
<li>bitly.html</li>
<li>delicious.html</li>
<li>fixture.html</li>
<li>test-local-cloud.html</li>
<li>twitter.html</li>
</ul>
<p>To create some of the fixture code, expand the code in the files directory for <strong>karma.conf.js</strong>:</p>
<pre><code class="lang-javascript"><span class="hljs-attribute">jade</span>: {
    <span class="hljs-attribute">compile</span>: {
        <span class="hljs-attribute">options</span>: {
            <span class="hljs-attribute">pretty</span>: true,
            <span class="hljs-attribute">data</span>: {
                <span class="hljs-attribute">debug</span>: false
            }
        },
        <span class="hljs-attribute">files</span>: {
            <span class="hljs-string">'spec/fixtures/delicious.html'</span>: [<span class="hljs-string">'views/delicious.jade'</span>, <span class="hljs-string">'$ELF_TEMPLATES/JadeMixins/*.jade'</span>],
            <span class="hljs-string">'spec/fixtures/fixture.html'</span>: [<span class="hljs-string">'views/fixture.jade'</span>, <span class="hljs-string">'$ELF_TEMPLATES/JadeMixins/*.jade'</span>],
            <span class="hljs-string">'spec/fixtures/twitter.html'</span>: [<span class="hljs-string">'views/twitter.jade'</span>, <span class="hljs-string">'$ELF_TEMPLATES/JadeMixins/*.jade'</span>]

        }
    }
},
</code></pre>
</div></body></html>