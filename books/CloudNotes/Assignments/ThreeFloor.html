<!DOCTYPE html><html lang="en" dir="ltr"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width initial-scale=1.0"><title>ThreeFloor</title><link rel="shortcut icon" href="/charlie/images/favicon.png"><!-- Latest compiled and minified CSS--><link rel="stylesheet" href="/components/bootstrap/dist/css/bootstrap.min.css"><!-- Optional theme--><link rel="stylesheet" href="/components/bootstrap/dist/css/bootstrap-theme.min.css"><!-- link(href='/libs/css/BootstrapIndex.css', rel='stylesheet', type='text/css')--><link href="/css/style.css" rel="stylesheet" type="text/css"><link href="/css/highlight/googlecode.css" rel="stylesheet" type="text/css"><script src="/components/jquery/dist/jquery.js"></script><script src="/components/angular/angular.js"></script><script src="/components/angular-route/angular-route.js"></script><script src="/components/bootstrap/dist/js/bootstrap.min.js"></script><!-- script(src='/libs/scripts/elvenware.js', type='text/javascript')--><script src="/libs/scripts/Control.js"></script><!-- script(src='http://localhost:35729/livereload.js')--></head><body><div class="navbar navbar-inverse"><div class="container"><div class="navbar-header"><button type="button" data-toggle="collapse" data-target=".navbar-collapse" class="navbar-toggle"><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><a href="/" class="navbar-brand">Elvenware</a></div><div class="collapse navbar-collapse"><ul class="nav navbar-nav"><li class="active"><a href="/index.html">Home</a></li><li><a href="/about">About</a></li><li class="dropdown"><a href="#/" data-toggle="dropdown" class="dropdown-toggle">Dropdown<b class="caret"></b></a><ul class="dropdown-menu"><li class="dropdown-header">Core Code</li><li><a href="/charlie/development/index.html">Strongly Typed</a></li><li><a href="/charlie/development/web/index.html">Web & Scripts</a></li><li><a href="/charlie/development/cloud/index.shtml">Cloud</a></li><li class="divider"></li><li class="dropdown-header">OS and Tools</li><li><a href="/os/index.html">OS</a></li><li><a href="/charlie/development/database/index.html">Database</a></li><li><a href="/books/index.html">My Writing</a></li><li class="divider"></li><li class="dropdown-header">Art</li><li><a href="/charlie/Art/index.html">Poems & Photos</a></li><li><a href="/books/reading/index.html">Book Reviews</a></li><li><a href="/spirit/index.html">Spiritual</a></li><li class="divider"></li><li class="dropdown-header">Links</li><li><a href="/charlie/links.html">My Links</a></li><li><a href="http://www.github.com/charliecalvert">GitHub</a></li><li><a href="http://sourceforge.net/projects/elvenware/">Sourceforge</a></li></ul></li></ul></div><!-- /.nav-collapse--></div></div><div class="container"><figure><img alt="Elvenware" src="/charlie/images/elvenwarelogo.png"/></figure><h1>ThreeFloor</h1><h3>Table of Contents</h3><ul><!--TOC_Start--><li><a href="#overview">Overview</a></li>
<li><a href="#get-started">Get Started</a></li>
<li><a href="#add-a-floor">Add a Floor</a></li>
<li><a href="#naive-walk">Naive Walk</a></li>
<li><a href="#add-more-objects">Add More Objects</a></li>
<li><a href="#add-textures">Add Textures</a></li>
<li><a href="#turn-it-in">Turn it in</a></li><!--TOC_End--></ul><h2 id="overview">Overview</h2>
<p>This is assignment demonstrates key features of <a href="https://threejs.org/">ThreeJs</a>, a 3D library for JavaScript.</p>
<p>The repository is here: <a href="https://github.com/mrdoob/three.js">https://github.com/mrdoob/three.js</a>.</p>
<p>The bower library is here: <a href="https://libraries.io/bower/threejs">https://libraries.io/bower/threejs</a>.</p>
<h2 id="get-started">Get Started</h2>
<p>Begin by copying over the code from the <a href="">ThreeJsBasics</a> assignment:</p>
<pre>
cp -r Week04-ThreeJsBasics Week04-ThreeFloor
</pre>

<h2 id="add-a-floor">Add a Floor</h2>
<p>The following module will add a floor to our scene in our <strong>ThreeJsBasics</strong> program. Note the call to the <strong>require</strong> method called <a href="http://requirejs.org/docs/api.html#deffunc">define</a>.</p>
<pre><code>define([<span class="hljs-built_in">require</span>], <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
<span class="hljs-meta">  'use strict'</span>;

    <span class="hljs-keyword">var</span> THREE = <span class="hljs-literal">null</span>;

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Floors</span>(<span class="hljs-params">threeInit</span>) </span>{
            THREE = threeInit;
    }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">makeFloor</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-comment">// floor</span>

      <span class="hljs-keyword">var</span> geometry = <span class="hljs-keyword">new</span> THREE.PlaneGeometry(<span class="hljs-number">2000</span>, <span class="hljs-number">2000</span>, <span class="hljs-number">100</span>, <span class="hljs-number">100</span>);
      geometry.applyMatrix(<span class="hljs-keyword">new</span> THREE.Matrix4().makeRotationX(-<span class="hljs-built_in">Math</span>.PI / <span class="hljs-number">2</span>));

      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, l = geometry.vertices.length; i &lt; l; i++) {

          <span class="hljs-keyword">var</span> vertex = geometry.vertices[i];
          vertex.x += <span class="hljs-built_in">Math</span>.random() * <span class="hljs-number">20</span> - <span class="hljs-number">10</span>;
          vertex.y += <span class="hljs-built_in">Math</span>.random() * <span class="hljs-number">2</span>;
          vertex.z += <span class="hljs-built_in">Math</span>.random() * <span class="hljs-number">20</span> - <span class="hljs-number">10</span>;

      }

      <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>, l = geometry.faces.length; i &lt; l; i++) {

          <span class="hljs-keyword">var</span> face = geometry.faces[i];
          face.vertexColors[<span class="hljs-number">0</span>] = <span class="hljs-keyword">new</span> THREE.Color().setHSL(<span class="hljs-built_in">Math</span>.random() * <span class="hljs-number">0.2</span> + <span class="hljs-number">0.5</span>, <span class="hljs-number">0.75</span>, <span class="hljs-built_in">Math</span>.random() * <span class="hljs-number">0.25</span> + <span class="hljs-number">0.75</span>);
          face.vertexColors[<span class="hljs-number">1</span>] = <span class="hljs-keyword">new</span> THREE.Color().setHSL(<span class="hljs-built_in">Math</span>.random() * <span class="hljs-number">0.2</span> + <span class="hljs-number">0.5</span>, <span class="hljs-number">0.75</span>, <span class="hljs-built_in">Math</span>.random() * <span class="hljs-number">0.25</span> + <span class="hljs-number">0.75</span>);
          face.vertexColors[<span class="hljs-number">2</span>] = <span class="hljs-keyword">new</span> THREE.Color().setHSL(<span class="hljs-built_in">Math</span>.random() * <span class="hljs-number">0.2</span> + <span class="hljs-number">0.5</span>, <span class="hljs-number">0.75</span>, <span class="hljs-built_in">Math</span>.random() * <span class="hljs-number">0.25</span> + <span class="hljs-number">0.75</span>);

      }

      <span class="hljs-keyword">var</span> material = <span class="hljs-keyword">new</span> THREE.MeshBasicMaterial({
          vertexColors: THREE.VertexColors
      });

      <span class="hljs-keyword">var</span> mesh = <span class="hljs-keyword">new</span> THREE.Mesh(geometry, material);
      scene.add(mesh);
  }

    Floors.prototype.drawFloor = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">scene</span>) </span>{
            <span class="hljs-comment">// FLOOR</span>
            <span class="hljs-keyword">var</span> names = [<span class="hljs-string">'images/checkerboard.jpg'</span>, <span class="hljs-string">'images/FloorBorder256.png'</span>, <span class="hljs-string">'images/WoodenPlanks.png'</span>, <span class="hljs-string">'images/grass02.jpg'</span>, <span class="hljs-string">'images/Grass03.png'</span>];
            <span class="hljs-keyword">var</span> repeats = [<span class="hljs-number">250</span>, <span class="hljs-number">100</span>, <span class="hljs-number">100</span>, <span class="hljs-number">175</span>];
            <span class="hljs-keyword">var</span> index = <span class="hljs-number">0</span>;
            <span class="hljs-keyword">var</span> loader = <span class="hljs-keyword">new</span> THREE.TextureLoader();
            <span class="hljs-keyword">var</span> floorTexture = loader.load(names[index]);
            floorTexture.wrapS = floorTexture.wrapT = THREE.RepeatWrapping;
            floorTexture.repeat.set(repeats[index], repeats[index]);
            <span class="hljs-keyword">var</span> floorMaterial = <span class="hljs-keyword">new</span> THREE.MeshBasicMaterial({
                    map: floorTexture,
                    side: THREE.DoubleSide
            });
            <span class="hljs-keyword">var</span> floorGeometry = <span class="hljs-keyword">new</span> THREE.PlaneGeometry(<span class="hljs-number">2000</span>, <span class="hljs-number">2000</span>, <span class="hljs-number">10</span>, <span class="hljs-number">10</span>);
            <span class="hljs-keyword">var</span> floor = <span class="hljs-keyword">new</span> THREE.Mesh(floorGeometry, floorMaterial);
            floor.position.y = <span class="hljs-number">-0.5</span>;
            floor.rotation.x = <span class="hljs-built_in">Math</span>.PI / <span class="hljs-number">2</span>;
            scene.add(floor);
    };

  <span class="hljs-keyword">return</span> Floors;
});
</code></pre><p>You should save the file into your <strong>public/javascripts</strong> directory as <strong>floor.js</strong>. Then add it to <strong>main.js</strong> in the <strong>config</strong> section. More specifically, you would add it near here:</p>
<pre><code>require.config({
    <span class="hljs-string">baseUrl :</span> <span class="hljs-string">'.'</span>,
    <span class="hljs-string">paths :</span> {
        <span class="hljs-string">"jquery"</span> : <span class="hljs-string">'components/jquery/dist/jquery-2.1.1'</span>,
        <span class="hljs-string">"three"</span> : <span class="hljs-string">'javascripts/three'</span>,
        <span class="hljs-string">"control"</span> : <span class="hljs-string">'javascripts/control'</span>,
        <span class="hljs-comment">// YOUR CODE FOR LOADING floor.js GOES HERE</span>
</code></pre><p>You will need to modify the define call at the top of <strong>control.js</strong>:</p>
<pre><code class="lang-javascript">define([<span class="hljs-string">"floor"</span>], <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(Floor)</span> </span>{
    <span class="hljs-comment">// LOTS OF CODE OMITTED HERE</span>
});
</code></pre>
<p>The code passed to the define method will cause <strong>require</strong> to automatically load your <strong>floor.js</strong> file.</p>
<p>Below is the code to create and use the key method in the <strong>floor</strong> module:</p>
<pre><code>var <span class="hljs-built_in">floor</span> = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Floor</span>();
<span class="hljs-built_in">floor</span>.drawFloor(scene);
</code></pre><p>It belongs in the constructor found in <strong>control.js</strong>. Insert it into your source just after you add the cube.</p>
<p>Create a bitmap called <strong>checkerboard.jpg</strong> that is 256 X 256 pixels in size or download the one found here. We don&#39;t have rights to use this publicly at this time, but we can use it in our assignments. Put it in an <strong>images</strong> directory in the <strong>public</strong> folder:</p>
<pre>
public/images/checkerboard.jpg
</pre>

<p><img src="https://docs.google.com/uc?export=view&amp;id=0B25UTAlOfPRGVW5LOWl5SUItc3M" alt="bar"></p>
<p>At this stage you should be able to run the program and see a floor. The cube from the basics program should be partially buried in the floor, but still visibly rotating.</p>
<p><img src="https://s3.amazonaws.com/bucket01.elvenware.com/images/three-floor-01.png" alt="Three Floor Start"></p>
<h2 id="naive-walk">Naive Walk</h2>
<p>Let&#39;s add primitive support for walking through the scene. Since the camera is our eye on the scene, what we will do is move the camera to the left and right, and backward and forward. This is like moving through a room, but always having to face in the same direction, as if you were a courtier coming to visit the king.</p>
<p>First let&#39;s declare some variables in Control.js above the constructor for tracking movement and the camera position:</p>
<pre><code>    var keyMove = {
        <span class="hljs-string">moveForward :</span> <span class="hljs-literal">false</span>,
        <span class="hljs-string">moveBackward :</span> <span class="hljs-literal">false</span>,
        <span class="hljs-string">moveLeft :</span> <span class="hljs-literal">false</span>,
        <span class="hljs-string">moveRight :</span> <span class="hljs-literal">false</span>
    };

    var cameraPosition = {
        <span class="hljs-string">x :</span> <span class="hljs-number">2</span>,
        <span class="hljs-string">y :</span> <span class="hljs-number">0</span>,
        <span class="hljs-string">z :</span> <span class="hljs-number">2</span>
    }
</code></pre><p>Now we want to capture mouse events in the constructor:</p>
<pre><code><span class="hljs-built_in">document</span>.addEventListener(<span class="hljs-string">'keydown'</span>, onKeyDown, <span class="hljs-literal">false</span>);
<span class="hljs-built_in">document</span>.addEventListener(<span class="hljs-string">'keyup'</span>, onKeyUp, <span class="hljs-literal">false</span>);
</code></pre><p>This event code causes the methods called <strong>onKeyUp</strong> and <strong>onKeyDown</strong> to be called when the keys are pressed or released. Here is the <strong>onKeyDown</strong> method:</p>
<pre><code>    var onKeyDown = function(event) {

        <span class="hljs-keyword">switch</span> (event.keyCode) {

        <span class="hljs-keyword">case</span> <span class="hljs-number">38</span>: <span class="hljs-comment">// up</span>
        <span class="hljs-keyword">case</span> <span class="hljs-number">87</span>: <span class="hljs-comment">// w</span>
            keyMove.moveForward = true<span class="hljs-comment">;</span>
            <span class="hljs-keyword">break</span><span class="hljs-comment">;</span>

        <span class="hljs-keyword">case</span> <span class="hljs-number">37</span>: <span class="hljs-comment">// left</span>
        <span class="hljs-keyword">case</span> <span class="hljs-number">65</span>: <span class="hljs-comment">// a</span>
            keyMove.moveLeft = true<span class="hljs-comment">;</span>
            <span class="hljs-keyword">break</span><span class="hljs-comment">;</span>

        <span class="hljs-keyword">case</span> <span class="hljs-number">40</span>: <span class="hljs-comment">// down</span>
        <span class="hljs-keyword">case</span> <span class="hljs-number">83</span>: <span class="hljs-comment">// s</span>
            keyMove.moveBackward = true<span class="hljs-comment">;</span>
            <span class="hljs-keyword">break</span><span class="hljs-comment">;</span>

        <span class="hljs-keyword">case</span> <span class="hljs-number">39</span>: <span class="hljs-comment">// right</span>
        <span class="hljs-keyword">case</span> <span class="hljs-number">68</span>: <span class="hljs-comment">// d</span>
            keyMove.moveRight = true<span class="hljs-comment">;</span>
            <span class="hljs-keyword">break</span><span class="hljs-comment">;</span>
    }<span class="hljs-comment">;</span>
</code></pre><p>You also need to compose an <strong>onKeyUp</strong> method that looks the one shown above, but has the opposite effect. In other words, the <strong>boolean</strong> values are set to tell the app that movement to the right, left, back or forward has stopped. The method looks very, very much like the one above, with one important difference which I&#39;m sure you can guess.</p>
<p>Finally we want to change the <strong>render</strong> method to animate the camera when the key presses are detected by the code above. At the top of the render method, add a four part <strong>if block</strong> that moves the <strong>cameraPosition</strong>. I give you the first of the four parts, and you can fill in the rest:</p>
<pre><code>    <span class="hljs-meta">if</span> (keyMove.<span class="hljs-keyword">moveLeft) </span>{
        cameraPosition.x -= <span class="hljs-number">1</span><span class="hljs-comment">;</span>
    } <span class="hljs-meta">else</span> etc...
</code></pre><p>Finally, we move the camera to the new position:</p>
<pre><code><span class="hljs-selector-tag">camera</span><span class="hljs-selector-class">.position</span><span class="hljs-selector-class">.set</span>(<span class="hljs-selector-tag">cameraPosition</span><span class="hljs-selector-class">.x</span>, <span class="hljs-selector-tag">cameraPosition</span><span class="hljs-selector-class">.y</span>, <span class="hljs-selector-tag">cameraPosition</span><span class="hljs-selector-class">.z</span>);
</code></pre><p>When you are finished you should be able to &quot;jump&quot; right, left, forward and backward. You might experiment with moving smaller increments each time to make the jumps less jarring to the viewer.</p>
<p>There is much more complex code that allows us to move more smoothly through the screen, but this at least helps us get started moving around in the scene.</p>
<h2 id="add-more-objects">Add More Objects</h2>
<p>First, let&#39;s add a few more cubes to the scene. Our goal will be to create a scene that looks something like this:</p>
<p><img src="https://drive.google.com/uc?export=view&amp;id=0B25UTAlOfPRGTnFWZmhSN2tuWFk" alt="Bar"></p>
<p>When you first see the boxes in the scene, they will not have a brown wooden texture on them. Have patience, we will add them in this assignment, just not right away.</p>
<p>To get started, you could create a method called <strong>addCubes</strong>. It would begin something like this:</p>
<pre><code><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addCubes</span><span class="hljs-params">(scene, camera, wireFrame)</span> {</span>
    <span class="hljs-keyword">for</span> (var <span class="hljs-built_in">i</span> = <span class="hljs-number">0</span>; <span class="hljs-built_in">i</span> &lt; <span class="hljs-number">6</span>; <span class="hljs-built_in">i</span>++) {
       etc...
</code></pre><p>We would call this method from the constructor, rather than calling <strong>addCube</strong>. As you recall the <strong>addCube</strong> call looks like this:</p>
<pre><code>addCube(<span class="hljs-name">scene</span>, camera, wireFrame, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>)<span class="hljs-comment">;</span>
</code></pre><p>Now from inside <strong>addCubes</strong>,  you want to call <strong>addCube</strong>, but you will need to do something with the last parameters in order to make the cubes appear in different locations. In fact, you might want to call <strong>addCube</strong> more than once in your <strong>for loop</strong>. Perhaps you could hard code one of the last two parameters, and do sometihng with the other one that involved the <strong>loop variable i</strong>.</p>
<p>After you &quot;walk&quot; down the aisle between the boxes for a bit, you might see something like this:</p>
<p><img src="https://drive.google.com/uc?export=view&amp;id=0B25UTAlOfPRGN1pyc3JiMWVjUWs" alt="Bar"></p>
<p>If you look carefully you can see that there is a small space betwen each box. I&#39;m doing this mostly so that you can clearly see when one box ends and the next starts. In a final version of our game, we might not want to include that space. But for now, its useful. To create the space, just add a small value to the z location of each box. You&#39;ll probably want to pick a value well under 1.0.</p>
<h2 id="add-textures">Add Textures</h2>
<p>The scene in your program right now probably looks a bit like the one in the screen shots, but the boxes have bright colors on them rather than a nice wooden texture. To add the texture, swap out this call to [MeshNormalMaterial][normal]:</p>
<pre><code>var material = <span class="hljs-keyword">new</span> THREE.MeshNormalMaterial({
    <span class="hljs-string">color :</span> <span class="hljs-number">0x00ffff</span>,      
    <span class="hljs-string">wireframe :</span> wireFrame
});
</code></pre><p>Put this call to [MeshLabertMaterial][material] in its place:</p>
<p>```var material = new THREE.MeshLambertMaterial({
    map : THREE.ImageUtils.loadTexture(&#39;images/crate.jpg&#39;)
});</p>
<pre><code>
Here is a <span class="hljs-keyword">create</span> texture which we can <span class="hljs-keyword">use</span> <span class="hljs-keyword">in</span> <span class="hljs-keyword">class</span>, but <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> our <span class="hljs-keyword">final</span> games. <span class="hljs-keyword">Or</span> <span class="hljs-keyword">at</span> <span class="hljs-keyword">least</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">until</span> we <span class="hljs-keyword">get</span> permission <span class="hljs-keyword">to</span> <span class="hljs-keyword">use</span> it. Just <span class="hljs-keyword">right</span> click <span class="hljs-keyword">and</span> download <span class="hljs-keyword">to</span> your images folder.

![Bar](https://drive.google.com/uc?<span class="hljs-keyword">export</span>=<span class="hljs-keyword">view</span>&amp;<span class="hljs-keyword">id</span>=<span class="hljs-number">0</span>B25UTAlOfPRGdmUtMHpCSlQ4bmc)

The results <span class="hljs-keyword">in</span> your program <span class="hljs-keyword">are</span> probably <span class="hljs-keyword">less</span> <span class="hljs-keyword">than</span> satisfying, <span class="hljs-keyword">as</span> the boxes <span class="hljs-keyword">are</span> hard <span class="hljs-keyword">to</span> see. <span class="hljs-keyword">To</span> fix that, we need <span class="hljs-keyword">to</span> <span class="hljs-keyword">add</span> lights <span class="hljs-keyword">to</span> the scene.

[<span class="hljs-keyword">normal</span>]:<span class="hljs-keyword">http</span>://threejs.org/docs/#<span class="hljs-keyword">Reference</span>/Materials/MeshNormalMaterial
[material]:<span class="hljs-keyword">http</span>://threejs.org/docs/#<span class="hljs-keyword">Reference</span>/Materials/MeshLambertMaterial


## <span class="hljs-keyword">Add</span> Lights

<span class="hljs-keyword">Call</span> it <span class="hljs-keyword">from</span> your <span class="hljs-keyword">constructor</span>:
</code></pre><p>function addLights() {
    var light = new THREE.DirectionalLight(0xffffff, 1.5);
    light.position.set(1, 1, 1);
    scene.add(light);
    light = new THREE.DirectionalLight(0xffffff, 0.75);
    light.position.set(-1, -0.5, -1);
    scene.add(light);
}</p>
<pre><code>
<span class="hljs-section">## Sphere</span>

Let's add a [<span class="hljs-string">sphere</span>][<span class="hljs-symbol">sphere</span>].
</code></pre><p>function addSphere(sne, camera, wireFrame, x, y) {
    var geometry = new THREE.SphereGeometry(.5, 25, 25);
    var material = new THREE.MeshNormalMaterial({
    color: 0x00ffff,
        wireframe: wireFrame
    });</p>
<pre><code>var <span class="hljs-built_in">sphere</span> = <span class="hljs-keyword">new</span> THREE.Mesh(geometry, material);
<span class="hljs-built_in">sphere</span>.overdraw = <span class="hljs-keyword">true</span>;
<span class="hljs-built_in">sphere</span>.position.<span class="hljs-built_in">set</span>(x, <span class="hljs-number">0</span>, y);
scene.<span class="hljs-built_in">add</span>(<span class="hljs-built_in">sphere</span>);

    <span class="hljs-keyword">return</span> <span class="hljs-built_in">sphere</span>;
</code></pre><p>}</p>
<pre><code>
<span class="hljs-keyword">Call</span> the **addSphere** method just <span class="hljs-keyword">after</span> your **<span class="hljs-keyword">for</span> <span class="hljs-keyword">loop</span>**. Be sure <span class="hljs-keyword">to</span> pass <span class="hljs-keyword">in</span> the correct x <span class="hljs-keyword">and</span> y <span class="hljs-keyword">parameters</span> so the sphere appears <span class="hljs-keyword">at</span> the <span class="hljs-keyword">end</span> <span class="hljs-keyword">of</span> our aisle, <span class="hljs-keyword">as</span> shown <span class="hljs-keyword">in</span> the screen shots above.

[sphere]: <span class="hljs-keyword">http</span>://threejs.org/docs/#<span class="hljs-keyword">Reference</span>/Extras.Geometries/SphereGeometry

## Window <span class="hljs-keyword">Resize</span>

One <span class="hljs-keyword">event</span> <span class="hljs-keyword">handler</span> that <span class="hljs-keyword">I</span> should mention <span class="hljs-keyword">is</span> window <span class="hljs-keyword">resize</span>. This <span class="hljs-keyword">event</span> <span class="hljs-keyword">is</span> triggered <span class="hljs-keyword">when</span> the window <span class="hljs-keyword">is</span> resized <span class="hljs-keyword">and</span> it causes the scene <span class="hljs-keyword">to</span> be recalculated so that it fits properly inside the window.

Here <span class="hljs-keyword">is</span> how we hook the <span class="hljs-keyword">event</span>:

    window.addEventListener(<span class="hljs-string">'resize'</span>, onWindowResize, <span class="hljs-literal">false</span>);

And here is how we handle the event:
</code></pre><p>function onWindowResize() {
    camera.aspect = window.innerWidth / window.innerHeight;
    camera.updateProjectionMatrix();
    renderer.setSize(window.innerWidth, window.innerHeight);
}</p>
<pre><code>
On <span class="hljs-keyword">the</span> same general subject, you might find <span class="hljs-keyword">it</span> useful <span class="hljs-built_in">to</span> just remove all <span class="hljs-keyword">the</span> HTML (<span class="hljs-keyword">for</span> now) <span class="hljs-built_in">from</span> you index.jade. My code, <span class="hljs-keyword">at</span> <span class="hljs-keyword">any</span> rate, now looks like this:
</code></pre><p>extends layout</p>
<p>block content
```</p>
<p>As you can see, there is essentially nothing at all happening in <strong>index.jade</strong>. Our HTML body is occupied entirely by Three.Js. Later on we will see how to use CSS to lay HTML over the 3D scene.</p>
<h2 id="turn-it-in">Turn it in</h2>
<p>Add a .gitignore file to the root of your BitBucket repository. Make sure you include both <strong>.metadata</strong> and <strong>node_modules</strong> in your .gitignore file. Put your project in your BitBucket repository. Reference for .gitignore:</p>
<ul>
<li><a href="http://www.elvenware.com/charlie/development/cloud/Git.html#the-gitignore-file">http://www.elvenware.com/charlie/development/cloud/Git.html#the-gitignore-file</a></li>
</ul>
<p>Click the <strong>Send Invitation</strong> button and share your BitBucket repository with me. I&#39;m <strong>ccalvert</strong> on BitBucket.</p>
</div></body></html>