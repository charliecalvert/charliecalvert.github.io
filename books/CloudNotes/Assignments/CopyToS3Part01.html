<!DOCTYPE html>
<html dir="ltr">

<head>
	<meta charset="utf-8" />
	<title>CopyToS3Part01</title>
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="shortcut icon" href="/charlie/images/favicon.png">
	<!-- Latest compiled and minified CSS -->
	<link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap.min.css">
	<!-- Optional theme -->
	<link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap-theme.min.css">
	<link href="/charlie/libs/css/BootstrapIndex.css" rel="stylesheet" type="text/css" />
	<!-- Latest compiled and minified JavaScript - Move to bottom of body element -->
	<script src="//code.jquery.com/jquery.js"></script>
	<script src="//netdna.bootstrapcdn.com/bootstrap/3.0.0/js/bootstrap.min.js"></script>
	<script src="/charlie/libs/scripts/elvenware.js" type="text/javascript"></script>
	<script type="text/javascript">
		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-2806409-2']);
		_gaq.push(['_trackPageview']);
		(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
	</script>
</head>

<body>



	<!-- removed  navbar-fixed-top -->
	<div class="navbar navbar-inverse">
		<div class="container">
			<div class="navbar-header">
				<button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
					<span class="icon-bar"> </span>
					<span class="icon-bar"> </span>
					<span class="icon-bar"> </span>
				</button>
				<a class="navbar-brand" href="/charlie/index.html">Elvenware</a>
			</div>
			<div class="collapse navbar-collapse">
				<ul class="nav navbar-nav">
					<li class="active"><a href="/charlie/index.html">Home</a></li>
					<li><a href="/charlie/contents.html">About</a></li>
					<li class="dropdown">
						<a href="#" class="dropdown-toggle" data-toggle="dropdown">Dropdown <b class="caret"></b></a>
						<ul class="dropdown-menu">
							<li class="dropdown-header">Core Code</li>
							<li><a href="/charlie/development/index.html">Strongly Typed</a></li>
							<li><a href="/charlie/development/web/index.html">Web &amp; Scripts</a></li>
							<li><a href="/charlie/development/cloud/index.shtml">Cloud</a></li>
							<li class="divider"></li>
							<li class="dropdown-header">OS and Tools</li>
							<li><a href="/charlie/os/index.html">OS</a></li>
							<li><a href="/charlie/development/database/index.html">Database</a></li>
							<li><a href="/charlie/books/index.html">My Writing</a></li>
							<li class="divider"></li>
							<li class="dropdown-header">Art</li>
							<li><a href="/charlie/Art/index.html">Poems &amp; Photos</a></li>
							<li><a href="/charlie/books/reading/index.html">Book Reviews</a></li>
							<li><a href="/charlie/spirit/index.html">Spiritual</a></li>
							<li class="divider"></li>
							<li class="dropdown-header">Links</li>
							<li><a href="/charlie/links.html">My Links</a></li>
							<li><a href="http://www.github.com/charliecalvert">GitHub</a></li>
							<li><a href="http://sourceforge.net/projects/elvenware/">Sourceforge</a></li>
						</ul>
					</li>
				</ul>
			</div><!--/.nav-collapse -->
		</div>
	</div>

	<div class="container">

		<div class="starter-template">
			<figure><img alt="Elvenware" src="/charlie/images/elvenwarelogo.png" /></figure>
<h2>Table of Contents</h2>
<ul class="elfTocHeading">
	<li><a href='#copy-to-s3-part-01'>Copy to S3 Part 01</a></li>
	<li><a href='#set-up-config-file'>Set up config file</a></li>
	<li><a href='#set-up'>Set Up</a></li>
	<li><a href='#set-up-lamp'>Set Up Lamp</a></li>
	<li><a href='#config.json'>Config.json</a></li>
	<li><a href='#set-up-the-static-site'>Set up the Static Site</a></li>
	<li><a href='#templates'>Templates</a></li>
	<li><a href='#copying-files-on-linux'>Copying Files on Linux</a></li>
	<li><a href='#caveats-and-limitations'>Caveats and Limitations</a></li>
	<li><a href='#turn-it-in'>Turn it In</a></li>
	<li><a href='#the-deploy-feature'>The Deploy Feature</a></li>
	<li><a href='#additional-notes'>Additional Notes</a></li>
</ul>
<h1 id="copy-to-s3-part-01">Copy to S3 Part 01</h1>
<p>This assignment helps you get up to speed with AwsBasicS3. This program aids content creators who produce a lot of HTML files.</p>
<p>To get started is to watch the now outdated intro video:</p>
<ul>
<li><a href="http://youtu.be/EF0kHY8mYXg">AwsBasic Intro</a></li>
</ul>
<iframe width="640" height="360" src="//www.youtube.com/embed/EF0kHY8mYXg?list=UUPcZjdLfAkdauW2fJzz1Mcw" frameborder="0" allowfullscreen></iframe>

<p>Since the video, I've integrated <strong>BuildAll.py</strong> into the project. It is now called <strong>MarkdownTransform.py</strong>, and you should never have to open it. Instead, you edit the contents of the <strong>MarkdownTransformConfig.json</strong> file. The process is the same as that described in the video, but you are now transforming markdown files into HTML, and in the process copying them from one folder to another. This is the same thing that <strong>BuildAll.py</strong> did, only now the file hopefully has a better name and is easier to use.</p>
<h2 id="set-up-config-file">Set up config file</h2>
<pre><code>{ &quot;accessKeyId&quot;: &quot;YOUR KEY HERE&quot;, &quot;secretAccessKey&quot;: &quot;YOUR KEY HERE&quot;, &quot;region&quot;: &quot;us-east-1&quot; }</code></pre>
<p>if you are using us-east-1 then your bucket should be created in US STANDARD. I know that works. If you want to try creating a bucket in Oregon then set it to us-west-2.</p>
<h2 id="set-up">Set Up</h2>
<p>You need to be sure you have the environmonent variables JSOBJECTS and PYTHON path set up correctly. I have the following at the bottom of my .bashrc file:</p>
<pre><code>export JSOBJECTS=$HOME/Git/JsObjects
export PYTHONPATH=${PYTHONPATH}:$JSOBJECTS/Python/:$JSOBJECTS/Python/Utils/:$JSOBJECTS/Python/RegEx/:</code></pre>
<p>You may need to tweak the first of these two lines slightly to fit the set up on your system.</p>
<ul>
<li><a href="http://youtu.be/v4DFrhBHuCU">See the video</a></li>
</ul>
<p>After making the video I removed the final slash from JSOBJECTS environment variable.</p>
<p>On Windows I set up my enviornment variables with this batch file that I call <strong>SetEnvionmentVariables.bat:</strong></p>
<pre><code>@ECHO OFF

ECHO =========================
SetX GITHUB %USERPROFILE%\Documents\GitHub
REM Setx GITHUB C:\Src\Git
SetX JSOBJECTS %GITHUB%\JsObjects

set BASE=%JSOBJECTS%\Python
SetX PYTHONPATH %BASE%;%BASE%\Utils;%BASE%\RegEx;%BASE%
ECHO =========================
ECHO GITHUB = %GITHUB%
ECHO JSOBJECTS = %JSOBJECTS%
ECHO PYTHONPATH = %PYTHONPATH%
ECHO =========================
ECHO You will need to restart this command window 
ECHO before these variables take effect.
ECHO =========================</code></pre>
<p>I maintain <strong>SetEnvironmentVariables</strong> in <a href="https://github.com/charliecalvert/JsObjects/blob/master/Utilities/InstallScripts/SetEnvironmentVariables.bat">JsObjects</a>.</p>
<h2 id="set-up-lamp">Set Up Lamp</h2>
<p>LAMP = Linux, Apache, MySql and Python/Php/Perl</p>
<ul>
<li><p><a href="http://www.elvenware.com/charlie/development/database/mysql/MySql.html#installOnLinux">Go here</a></p>
<p>sudo apt-get install tasksel sudo tasksel install lamp-server</p></li>
</ul>
<h2 id="config.json">Config.json</h2>
<p>You need to get the access keys from the <a href="https://console.aws.amazon.com/iam/home?#security_credential">AWS security page</a> and put them in <strong>config.json</strong>:</p>
<pre><code>{ &quot;accessKeyId&quot;: &quot;ACCESS KEY HERE&quot;, &quot;secretAccessKey&quot;: &quot;SECRET KEY HERE&quot;, &quot;region&quot;: &quot;us-east-1&quot; }</code></pre>
<p>You need to replace the strings <strong>ACCESS KEY HERE</strong> and <strong>SECRET KEY HERE</strong> with your access and secret keys from AWS.</p>
<p>Your access key will look like this: <strong>AKIAIOSFODNN7EXAMPLE</strong></p>
<p>Your secret key will look like this: <strong>wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY</strong></p>
<p>More information is available in the <a href="http://docs.aws.amazon.com/general/latest/gr/aws-sec-cred-types.html">AWS security credential docs</a>:</p>
<h2 id="set-up-the-static-site">Set up the Static Site</h2>
<p>The files you need are here:</p>
<ul>
<li>JsObjects JavaScript NodeCode StaticSite</li>
</ul>
<h2 id="templates">Templates</h2>
<ul>
<li>The html pieces (start, nav, etc)</li>
<li><p>The bootstrap files and elvenware log</p></li>
<li>JsObjects Utilities Templates</li>
<li><p>You need the Images, Styles and Scripts folders.</p></li>
</ul>
<h2 id="copying-files-on-linux">Copying Files on Linux</h2>
<p>This programs works with two sites:</p>
<ul>
<li>A staging site.</li>
<li>The release site on S3</li>
</ul>
<p>On Linux, I typically use <strong>/var/www/bc</strong> as my staging site. Then I access it by typing the following in the address bar of my browser:</p>
<pre><code>http://localhost/bc</code></pre>
<p>For security reasons, by default, you do not have rights to write to <strong>/var/www/bc</strong>. Since we talking about a staging site, and not a release site, there is usually little reason to be overly concerned about security. As a result, I simply give myself full rights to copy files to the site:</p>
<pre><code>sudo chown charlie:charlie /var/www/bc</code></pre>
<p>This is a more flexible way to say the same thing:</p>
<pre><code>sudo chown $USER:$USER /var/www/bc</code></pre>
<p>Before running <strong>chown</strong> we can use the list (ls) command to see that <strong>/var/www/bc</strong> is owned by root:</p>
<pre><code>charlie@mongovbox:~$ ls -l /var/www/
total 12
drwxr-xr-x  5 root    root    4096 Mar 10 14:39 bc
-rw-r--r--  1 root    root     177 Feb 14 23:10 index.html</code></pre>
<p>Next we run <strong>chown</strong> and check the results with the list command:</p>
<pre><code>charlie@mongovbox:~$ sudo chown $USER:$USER /var/www/bc
charlie@mongovbox:~$ ls -l /var/www/
total 12
drwxr-xr-x 5 charlie charlie 4096 Mar 10 14:39 bc
-rw-r--r-- 1 root    root     177 Feb 14 23:10 index.html</code></pre>
<h2 id="caveats-and-limitations">Caveats and Limitations</h2>
<p>This program can only copy folders one level deep. This means you can create a structure like this on S3:</p>
<pre><code>/foo.mybuckter.com/Folder01/SubFolder01
.........................../SubFolder02
.........................../SubFolder03
..etc</code></pre>
<p>You cannot, however, create a structure like this:</p>
<pre><code>/foo.mybuckter.com/Folder01/Folder02/Folder03</code></pre>
<p>It is, of course, possible, to create a bucket that looks like this, but you will have to run the program multiple times to do it:</p>
<pre><code>/foo.mybuckter.com/Folder01/SubFolder02
.........................../SubFolder02
/foo.mybuckter.com/Folder02/SubFolder01
.........................../SubFolder02
/foo.mybuckter.com/Folder03/SubFolder01
etc</code></pre>
<p>Since there is a command line version of this program, it will (at least eventually) be possible to automate as single command the act of copying multiple sets of folders to S3, as in the case above.</p>
<p>The folder that you are copying from your local drive to S3 should have this structure:</p>
<pre><code>Folder01/SubFolder02
......../SubFolder02
etc</code></pre>
<p>It cannot have this structure:</p>
<pre><code>Folder01/SubFolder02/SubFolder03</code></pre>
<p>Yes, this is a limitation. It is one that can be fixed, but I'm not going to fix it today. And frankly, web sites that go over three folders deep are hard to maintain, and hard to navigate, so there is a bright side to this limitation.</p>
<h2 id="turn-it-in">Turn it In</h2>
<p>In this assignment, all you need to do is get the program up and running. This means:</p>
<ul>
<li>Edit five documents (Shekespeare Sonnets 1-5 would do) in StackEdit and link them to DropBox and/or Google Drive</li>
<li>Send a screen shot of the StackEdit folder on the navigation bar showing that you five documents are linked to Google Drive and/or DropBox</li>
</ul>
<p>In this screen shot, you can see that <strong>CopyToS3Part01.md</strong> is saved to Google Drive and <strong>Week05.md</strong> is saved to Google Drive. Another file is saved to both GoogleDrive and DropBox, and has a link back to GitHub:</p>
<figure>
<img src="http://www.elvenware.com/charlie/books/CloudNotes/Images/AwsBasicS301.png" alt="Drive" /><figcaption>Drive</figcaption>
</figure>
<p>Also include:</p>
<ul>
<li>A screen shot of your files on S3.</li>
<li>A link to your files on S3</li>
<li>A screen shot of <strong>AwsBasicS3</strong> running in your browser</li>
<li>A screen shot of the command line output <strong>AwsBasicS3</strong> creates when you send files to S3.</li>
<li>Your copies of <strong>MarkdownTransformConfig.json</strong> and <strong>Options.json</strong></li>
</ul>
<h2 id="the-deploy-feature">The Deploy Feature</h2>
<p>This program is developed in <strong>JsObjects</strong>, and that repository gets updated fairly frequently. This means that your copies of <strong>MarkdownTransformConfig.json</strong> and <strong>Options.json</strong> can get overwritten when you perform a <strong>git pull</strong> on <strong>JsObjects</strong>. It is also possible that I will break the code when updating it.</p>
<p>As a result, I have created a way that you can <em>deploy</em> the application to another place on your drive. To get started, be sure you have installed <strong>grunt-cli</strong> with this command:</p>
<pre><code>sudo npm install -g grunt-cli</code></pre>
<p>On Windows you should not include <strong>sudo</strong>.</p>
<p>Now go to the root folder of the <strong>AwsBasicS3 project</strong> and type:</p>
<pre><code>grunt deploy</code></pre>
<p>This should create a filder called <strong>Deploy</strong> in the root of the project. It should contain all the files you need to run the program. Copy it to well known location and run <strong>npm install</strong>. Now you can run <strong>AwsBasicS3</strong> without concerns about updating <strong>JsObjects</strong>. When upgrades to <strong>AwsBasicS3</strong> occur, I would suggest running <strong>grunt deploy</strong> again and copying the new <strong>Deploy</strong> folder to a second location, so that you don't overwrite your working copy. When you are convinced that the new copy works, then you can save your config files if necessary and delete your older copy of the program.</p>
<h2 id="additional-notes">Additional Notes</h2>
<p>The AwsBasicS3 program uses node. You typically start it like this:</p>
<pre><code>node app.js</code></pre>
<p>Then open this address in your browser:</p>
<ul>
<li><a href="http://localhost:30025/">http://localhost:30025/</a></li>
</ul>
<p>Of course, this won't work unless node is properly installed. If node is properly installed you should be able to type the following:</p>
<pre><code>node --version</code></pre>
<p>And see a response similar to this.</p>
<pre><code>v0.10.26</code></pre>
<p>If you have not yet installed node on Linux, follow these instructions:</p>
<ul>
<li><a href="http://www.elvenware.com/charlie/development/web/JavaScript/NodeJs.html#node">Install Node on Linux</a></li>
</ul>
<p>You will find this code, which you must right click and copy, line by line, into the Linux command prompt:</p>
<pre><code>sudo apt-get install python-software-properties python g++ make
sudo add-apt-repository ppa:chris-lea/node.js
sudo apt-get update
sudo apt-get install nodejs</code></pre>
<p>Now pull the latest content from JsObjects:</p>
<pre><code>git pull</code></pre>
<p>And finally, navigate to the AwsBasicS3 directory, type npm install, and then type <strong>node app.js</strong>. Now open your browser and navigate to: <a href="http://localhost:30025">http://localhost:30025</a>.</p>
<p>The adventuresome could also play with the command line version:</p>
<pre><code>charlie@bcuservb:~/Git/JsObjects/JavaScript/NodeCode/AwsBasicS3$ node Server.js 
-l listBuckets
-u walkDirs</code></pre>
<blockquote>
<p>Written with <a href="https://stackedit.io/">StackEdit</a>.</p>
</blockquote>
<!-- FOOTER -->
      <footer>
        <p class="pull-right"><a href="#">Back to top</a></p>        
		<p>Copyright &copy; <a href="/charlie/index.html">Charlie Calvert</a> |
		<a href="/charlie/contents.html">Site Overview</a> |
		<a href="/charlie/development/index.html">Writing Code</a> |
		<a href="/charlie/development/web/index.html">Web</a> |
		<a href="/charlie/development/web/JavaScript/index.html">JavaScript</a> |
		<a href="/charlie/books/index.html">My Books</a> </p>

      </footer>

    </div><!-- /.container -->
</body>
</html>



