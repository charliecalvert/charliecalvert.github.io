<!DOCTYPE html><html lang="en" dir="ltr"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width initial-scale=1.0"><title>ExpressRoutesSolarTests</title><link rel="shortcut icon" href="/charlie/images/favicon.png"><!-- Latest compiled and minified CSS--><link rel="stylesheet" href="/components/bootstrap/dist/css/bootstrap.min.css"><!-- Optional theme--><link rel="stylesheet" href="/components/bootstrap/dist/css/bootstrap-theme.min.css"><!-- link(href='/libs/css/BootstrapIndex.css', rel='stylesheet', type='text/css')--><link href="/css/style.css" rel="stylesheet" type="text/css"><link href="/css/highlight/googlecode.css" rel="stylesheet" type="text/css"><script src="/components/jquery/dist/jquery.js"></script><script src="/components/angular/angular.js"></script><script src="/components/angular-route/angular-route.js"></script><script src="/components/bootstrap/dist/js/bootstrap.min.js"></script><!-- script(src='/libs/scripts/elvenware.js', type='text/javascript')--><!-- script(src="/libs/scripts/Control.js")--><!-- script(src='http://localhost:35729/livereload.js')--></head><body><div class="navbar navbar-inverse"><div class="container"><div class="navbar-header"><button type="button" data-toggle="collapse" data-target=".navbar-collapse" class="navbar-toggle"><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><a href="/" class="navbar-brand">Elvenware</a></div><div class="collapse navbar-collapse"><ul class="nav navbar-nav"><li class="active"><a href="/index.html">Home</a></li><li><a href="/about">About</a></li><li class="dropdown"><a href="#/" data-toggle="dropdown" class="dropdown-toggle">Dropdown<b class="caret"></b></a><ul class="dropdown-menu"><li class="dropdown-header">Core Code</li><li><a href="/development/index.html">Strongly Typed</a></li><li><a href="/development/web/index.html">Web & Scripts</a></li><li><a href="/development/cloud/index.shtml">Cloud</a></li><li class="divider"></li><li class="dropdown-header">OS and Tools</li><li><a href="/os/index.html">OS</a></li><li><a href="/development/database/index.html">Database</a></li><li><a href="/books/index.html">My Writing</a></li><li class="divider"></li><li class="dropdown-header">Art</li><li><a href="/charlie/Art/index.html">Poems & Photos</a></li><li><a href="/books/reading/index.html">Book Reviews</a></li><li><a href="/spirit/index.html">Spiritual</a></li><li class="divider"></li><li class="dropdown-header">Links</li><li><a href="/charlie/links.html">My Links</a></li><li><a href="http://www.github.com/charliecalvert">GitHub</a></li><li><a href="http://sourceforge.net/projects/elvenware/">Sourceforge</a></li></ul></li></ul></div><!-- /.nav-collapse--></div></div><div class="container"><figure><img alt="Elvenware" src="/charlie/images/elvenwarelogo.png"/></figure><h1>ExpressRoutesSolarTests</h1><h3>Table of Contents</h3><ul><!--TOC_Start--><li><a href="#branches">Branches</a></li>
<li><a href="#git-branch">Git Branch</a></li>
<li><a href="#week-06-branch">Week 06 Branch</a></li>
<li><a href="#merge-week06-into-master">Merge Week06 into Master</a></li>
<li><a href="#get-started">Get Started</a></li>
<li><a href="#test">Test</a></li>
<li><a href="#turn-it-in">Turn it in</a></li><!--TOC_End--></ul><h2 id="branches">Branches</h2>
<h2 id="git-branch">Git Branch</h2>
<p>Create a new branch and check it out:</p>
<pre>
git branch week05
git checkout week05
</pre>

<p>Modify the readme:</p>
<p>  geany README.md &amp;</p>
<p>We should add text like this:</p>
<pre>
  ## Week 05 Branch

  - [Angular Solar Starter Assignment][solar-start]

  [solar-start]: http://www.ccalvert.net/books/CloudNotes/Assignments/AngularSolarStarter.html
</pre>

<p>Now check it in and bush it on the new branch and then push that branch to your BitBucket or GitHub repository:</p>
<pre>
git status
git add README.md
git commit -m "Week05 Read me"
git push --set-upstream origin week05
</pre>

<p><strong>NOTE</strong>: <em>Your branch in the cloud is the <strong>origin</strong> in our case. When we talk about the origin, we are referring to our repository on BitBucket or GitHub. The origin doesn&#39;t have to be in the cloud or on those sites, but it is in our case.</em></p>
<p>Take a look at the new branch&#39;s metadata:</p>
<pre>
git branch -a
</pre>

<p>Now switch back to master and merge in your changes:</p>
<pre>
git checkout master
git merge week05
</pre>

<p>It might looks something like this as we merge the <strong>week05</strong> README with the <strong>master</strong> README:</p>
<pre>
git merge week05
Updating d0aee52..7ae1b47
Fast-forward
README.md | 9 +++++++++
1 file changed, 9 insertions(+)
</pre>

<h2 id="week-06-branch">Week 06 Branch</h2>
<p>Now create a week06 branch and modify the readme as we did in week05:</p>
<pre>
git branch week06
git checkout week06
geany README.md &
</pre>

<p>The changes might look like this:</p>
<pre>
  ## Week 06 Branch

  - [Angular Solar Starter Tests Assignment][solar-start-test]
</pre>

<p>Check the status:</p>
<pre>
git status
git branch -a
</pre>

<p>Add in your changes, commit and push your new branch to the cloud (BitBucket/GitHub):</p>
<pre>
git add .
git commit -m "Week06 Readme"
git push --set-upstream origin week06
</pre>

<h2 id="merge-week06-into-master">Merge Week06 into Master</h2>
<p>Now we merge in our changes to the master branch:</p>
<pre>
git checkout master
git merge week06
</pre>

<p><strong>NOTE</strong>: <em>We don&#39;t necessarily have to merge our changes back into master every day. You should merge them, however, before we go on to week 07. The point being that master ends up contains our latest while our branches show our status at the end of each week. This is not the only thing you can do with branches, nor is it even a common strategy, but it fits our goals in this class. In other words, its nice in this class to have a handy record of where we are at the end of each week. But other teams would do very different things with branches. One of our goals, of course, is simply to be sure we understand how to use git branches. The exact way we use them is not important.</em></p>
<p>Now check the status, and go back to <strong>week06</strong> where we will do our work this week:</p>
<pre>
git branch -a
git checkout week06
</pre>

<p>Like this:</p>
<pre>
$ git branch -a
  a
  master
  week05
* week06
  remotes/origin/HEAD -> origin/master
  remotes/origin/master
</pre>

<h2 id="get-started">Get Started</h2>
<p>Get our jasmine server side configuration file from the Get Numbers project:</p>
<pre>
cp GetNumbers spec/support/jasmine.json
</pre>

<p>Copy jasmine-runner to the root of our project:</p>
<pre>
cp GetNumbers/jasmine-runner.js .
</pre>

<p>Change so that we skip files that begin with <strong>test</strong> and get only those that begin with <strong>spec</strong>:</p>
<pre><code class="lang-javascript">{
  "<span class="hljs-attr">spec_dir</span>": <span class="hljs-string">"spec"</span>,
  "<span class="hljs-attr">spec_files</span>": [
    <span class="hljs-string">"spec-*.js"</span>
  ]
}
</code></pre>
<p>Add a script for running our test to <strong>package.json</strong>. Here I quote several lines to provide context, but you only need to add the line that starts with <strong>test-server</strong>:</p>
<pre><code class="lang-javascript"><span class="hljs-string">"private"</span>: <span class="hljs-literal">true</span>,
<span class="hljs-string">"scripts"</span>: {
  <span class="hljs-string">"test"</span>: <span class="hljs-string">"karma start"</span>,
  <span class="hljs-string">"test-server"</span>: <span class="hljs-string">"node jasmine-runner.js"</span>,
  <span class="hljs-string">"start"</span>: <span class="hljs-string">"nodemon ./bin/www"</span>
},
<span class="hljs-string">"dependencies"</span>: {
</code></pre>
<p>We use the new script with the npm <strong>run</strong> command, something like this, where you execute the code on the first line:</p>
<pre>
$ npm run test-server

> Week05-ExpressRoutesSolar@0.0.0 test-server /home/charlie/Git/prog272-calvert-2016/Week05-ExpressRoutesSolar
> node jasmine-runner.js

Spec started

  Elvenware Simple Plain Suite
    âœ“ shows we can test

Executed 1 of 1 spec SUCCESS in 0.006 sec.
</pre>

<p>Now you add in the <a href="https://github.com/visionmedia/supertest"><strong>supertest</strong></a> package. This package will allow us to test our routes from the command line:</p>
<p>  npm install supertest --save-dev  </p>
<h2 id="test">Test</h2>
<p>This code simply tests that we can call a route, and that the call succeeds. We learn only that the route exists, and that it does not raise an error:</p>
<pre><code class="lang-javascript">var request = require('supertest')<span class="hljs-comment">;</span>
var app = require('../app')<span class="hljs-comment">;</span>

describe('Elvenware Simple Plain Suite', function () {
    it('shows we can test', function () {
        expect(<span class="hljs-name">true</span>).toBe(<span class="hljs-name">true</span>)<span class="hljs-comment">;</span>
    })<span class="hljs-comment">;</span>


    it('renewables', function (<span class="hljs-name">done</span>) {
        request(<span class="hljs-name">app</span>)
            .get('/renewables')
            .expect(<span class="hljs-number">200</span>)
            .expect('Content-Type', /json/)
            .end(<span class="hljs-name">function</span> (<span class="hljs-name">err</span>, res) {
                if (<span class="hljs-name">err</span>) throw err<span class="hljs-comment">;</span>
                done()<span class="hljs-comment">;</span>
            })<span class="hljs-comment">;</span>
    })<span class="hljs-comment">;</span>

})<span class="hljs-comment">;</span>
</code></pre>
<p>This test actually examines the result of making a call so we can see if the route sends the correct content:</p>
<pre><code class="lang-javascript">fit('renewables first object body', function (<span class="hljs-name">done</span>) {
    request(<span class="hljs-name">app</span>)
        .get('/renewables')
        .expect(<span class="hljs-number">200</span>)
        .expect('Content-Type', /json/)
        .expect(<span class="hljs-name">function</span>(<span class="hljs-name">response</span>) {
            expect(<span class="hljs-name">response</span>.body.result).toBe('Success')<span class="hljs-comment">;</span>
            console.log(<span class="hljs-name">response</span>.body.renewables)<span class="hljs-comment">;</span>
            expect(<span class="hljs-name">response</span>.body.renewables[<span class="hljs-number">0</span>].Year).toBe('<span class="hljs-number">2017</span>')<span class="hljs-comment">;</span>
        })
        .end(<span class="hljs-name">function</span> (<span class="hljs-name">err</span>, res) {
            if (<span class="hljs-name">err</span>) throw err<span class="hljs-comment">;</span>
            done()<span class="hljs-comment">;</span>
        })<span class="hljs-comment">;</span>
})<span class="hljs-comment">;</span>
</code></pre>
<h2 id="turn-it-in">Turn it in</h2>
<p>The usual...</p>
</div></body></html>