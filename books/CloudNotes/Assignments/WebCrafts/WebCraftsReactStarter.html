<!DOCTYPE html><html lang="en" dir="ltr"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width initial-scale=1.0"><title>WebCraftsReactStarter</title><link href="/css/first-style.css" rel="stylesheet"><link rel="shortcut icon" href="/images/favicon.png"><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet"><link href="/css/highlight/googlecode.css" rel="stylesheet" type="text/css"><link href="/css/style.css" rel="stylesheet"><script src="https://code.jquery.com/jquery-1.12.0.min.js"></script><script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<!-- Latest compiled and minified CSS --><script src="/js/elven-help.js"></script></head><body><nav class="navbar navbar-inverse"><div class="container"><div class="navbar-header"><button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><a class="navbar-brand" href="/">Elvenware</a></div><div class="navbar-collapse collapse" id="navbar"><ul class="nav navbar-nav"><li class="trigger-collapse" ng-class="{ active: isActive('/')}"><a href="/">Home</a></li><li><a href="/about.html">About</a></li></ul></div></div></nav><div class="container"><figure><img class="elf-normal" alt="Elvenware" src="/images/elvenwarelogo.png"/></figure><h1>WebCraftsReactStarter</h1><p>Welcome to WebCraftsReactStarter</p><ul><!--TOC_Start--><li><a href="#overview">Overview</a></li>
<li><a href="#branch">Branch</a></li>
<li><a href="#webpack">WebPack</a></li>
<li><a href="#npm-err-">npm ERR!</a></li>
<li><a href="#get-sample-components">Get Sample Components</a></li>
<li><a href="#react-main">Create our Main React file</a></li>
<li><a href="#link-it-together">Link it Together</a></li><!--TOC_End--></ul></div><div class="container"><a class="anchor" id="overview"></a>
<h2>Overview</h2>
<p>The goal of this assignment is to begin the process of integrating React into our WebCrafts application. Your key reference will be the <a href="http://www.ccalvert.net/books/CloudNotes/Assignments/React/ReactBasics.html">ReactBasics</a> assignment.</p>
<a class="anchor" id="branch"></a>
<h2>Branch</h2>
<p>We will do our work on <strong>Week05-React</strong>. Once we have things in good shape, we can merge that code back into <strong>master</strong>. For the assignment, I will look at <strong>master</strong> unless you specify otherwise, but I expect <strong>Week05-React</strong> to exist.</p>
<p>Here are the steps to create and switch to our working branch. Enter the following from anywhere in the WebCrafts repository:</p>
<pre><code><span class="hljs-symbol">git</span> <span class="hljs-keyword">branch </span>Week05-React
<span class="hljs-symbol">git</span> checkout Week05-React
</code></pre><a class="anchor" id="webpack"></a>
<h2>WebPack</h2>
<p>The first step will be to integrate webpack into the WebCrafts project. From the root of the WebCrafts repository:</p>
<pre><code>cp &lt;PATH <span class="hljs-keyword">TO</span> YOUR REACT BASICS PROJECT&gt;<span class="hljs-comment">//webpack.config.js .</span>
</code></pre><p>For example:</p>
<pre><code>cp ~/Git/isit320-calvert-<span class="hljs-number">2017</span>/Week01-ReactBasics/webpack<span class="hljs-selector-class">.config</span><span class="hljs-selector-class">.js</span> .
</code></pre><p>For now, we will leave it unchanged. We will, however, need to install:</p>
<ul>
<li>babel-loader</li>
<li>babel-core</li>
<li>babel-preset-react</li>
<li>babel-preset-env</li>
<li>webpack-dev-server</li>
</ul>
<p>The details are <a href="http://www.ccalvert.net/books/CloudNotes/Assignments/React/ReactBasics.html#create">here</a>.</p>
<a class="anchor" id="npm-err-"></a>
<h2>npm ERR!</h2>
<p>If you get this error:</p>
<pre><code><span class="hljs-built_in">npm</span> ERR! Cannot read property <span class="hljs-string">'0'</span> <span class="hljs-keyword">of</span> <span class="hljs-literal">undefined</span>
</code></pre><p>Upgrade to latest npm:</p>
<pre><code><span class="hljs-built_in">npm</span> -g install <span class="hljs-built_in">npm</span>
</code></pre><p>After the install, my version looked like this:</p>
<pre><code>$ npm --version
<span class="hljs-number">5.5</span><span class="hljs-number">.1</span>
</code></pre><p>Delete <strong>node_modules</strong> and <strong>package-lock.json</strong>.</p>
<p>Make sure npm is the one in your <strong>~/npm</strong> directory:</p>
<pre><code>$ which <span class="hljs-built_in">npm</span>
/home/charlie/<span class="hljs-built_in">npm</span>/bin/<span class="hljs-built_in">npm</span>
</code></pre><p>If you are using the one in /usr/bin/npm delete it create a symbolic link to the one in your <strong>npm</strong> directory. It might be something like this:</p>
<pre><code>sudo rm /usr/bin/<span class="hljs-built_in">npm</span>
sudo ln -s ~/<span class="hljs-built_in">npm</span>/bin/<span class="hljs-built_in">npm</span> .
</code></pre><a class="anchor" id="get-sample-components"></a>
<h2>Get Sample Components</h2>
<p>Let&#39;s now copy over our sample component and give it the name <strong>ReactHome.js</strong>:</p>
<pre><code>mkdir src
cp ~<span class="hljs-regexp">/Git/i</span>sit320-calvert-<span class="hljs-number">2017</span><span class="hljs-regexp">/Week01-ReactBasics/</span>react-simple.js src<span class="hljs-regexp">/ReactHome.js</span>
</code></pre><p>Change the name of the component to match our new naming scheme:</p>
<pre><code class="lang-javascript">export <span class="hljs-keyword">default</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ReactHome</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">Component</span> </span>{...}
</code></pre>
<a class="anchor" id="react-main"></a>
<h2>Create our Main React file</h2>
<p>This code belongs in a file called <strong>src/react-main</strong>:</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">import</span> React <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;
<span class="hljs-keyword">import</span> ReactDOM <span class="hljs-keyword">from</span> <span class="hljs-string">'react-dom'</span>;
<span class="hljs-keyword">import</span> ReactHome <span class="hljs-keyword">from</span> <span class="hljs-string">'./ReactHome'</span>;

$(<span class="hljs-built_in">document</span>).ready(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">const</span> home = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'home'</span>);
    ReactDOM.render(<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ReactHome</span>/&gt;</span></span>, home);
});
</code></pre>
<p><strong>NOTE</strong>: <em>We the file called <strong>ReactHome</strong> gets its name and casing from the fact that it contains a component called <strong>ReactHome</strong>. The <strong>react-main</strong> file does not export a component, so we do not put its name in Pascal case.</em></p>
<a class="anchor" id="link-it-together"></a>
<h2>Link it Together</h2>
<p>Now we need perform the standard dance we have done several times already. In <strong>webpack.config.js</strong> point our <strong>entry-point</strong> at <strong>react-main.js</strong> file:</p>
<pre><code class="lang-javascript"><span class="hljs-string">entry:</span> <span class="hljs-string">'./src/react-main.js'</span>,
</code></pre>
<p>Put a script in <strong>package.json</strong> for building the webpack bundle:</p>
<pre><code class="lang-javascript"><span class="hljs-string">"scripts"</span>: {
    <span class="hljs-string">"test"</span>: <span class="hljs-string">"karma start"</span>,
    <span class="hljs-string">"start"</span>: <span class="hljs-string">"nodemon ./bin/www"</span>,
    <span class="hljs-string">"bundle"</span>: <span class="hljs-string">"node_modules/.bin/webpack"</span>
},
</code></pre>
<p>Add a <strong>home</strong> <strong>DIV</strong> to <strong>index.pug</strong>:</p>
<pre><code>extends layout

block <span class="hljs-attribute">content</span>

    <span class="hljs-selector-class">.jumbotron</span>
        <span class="hljs-selector-tag">h1</span> Elven Site Builder

        button<span class="hljs-selector-id">#makeHtml</span><span class="hljs-selector-class">.btn</span><span class="hljs-selector-class">.btn-warning</span> Make HTML
        button<span class="hljs-selector-id">#makeImage</span><span class="hljs-selector-class">.btn</span><span class="hljs-selector-class">.btn-success</span> Create Images

    div<span class="hljs-selector-id">#pageLoad</span>
        <span class="hljs-selector-tag">p</span> To see options, select <span class="hljs-selector-tag">a</span> <span class="hljs-selector-tag">button</span> above.

    div#home
</code></pre><p>And finally, load our <strong>bundle.js</strong> file using RequireJs. Most of you are probably not familiar with <strong>RequireJs</strong>, so for now I&#39;ll just show you the new code for <strong>public/javascripts/main.js</strong>:</p>
<pre><code class="lang-javascript">requirejs.config({
    <span class="hljs-attr">baseUrl</span>: <span class="hljs-string">'.'</span>,
    <span class="hljs-attr">paths</span>: {
        <span class="hljs-attr">jquery</span>: <span class="hljs-string">'components/jquery/dist/jquery'</span>,
        <span class="hljs-attr">bootstrap</span>: <span class="hljs-string">'components/bootstrap/dist/js/bootstrap'</span>,
        <span class="hljs-attr">control</span>: <span class="hljs-string">'javascripts/control'</span>,
        <span class="hljs-attr">elfLog</span>: <span class="hljs-string">'components/elven-tools/elf-log'</span>,
        <span class="hljs-attr">makeHtml</span>: <span class="hljs-string">'javascripts/make-html/make-html'</span>,
        <span class="hljs-attr">walking</span>: <span class="hljs-string">'javascripts/make-html/walking'</span>,
        <span class="hljs-attr">makeImage</span>: <span class="hljs-string">'javascripts/make-image/make-image'</span>,
        <span class="hljs-attr">imagePicker</span>: <span class="hljs-string">'javascripts/make-image/image-picker'</span>,
        <span class="hljs-attr">display</span>: <span class="hljs-string">'javascripts/tools/display'</span>,
        <span class="hljs-attr">settings</span>: <span class="hljs-string">'javascripts/tools/settings'</span>,
        <span class="hljs-attr">utilities</span>: <span class="hljs-string">'javascripts/tools/utilities'</span>,
        <span class="hljs-attr">reactBundle</span>: <span class="hljs-string">'javascripts/bundle'</span>,
    }
});

requirejs([<span class="hljs-string">'jquery'</span>], <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">$</span>) </span>{
<span class="hljs-meta">    'use strict'</span>;
    requirejs([<span class="hljs-string">'bootstrap'</span>, <span class="hljs-string">'control'</span>, <span class="hljs-string">'reactBundle'</span>], <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">bootstrap, control</span>) </span>{
        control();
        $(<span class="hljs-string">'.navbar-nav li.trigger-collapse a'</span>).click(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>) </span>{
            $(<span class="hljs-string">'.navbar-collapse'</span>).collapse(<span class="hljs-string">'hide'</span>);
        });
    });
});
</code></pre>
<p>The two new bits of code both include the words <strong>reactBundle</strong>. Here is the part added to <strong>requireJs.config</strong>:</p>
<pre><code class="lang-javascript"><span class="hljs-string">reactBundle:</span> <span class="hljs-string">'javascripts/bundle'</span>,
</code></pre>
<p>Here is the bit added to the call to <strong>requirejs</strong>:</p>
<pre><code class="lang-javascript">requirejs(['bootstrap', 'control', 'reactBundle'], function(bootstrap, control) <span class="hljs-meta">{...}</span>)
</code></pre>
<p><img src="https://s3.amazonaws.com/bucket01.elvenware.com/images/elven-web-crafts-react-01.png" alt="React in our Express"></p>
</div></body></html>