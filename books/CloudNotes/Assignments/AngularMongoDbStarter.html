<!DOCTYPE html><html lang="en" dir="ltr"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width initial-scale=1.0"><title>AngularMongoDbStarter</title><link href="/css/first-style.css" rel="stylesheet"><link rel="shortcut icon" href="/images/favicon.png"><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet"><link href="/css/highlight/googlecode.css" rel="stylesheet" type="text/css"><link href="/css/style.css" rel="stylesheet"><script src="https://code.jquery.com/jquery-1.12.0.min.js"></script><script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<!-- Latest compiled and minified CSS --><script src="/js/elven-help.js"></script></head><body><nav class="navbar navbar-inverse"><div class="container"><div class="navbar-header"><button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><a class="navbar-brand" href="/">Elvenware</a></div><div class="navbar-collapse collapse" id="navbar"><ul class="nav navbar-nav"><li class="trigger-collapse" ng-class="{ active: isActive('/')}"><a href="/">Home</a></li><li><a href="/about.html">About</a></li></ul></div></div></nav><div class="container"><figure><img class="elf-normal" alt="Elvenware" src="/images/elvenwarelogo.png"/></figure><h1>AngularMongoDbStarter</h1><p>Welcome to AngularMongoDbStarter</p><ul><!--TOC_Start--><li><a href="#angular-mongodb-starter">Angular MongoDb Starter</a></li>
<li><a href="#step-one">Step One</a></li>
<li><a href="#step-two">Step Two</a></li>
<li><a href="#step-three">Step Three</a></li>
<li><a href="#step-four">Step Four</a></li>
<li><a href="#turn-it-in">Turn it in</a></li><!--TOC_End--></ul></div><div class="container"><a class="anchor" id="angular-mongodb-starter"></a>
<h1>Angular MongoDb Starter</h1>
<p>Use Angular and MongoDb in a single express project.</p>
<p>The image shown below shows the first row in the database as it is displayed by the angular ng-repeat loop. At this point there is only one document in the collection, so <strong>Rows in DB</strong> count is set to <strong>1</strong>, and there is only one list item with three fields. Below it are a series of input fields containing the data from the first record.</p>
<p><img src="https://drive.google.com/uc?id=0B25UTAlOfPRGRUZ4REF1ZGY5b1E" alt="Angular MongoDb Starter"></p>
<p>In this version of this app, the Add President button does not work, neither do the Delete or Update buttons. Later, we will use CSS to format the buttons and the fields in this page, but for now, they are just arranged more or less as we declare them in the raw Jade file.</p>
<a class="anchor" id="step-one"></a>
<h2>Step One</h2>
<pre><code>express Week04-AngularMongoStart
cd Week04-AngularMongoStart
npm <span class="hljs-keyword">install
</span><span class="hljs-keyword">bower </span>init
</code></pre><p>Create a .bowerrc:</p>
<pre><code>{
  <span class="hljs-attr">"directory"</span>: <span class="hljs-string">"public/components"</span>
}
</code></pre><p>Add the following bower packages:</p>
<pre><code><span class="hljs-keyword">bower </span><span class="hljs-keyword">install </span>angular --save
<span class="hljs-keyword">bower </span><span class="hljs-keyword">install </span>angular-mocks --save
<span class="hljs-keyword">bower </span><span class="hljs-keyword">install </span>angular-resource --save
<span class="hljs-keyword">bower </span><span class="hljs-keyword">install </span><span class="hljs-keyword">bootstrap </span>--save
<span class="hljs-keyword">bower </span><span class="hljs-keyword">install </span><span class="hljs-keyword">jquery </span>--save
</code></pre><p>Use <strong>nodemon</strong> and start on port 30025. In <strong>routes/index.js</strong> set the title to <strong>AngularMongoDbStarter</strong>.</p>
<a class="anchor" id="step-two"></a>
<h2>Step Two</h2>
<p>Link in angular and bootstrap. In <strong>layout.jade</strong>:</p>
<pre><code>    // Latest compiled and minified CSS
    link(<span class="hljs-name">rel=</span>'stylesheet', href='components/bootstrap/dist/css/bootstrap.min.css')
    // Optional theme
    link(<span class="hljs-name">rel=</span>'stylesheet', href='components/bootstrap/dist/css/bootstrap-theme.min.css')
    // JavaScript
    script(<span class="hljs-name">src=</span>'components/jquery/dist/jquery.js')
    script(<span class="hljs-name">src=</span>'components/bootstrap/dist/js/bootstrap.min.js')
    script(<span class="hljs-name">src=</span>'components/angular/angular.js')
    script(<span class="hljs-name">src=</span>'components/angular-resource/angular-resource.js')

body(<span class="hljs-name">ng-app=</span>'elvenApp')
</code></pre><a class="anchor" id="step-three"></a>
<h2>Step Three</h2>
<p>Put the data in the database</p>
<ul>
<li>Create an account on MongoLab<ul>
<li>Your account credentials are not going to be your database credentials</li>
</ul>
</li>
<li>Create a database called prog219-lastname<ul>
<li>Amazon | Single Node | Sandbox | Free</li>
</ul>
</li>
<li>Create a user by clicking on the database<ul>
<li>Create a username and password and give yourself read write</li>
</ul>
</li>
<li>Create a collection called <strong>scientists</strong><ul>
<li>Add a document</li>
</ul>
</li>
<li>Go back to database page and get your URI<ul>
<li>mongodb://<dbuser>:<dbpassword>@ds031832.mongolab.com:31832/prog219-calvert</dbpassword></dbuser></li>
</ul>
</li>
</ul>
<p>Your document:</p>
<pre><code>{
    <span class="hljs-attr">"firstName"</span>: <span class="hljs-string">"Marie"</span>,
    <span class="hljs-attr">"lastName"</span>: <span class="hljs-string">"Curie"</span>,
    <span class="hljs-attr">"city"</span>: <span class="hljs-string">"Paris"</span>,
    <span class="hljs-attr">"country"</span>: <span class="hljs-string">"France"</span>,
    <span class="hljs-attr">"subject"</span>: <span class="hljs-string">"radiation"</span>
}
</code></pre><a class="anchor" id="step-four"></a>
<h2>Step Four</h2>
<p>Add this to the bottom of index.jade:</p>
<pre><code>  #monogoData(<span class="hljs-attribute">ng-controller</span>=<span class="hljs-string">'MyController'</span>)
    p This project retrieves data <span class="hljs-keyword">from</span> a Mongo DB Server.
    button(<span class="hljs-attribute">ng-click</span>=<span class="hljs-string">'loadPresidents()'</span>) Load President Data
    br
    .inputDiv
      p Rows <span class="hljs-keyword">in</span> DB: {{presidentsLength}}
      ul
        li(<span class="hljs-attribute">ng-repeat</span>=<span class="hljs-string">'scientist in scientists'</span>)
          p
          | FirstName: {{scientist.firstName}}
          br
          | LastName: {{scientist.lastName}}
          br
          | Subject: {{scientist.subject}}
      div(<span class="hljs-attribute">ng-bind-html-unsafe</span>=<span class="hljs-string">'hint'</span>)
    .inputDiv
      input(<span class="hljs-attribute">type</span>=<span class="hljs-string">'text'</span>, <span class="hljs-attribute">ng-model</span>=<span class="hljs-string">'firstName'</span>)
      input(<span class="hljs-attribute">type</span>=<span class="hljs-string">'text'</span>, <span class="hljs-attribute">ng-model</span>=<span class="hljs-string">'lastName'</span>, <span class="hljs-attribute">placeholder</span>=<span class="hljs-string">'termStart'</span>)
      input(<span class="hljs-attribute">type</span>=<span class="hljs-string">'text'</span>, <span class="hljs-attribute">ng-model</span>=<span class="hljs-string">'subject'</span>, <span class="hljs-attribute">placeholder</span>=<span class="hljs-string">'termEnd'</span>)
      button(<span class="hljs-attribute">ng-click</span>=<span class="hljs-string">'newPresident()'</span>) <span class="hljs-builtin-name">Add</span> President
      hr
      input(<span class="hljs-attribute">type</span>=<span class="hljs-string">'number'</span>, <span class="hljs-attribute">ng-change</span>=<span class="hljs-string">'indexChange()'</span>, <span class="hljs-attribute">ng-model</span>=<span class="hljs-string">'indexOfItemToDelete'</span>, <span class="hljs-attribute">min</span>=<span class="hljs-string">'0'</span>, <span class="hljs-attribute">max</span>=<span class="hljs-string">'{{presidentsLength-1}}'</span>)
      button(<span class="hljs-attribute">ng-click</span>=<span class="hljs-string">'deleteRow()'</span>) Delete
      button(<span class="hljs-attribute">ng-click</span>=<span class="hljs-string">'updateRow()'</span>) Update
      p {{selectedIndex}}
</code></pre><a class="anchor" id="step-four"></a>
<h2>Step Four</h2>
<p>Create the angular modules that will query and display the database.</p>
<pre><code><span class="hljs-comment">/**
 * Created by charlie on 4/29/2015.
 */</span>

angular.module(<span class="hljs-string">'pres'</span>, [<span class="hljs-string">'ngResource'</span>])
    .constant(<span class="hljs-string">'CONFIG'</span>, {
        <span class="hljs-attr">DB_NAME</span>: <span class="hljs-string">'prog219-lastname'</span>,
        <span class="hljs-attr">COLLECTION</span>: <span class="hljs-string">'scientists'</span>,
        <span class="hljs-attr">API_KEY</span>: <span class="hljs-string">'&lt;YOUR_KEY&gt;'</span>
    })
    .factory(<span class="hljs-string">'scientists'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">$resource, CONFIG</span>) </span>{
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'Scientists factory called'</span>);
        <span class="hljs-keyword">var</span> scientists = $resource(
            <span class="hljs-string">'https://api.mongolab.com/api/1/databases/'</span> + CONFIG.DB_NAME +
            <span class="hljs-string">'/collections/'</span> + CONFIG.COLLECTION + <span class="hljs-string">'/:id'</span>, {
                <span class="hljs-attr">apiKey</span>: CONFIG.API_KEY
            },
            {
                <span class="hljs-attr">update</span>: {<span class="hljs-attr">method</span>: <span class="hljs-string">'PUT'</span>}
            });

        scientists.prototype.getFirstName = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.firstName;
        };

        scientists.prototype.getLastName = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.lastName;
        };

        scientists.prototype.getSubject = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.subject;
        };

        <span class="hljs-keyword">return</span> scientists;
    });
</code></pre><p>and in mongodb: </p>
<pre><code>angular.module(<span class="hljs-string">'elvenApp'</span>, [<span class="hljs-string">'pres'</span>])
    .controller(<span class="hljs-string">'MyController'</span>, function($<span class="hljs-keyword">scope, </span>$http, <span class="hljs-keyword">scientists) </span>{
        $<span class="hljs-keyword">scope.hint </span>= <span class="hljs-string">"&lt;p&gt;Start with &lt;strong&gt;node server.js&lt;/strong&gt; to retrieve JSON from Server&lt;/p&gt;"</span><span class="hljs-comment">;</span>

        $<span class="hljs-keyword">scope.loadPresidents </span>= function() {
            $<span class="hljs-keyword">scope.scientists </span>= <span class="hljs-keyword">scientists.query({}, </span>function(<span class="hljs-keyword">scientists) </span>{
                $<span class="hljs-keyword">scope.presidentsLength </span>= <span class="hljs-keyword">scientists.length;
</span>                $<span class="hljs-keyword">scope.firstName </span>= <span class="hljs-keyword">scientists[0].firstName;
</span>                $<span class="hljs-keyword">scope.lastName </span>= <span class="hljs-keyword">scientists[0].lastName;
</span>                console.log(<span class="hljs-keyword">scientists[0].firstName);
</span>                console.log(<span class="hljs-keyword">scientists[0].lastName);
</span>                console.log(<span class="hljs-keyword">scientists[0].getFirstName());
</span>            })<span class="hljs-comment">;</span>
        }<span class="hljs-comment">;</span>
    })<span class="hljs-comment">;</span>
</code></pre><p>And then add to <strong>layout.jade</strong>:</p>
<pre><code><span class="hljs-function"><span class="hljs-title">script</span><span class="hljs-params">(src=<span class="hljs-string">'javascripts/resources.js'</span>)</span></span>
<span class="hljs-function"><span class="hljs-title">script</span><span class="hljs-params">(src=<span class="hljs-string">'javascripts/control.js'</span>)</span></span>
</code></pre><p>Your api key is on your Account page near the very bottom. It does
not look like a URI. Rather it looks like a long string of meaningless
numbers and letters. Though much shorter, it looks a bit like the keys 
in an SSH file.</p>
<a class="anchor" id="turn-it-in"></a>
<h2>Turn it in</h2>
<p>Put the folder in your repository and check it in. Include the URI of your repository and the name of the folder your used. </p>
</div></body></html>