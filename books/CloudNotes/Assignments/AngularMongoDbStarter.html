<!DOCTYPE html><html lang="en" dir="ltr"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width initial-scale=1.0"><title>AngularMongoDbStarter</title><link rel="shortcut icon" href="/charlie/images/favicon.png"><!-- Latest compiled and minified CSS--><link rel="stylesheet" href="/components/bootstrap/dist/css/bootstrap.min.css"><!-- Optional theme--><link rel="stylesheet" href="/components/bootstrap/dist/css/bootstrap-theme.min.css"><link href="/libs/css/BootstrapIndex.css" rel="stylesheet" type="text/css"><link href="/css/style.css" rel="stylesheet" type="text/css"><link href="/css/highlight/googlecode.css" rel="stylesheet" type="text/css"><script src="/components/jquery/dist/jquery.js"></script><script src="/components/angular/angular.js"></script><script src="/components/angular-route/angular-route.js"></script><script src="/components/bootstrap/dist/js/bootstrap.min.js"></script><script src="/libs/scripts/elvenware.js" type="text/javascript"></script><script src="/libs/scripts/Control.js"></script></head><body><div class="navbar navbar-inverse"><div class="container"><div class="navbar-header"><button type="button" data-toggle="collapse" data-target=".navbar-collapse" class="navbar-toggle"><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><a href="/" class="navbar-brand">Elvenware</a></div><div class="collapse navbar-collapse"><ul class="nav navbar-nav"><li class="active"><a href="/index.html">Home</a></li><li><a href="/about">About</a></li><li class="dropdown"><a href="#/" data-toggle="dropdown" class="dropdown-toggle">Dropdown<b class="caret"></b></a><ul class="dropdown-menu"><li class="dropdown-header">Core Code</li><li><a href="/development/index.html">Strongly Typed</a></li><li><a href="/development/web/index.html">Web & Scripts</a></li><li><a href="/development/cloud/index.shtml">Cloud</a></li><li class="divider"></li><li class="dropdown-header">OS and Tools</li><li><a href="/os/index.html">OS</a></li><li><a href="/development/database/index.html">Database</a></li><li><a href="/books/index.html">My Writing</a></li><li class="divider"></li><li class="dropdown-header">Art</li><li><a href="/charlie/Art/index.html">Poems & Photos</a></li><li><a href="/books/reading/index.html">Book Reviews</a></li><li><a href="/spirit/index.html">Spiritual</a></li><li class="divider"></li><li class="dropdown-header">Links</li><li><a href="/charlie/links.html">My Links</a></li><li><a href="http://www.github.com/charliecalvert">GitHub</a></li><li><a href="http://sourceforge.net/projects/elvenware/">Sourceforge</a></li></ul></li></ul></div><!-- /.nav-collapse--></div></div><div class="container"><figure><img alt="Elvenware" src="/charlie/images/elvenwarelogo.png"/></figure><h1>AngularMongoDbStarter</h1><h3>Table of Contents</h3><ul><!--TOC_Start--><li><a href="#angular-mongodb-starter">Angular MongoDb Starter</a></li>
<li><a href="#step-one">Step One</a></li>
<li><a href="#step-two">Step Two</a></li>
<li><a href="#step-three">Step Three</a></li>
<li><a href="#step-four">Step Four</a></li>
<li><a href="#step-four">Step Four</a></li>
<li><a href="#turn-it-in">Turn it in</a></li><!--TOC_End--></ul><h1 id="angular-mongodb-starter">Angular MongoDb Starter</h1>
<p>Use Angular and MongoDb in a single express project.</p>
<p>The image shown below shows the first row in the database as it is displayed by the angular ng-repeat loop. At this point there is only one document in the collection, so <strong>Rows in DB</strong> count is set to <strong>1</strong>, and there is only one list item with three fields. Below it are a series of input fields containing the data from the first record.</p>
<p><img src="https://drive.google.com/uc?id=0B25UTAlOfPRGRUZ4REF1ZGY5b1E" alt="Angular MongoDb Starter"></p>
<p>In this version of this app, the Add President button does not work, neither do the Delete or Update buttons. Later, we will use CSS to format the buttons and the fields in this page, but for now, they are just arranged more or less as we declare them in the raw Jade file.</p>
<h2 id="step-one">Step One</h2>
<pre><code><span class="hljs-label">express</span> Week04-AngularMongoStart
<span class="hljs-label">cd</span> Week04-AngularMongoStart
<span class="hljs-label">npm</span> install
<span class="hljs-keyword">bower </span>init
</code></pre><p>Create a .bowerrc:</p>
<pre><code>{
  "<span class="hljs-attribute">directory</span>": <span class="hljs-value"><span class="hljs-string">"public/components"</span>
</span>}
</code></pre><p>Add the following bower packages:</p>
<pre><code>bower <span class="hljs-operator"><span class="hljs-keyword">install</span> angular <span class="hljs-comment">--save</span>
bower <span class="hljs-keyword">install</span> angular-mocks <span class="hljs-comment">--save</span>
bower <span class="hljs-keyword">install</span> angular-<span class="hljs-keyword">resource</span> <span class="hljs-comment">--save</span>
bower <span class="hljs-keyword">install</span> bootstrap <span class="hljs-comment">--save</span>
bower <span class="hljs-keyword">install</span> jquery <span class="hljs-comment">--save</span></span>
</code></pre><p>Use <strong>nodemon</strong> and start on port 30025. In <strong>routes/index.js</strong> set the title to <strong>AngularMongoDbStarter</strong>.</p>
<h2 id="step-two">Step Two</h2>
<p>Link in angular and bootstrap. In <strong>layout.jade</strong>:</p>
<pre><code>    <span class="hljs-comment">// Latest compiled and minified CSS</span>
    <span class="hljs-function"><span class="hljs-title">link</span><span class="hljs-params">(rel=<span class="hljs-string">'stylesheet'</span>, href=<span class="hljs-string">'components/bootstrap/dist/css/bootstrap.min.css'</span>)</span></span>
    <span class="hljs-comment">// Optional theme</span>
    <span class="hljs-function"><span class="hljs-title">link</span><span class="hljs-params">(rel=<span class="hljs-string">'stylesheet'</span>, href=<span class="hljs-string">'components/bootstrap/dist/css/bootstrap-theme.min.css'</span>)</span></span>
    <span class="hljs-comment">// JavaScript</span>
    <span class="hljs-function"><span class="hljs-title">script</span><span class="hljs-params">(src=<span class="hljs-string">'components/jquery/dist/jquery.js'</span>)</span></span>
    <span class="hljs-function"><span class="hljs-title">script</span><span class="hljs-params">(src=<span class="hljs-string">'components/bootstrap/dist/js/bootstrap.min.js'</span>)</span></span>
    <span class="hljs-function"><span class="hljs-title">script</span><span class="hljs-params">(src=<span class="hljs-string">'components/angular/angular.js'</span>)</span></span>
    <span class="hljs-function"><span class="hljs-title">script</span><span class="hljs-params">(src=<span class="hljs-string">'components/angular-resource/angular-resource.js'</span>)</span></span>

<span class="hljs-function"><span class="hljs-title">body</span><span class="hljs-params">(ng-app=<span class="hljs-string">'elvenApp'</span>)</span></span>
</code></pre><h2 id="step-three">Step Three</h2>
<p>Put the data in the database</p>
<ul>
<li>Create an account on MongoLab<ul>
<li>Your account credentials are not going to be your database credentials</li>
</ul>
</li>
<li>Create a database called prog219-lastname<ul>
<li>Amazon | Single Node | Sandbox | Free</li>
</ul>
</li>
<li>Create a user by clicking on the database<ul>
<li>Create a username and password and give yourself read write</li>
</ul>
</li>
<li>Create a collection called <strong>scientists</strong><ul>
<li>Add a document</li>
</ul>
</li>
<li>Go back to database page and get your URI<ul>
<li>mongodb://<dbuser>:<dbpassword>@ds031832.mongolab.com:31832/prog219-calvert</dbpassword></dbuser></li>
</ul>
</li>
</ul>
<p>Your document:</p>
<pre><code>{
    "<span class="hljs-attribute">firstName</span>": <span class="hljs-value"><span class="hljs-string">"Marie"</span></span>,
    "<span class="hljs-attribute">lastName</span>": <span class="hljs-value"><span class="hljs-string">"Curie"</span></span>,
    "<span class="hljs-attribute">city</span>": <span class="hljs-value"><span class="hljs-string">"Paris"</span></span>,
    "<span class="hljs-attribute">country</span>": <span class="hljs-value"><span class="hljs-string">"France"</span></span>,
    "<span class="hljs-attribute">subject</span>": <span class="hljs-value"><span class="hljs-string">"radiation"</span>
</span>}
</code></pre><h2 id="step-four">Step Four</h2>
<p>Add this to the bottom of index.jade:</p>
<pre><code>  <span class="hljs-comment">#monogoData(ng-controller='MyController')</span>
    p <span class="hljs-constant">This</span> project retrieves data from a <span class="hljs-constant">Mongo</span> <span class="hljs-constant">DB</span> <span class="hljs-constant">Server</span>.
    button(ng-click=<span class="hljs-string">'loadPresidents()'</span>) <span class="hljs-constant">Load</span> <span class="hljs-constant">President</span> <span class="hljs-constant">Data</span>
    br
    .inputDiv
      p <span class="hljs-constant">Rows</span> in <span class="hljs-constant">DB</span>: <span class="hljs-expansion">{{presidentsLength}}</span>
      ul
        li(ng-repeat=<span class="hljs-string">'scientist in scientists'</span>)
          p
          | <span class="hljs-constant">FirstName</span>: <span class="hljs-expansion">{{scientist.firstName}}</span>
          br
          | <span class="hljs-constant">LastName</span>: <span class="hljs-expansion">{{scientist.lastName}}</span>
          br
          | <span class="hljs-constant">Subject</span>: <span class="hljs-expansion">{{scientist.subject}}</span>
      div(ng-bind-html-unsafe=<span class="hljs-string">'hint'</span>)
    .inputDiv
      input(<span class="hljs-keyword">type</span>=<span class="hljs-string">'text'</span>, ng-model=<span class="hljs-string">'firstName'</span>)
      input(<span class="hljs-keyword">type</span>=<span class="hljs-string">'text'</span>, ng-model=<span class="hljs-string">'lastName'</span>, placeholder=<span class="hljs-string">'termStart'</span>)
      input(<span class="hljs-keyword">type</span>=<span class="hljs-string">'text'</span>, ng-model=<span class="hljs-string">'subject'</span>, placeholder=<span class="hljs-string">'termEnd'</span>)
      button(ng-click=<span class="hljs-string">'newPresident()'</span>) <span class="hljs-constant">Add</span> <span class="hljs-constant">President</span>
      hr
      input(<span class="hljs-keyword">type</span>=<span class="hljs-string">'number'</span>, ng-change=<span class="hljs-string">'indexChange()'</span>, ng-model=<span class="hljs-string">'indexOfItemToDelete'</span>, min=<span class="hljs-string">'0'</span>, max=<span class="hljs-string">'{{presidentsLength-1}}'</span>)
      button(ng-click=<span class="hljs-string">'deleteRow()'</span>) <span class="hljs-constant">Delete</span>
      button(ng-click=<span class="hljs-string">'updateRow()'</span>) <span class="hljs-constant">Update</span>
      p <span class="hljs-expansion">{{selectedIndex}}</span>
</code></pre><h2 id="step-four">Step Four</h2>
<p>Create the angular modules that will query and display the database.</p>
<pre><code><span class="hljs-comment">/**
 * Created by charlie on 4/29/2015.
 */</span>

angular.module(<span class="hljs-string">'pres'</span>, [<span class="hljs-string">'ngResource'</span>])
    .constant(<span class="hljs-string">'CONFIG'</span>, {
        DB_NAME: <span class="hljs-string">'prog219-lastname'</span>,
        COLLECTION: <span class="hljs-string">'scientists'</span>,
        API_KEY: <span class="hljs-string">'&lt;YOUR_KEY&gt;'</span>
    })
    .factory(<span class="hljs-string">'scientists'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">$resource, CONFIG</span>) </span>{
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'Scientists factory called'</span>);
        <span class="hljs-keyword">var</span> scientists = $resource(
            <span class="hljs-string">'https://api.mongolab.com/api/1/databases/'</span> + CONFIG.DB_NAME +
            <span class="hljs-string">'/collections/'</span> + CONFIG.COLLECTION + <span class="hljs-string">'/:id'</span>, {
                apiKey: CONFIG.API_KEY
            },
            {
                update: {method: <span class="hljs-string">'PUT'</span>}
            });

        scientists.prototype.getFirstName = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.firstName;
        };

        scientists.prototype.getLastName = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.lastName;
        };

        scientists.prototype.getSubject = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.subject;
        };

        <span class="hljs-keyword">return</span> scientists;
    });
</code></pre><p>and in mongodb: </p>
<pre><code>angular.module(<span class="hljs-string">'elvenApp'</span>, [<span class="hljs-string">'pres'</span>])
    .controller(<span class="hljs-string">'MyController'</span>, <span class="hljs-keyword">function</span>(<span class="hljs-variable">$scope</span>, <span class="hljs-variable">$http</span>, scientists) {
        <span class="hljs-variable">$scope</span>.hint = <span class="hljs-string">"&lt;p&gt;Start with &lt;strong&gt;node server.js&lt;/strong&gt; to retrieve JSON from Server&lt;/p&gt;"</span>;

        <span class="hljs-variable">$scope</span>.loadPresidents = function() {
            <span class="hljs-variable">$scope</span>.scientists = scientists.query({}, function(scientists) {
                <span class="hljs-variable">$scope</span>.presidentsLength = scientists.length;
                <span class="hljs-variable">$scope</span>.firstName = scientists[<span class="hljs-number">0</span>].firstName;
                <span class="hljs-variable">$scope</span>.lastName = scientists[<span class="hljs-number">0</span>].lastName;
                console.log(scientists[<span class="hljs-number">0</span>].firstName);
                console.log(scientists[<span class="hljs-number">0</span>].lastName);
                console.log(scientists[<span class="hljs-number">0</span>].getFirstName());
            });
        };
    });
</code></pre><p>And then add to <strong>layout.jade</strong>:</p>
<pre><code><span class="hljs-function"><span class="hljs-title">script</span><span class="hljs-params">(src=<span class="hljs-string">'javascripts/resources.js'</span>)</span></span>
<span class="hljs-function"><span class="hljs-title">script</span><span class="hljs-params">(src=<span class="hljs-string">'javascripts/control.js'</span>)</span></span>
</code></pre><p>Your api key is on your Account page near the very bottom. It does
not look like a URI. Rather it looks like a long string of meaningless
numbers and letters. Though much shorter, it looks a bit like the keys 
in an SSH file.</p>
<h2 id="turn-it-in">Turn it in</h2>
<p>Put the folder in your repository and check it in. Include the URI of your repository and the name of the folder your used. </p>
</div></body></html>