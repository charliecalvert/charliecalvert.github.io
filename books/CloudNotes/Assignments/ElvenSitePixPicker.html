<!DOCTYPE html><html lang="en" dir="ltr"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width initial-scale=1.0"><title>ElvenSitePixPicker</title><link href="/css/first-style.css" rel="stylesheet"><link rel="shortcut icon" href="/images/favicon.png"><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet"><link href="/css/highlight/googlecode.css" rel="stylesheet" type="text/css"><link href="/css/style.css" rel="stylesheet"><script src="https://code.jquery.com/jquery-1.12.0.min.js"></script><script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<!-- Latest compiled and minified CSS --><script src="/js/elven-help.js"></script></head><body><nav class="navbar navbar-inverse"><div class="container"><div class="navbar-header"><button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><a class="navbar-brand" href="/">Elvenware</a></div><div class="navbar-collapse collapse" id="navbar"><ul class="nav navbar-nav"><li class="trigger-collapse" ng-class="{ active: isActive('/')}"><a href="/">Home</a></li><li><a href="/about.html">About</a></li></ul></div></div></nav><div class="container"><figure><img class="elf-normal" alt="Elvenware" src="/images/elvenwarelogo.png"/></figure><h1>ElvenSitePixPicker</h1><p>Welcome to ElvenSitePixPicker</p><ul><!--TOC_Start--><li><a href="#overview">Overview</a></li>
<li><a href="#copy-midterm">Copy Midterm</a></li>
<li><a href="#two-pages">Two Pages</a></li>
<li><a href="#page-one">Page One</a></li>
<li><a href="#load-the-pages">Load the Pages</a></li>
<li><a href="#server-side">Server Side</a></li>
<li><a href="#nodemon-warning">Nodemon Warning</a></li>
<li><a href="#turn-it-in">Turn it in</a></li><!--TOC_End--></ul></div><div class="container"><a class="anchor" id="overview"></a>
<h2>Overview</h2>
<p>Elven Site Pix Picker</p>
<a class="anchor" id="copy-midterm"></a>
<h2>Copy Midterm</h2>
<pre>cp -r Week08-Midterm Week10-ElvenSitePixPicker
</pre>
<p>Don&#39;t forget to rename the project when you open it in WebStorm.</p>
<p>Make sure you <strong>~/.content/ElvenConfig.json</strong> contains the usual code plus the following, or something like it:</p>
<pre>"elvenImages": {
  "baseDir": "/var/www/html",
  "markdownFileWithImages": "/home/bcuser/Documents/AllTest/california.md",
  "allImagesJsonFile": "all-images.json",
  "imageDir": "/images/california/",
  "notUsedDir": "/home/bcuser/temp/not-used/california"
},
</pre>
<a class="anchor" id="two-pages"></a>
<h2>Two Pages</h2>
<p>The first step will be to create two pages:</p>
<ul>
<li>One for creating a web site, MakeHtml style, as in the midterm</li>
<li>One for creating a page based on a set of pictures from your camera or some other source</li>
</ul>
<a class="anchor" id="page-one"></a>
<h2>Page One</h2>
<p>Take everything beneath the <strong>block content</strong> in <strong>index.jade</strong> and put it in <strong>make-html.jade</strong>.</p>
<p>Replace the content you removed with the following:</p>
<pre>div
    a.pageLink#pageOne Page One
    a.pageLink#pageTwo Page Two

div#pageLoad
</pre>
<p>Add some CSS to <strong>public/css/style.css</strong> to make the anchors a bit prettier. At minimum, do this:</p>
<pre>.pageLink {
    margin: 5px;
    padding: 3px;
    border: black solid thin;
    -webkit-border-radius: 4px;
    -moz-border-radius:4px;
    border-radius: 4px;
}
</pre>
<a class="anchor" id="load-the-pages"></a>
<h2>Load the Pages</h2>
<p>You will need code like this to load the pages:</p>
<pre>function SiteConfig() {
    $('#pageOne').click(pageOne);
    $('#pageTwo').click(pageTwo);
}

function pageOne() {
    $('#pageLoad').load('/makeHtml', function() {
        $('#loadConfig').click(loadConfig);
        elf.walking.configurePageOne();
        loadConfig();
    });
}

function pageTwo() {
    $('#pageLoad').load('/pixPicker', function() {
        // CODE OMITTED HERE
    });
}
</pre>
<a class="anchor" id="server-side"></a>
<h2>Server Side</h2>
<p>Here are the methods found in <strong>routes/index.js</strong> for calling into the image code in <strong>elven-stite-tools</strong>.</p>
<pre>router.get('/makeMarkdown', function(request, response) {
    console.log('makeMarkdown route called');
    var makeMarkdown = new imageHelp.MakeMarkdown();

    makeMarkdown.loadAndRun(function(report) {
        if (report.spacesInFileNames) {
            console.log('=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=');
            console.log('You have spaces in one or more file names.');
            console.log('The problem is probably in your images directory.');
            console.log('FileNames or Directories with spaces in their ');
            console.log('names is not a good idea. Run this command in ');
            console.log('the offending directory and then restart:');
            console.log('=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=');
            console.log('find -name "* *" -type f | rename "s/ /_/g"');
            console.log('=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=');
            response.send({ error: 'spaces in file name' });
        } else if (report.markdownFileExists) {
            response.send({ error: 'Markdown file exists: ' + report.markdownFileWithImages });
        } else {
            response.send({
                'success': 'makeMarkdown',
                'report': report
            });
        }
        console.log(report);
    });
});

router.get('/deleteMarkdown', function(request, response) {
    var makeMarkdown = new imageHelp.MakeMarkdown();
    makeMarkdown.deleteMarkdownFileWithImages(function(result) {
        console.log(result);
        response.send({ 'result': 'file deleted'});
    })
});
</pre>
<p>On the client side, these are simple button clicks, with no parameters (requestQuery) being passed.</p>
<a class="anchor" id="nodemon-warning"></a>
<h2>Nodemon Warning</h2>
<p>There is one catch here. Since <strong>all-images.json</strong> gets rewritten, you have to tell nodemon to ignore that file or it will keep restarting your application.</p>
<p>Save the following as <strong>nodemon.json</strong> in the root of your project:</p>
<pre>{
  "verbose": false,
  "ignore": ["all-images.json"]
}
</pre>
<a class="anchor" id="turn-it-in"></a>
<h2>Turn it in</h2>
<p>Tell me the project and branch.</p>
</div></body></html>