<!DOCTYPE html>
<html dir="ltr">

<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type" />

    <title>Virtualization</title>

<meta content="width=device-width,minimum-scale=1.0,maximum-scale=1.0" name="viewport" />
<link href="/charlie/libs/css/style2.css" rel="stylesheet" title="style2" type="text/css" />
<link href="/charlie/libs/jquery-ui/jquery-ui.css" rel="stylesheet" type="text/css" />
<script src="/charlie/libs/scripts/jquery.min.js" type="text/javascript"></script>
<script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.10.3/jquery-ui.min.js" type="text/javascript"></script>
<script src="/charlie/libs/scripts/elvenware.js" type="text/javascript"></script>

<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-2806409-2']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
</head>

<body>



<div id="container">
	<header>
		<div class="navButton" onclick="elvenware.toggleMenu()">
			Toggle Menu</div>
		<h1>Charlie Calvert on Elvenware</h1>
		<h2>Writing Code and Prose on Computers</h2>
	</header>
	<nav>
		<h2>Menu</h2>
		<div id="accordion00">
		<h2 class="navSection01">Core Code</h2>
			<ul>
				<li><a href="/charlie/development/index.html">Strongly Typed</a></li>
				<li><a href="/charlie/development/web/index.html">Web &amp; Scripts</a></li>
				<li><a href="/charlie/development/cloud/index.shtml">Cloud</a></li>
			</ul>
		
			<h2 class="navSection02">OS and Tools</h2>
			<ul>
				<li><a href="/charlie/os/index.html">OS</a></li>
				<li><a href="/charlie/development/database/index.html">Database</a></li>
				<li><a href="/charlie/books/index.html">My Writing</a></li>
			</ul>
			
		
			<h2 class="navSection03">Art</h2>
			<ul>
				<li><a href="../../Art/index.html">Poems &amp; Photos</a></li>
				<li><a href="../../books/reading/index.html">Book Reviews</a></li>
				<li><a href="../../spirit/index.html">Spiritual</a></li>
			</ul>
			<h2 class="navSection04">Links</h2>
			<ul>
				<li><a href="../../links.html">My Links</a></li>
				<li><a href="http://www.falafel.com/">Falafel</a></li>
				<li><a href="http://sourceforge.net/projects/elvenware/">Sourceforge</a></li>
			</ul>
		</div>
	</nav>
	<article>
		<figure>
			<img alt="Elvenware" src="/charlie/images/elvenwarelogo.png" /></figure>
<ul>
	<li><a href='#other-elvenware-pages-about-virtualbox'>Other Elvenware pages about VirtualBox:</a></li>
	<li><a href='#vAppliance'>Working with Virtual Appliances</a></li>
	<li><a href='#importing-an-appliance'>Importing an Appliance</a></li>
	<li><a href='#networking-errors-after-migrating-an-appliance'>Networking Errors after Migrating an Appliance</a></li>
	<li><a href='#notes-on-creating-virtual-appliances-with-virtualbox'>Notes on Creating Virtual Appliances with VirtualBox</a></li>
	<li><a href='#screenshot'>Taking Screen Shots of Linux Running in VirtualBox on a Windows Host</a></li>
	<li><a href='#dhcp'>VirtualBox DHCP</a></li>
	<li><a href='#from-a-red-hat-video-it-process-institute'>From a Red Hat Video (It Process Institute)</a></li>
	<li><a href='#proof-of-concept-poc'>Proof of Concept (POC)</a></li>
	<li><a href='#sharing-the-clipboard'>Sharing the ClipBoard</a></li>
</ul>
<ul>
<li><a href="http://en.wikipedia.org/wiki/X86_virtualization">Hardware Virtualization</a></li>
</ul>
<h2 id="other-elvenware-pages-about-virtualbox">Other Elvenware pages about VirtualBox:</h2>
<ul>
<li><a href="http://www.elvenware.com/charlie/os/linux/VirtualBox.html">Linux Page</a></li>
<li><a href="http://www.elvenware.com/charlie/development/android/Androidx86.shtml">Android X86 Page</a></li>
</ul>
<p>There are two different types of Virtualization software:</p>
<ul>
<li>Type 1: Loads before OS, runs on bare metal</li>
<li>Type 2: Runs after OS loads</li>
</ul>
<p>VirtualBox is a Type 2 virtual machine, while Xen is a type one machine. When using VirtualBox, we first boot Windows, Linux or the Mac, and then run VirtualBox on top of them. We end up running our core OS, and then displaying a Window on the desktop that hosts our Virtual OS. This virtual machine could be a copy of either Linux or Windows. As a rule, we don't see the Mac OS running in a virtual machine.</p>
<h2 id="vAppliance">Working with Virtual Appliances</h2>
<p>To understand the role of virtual machines in the cloud, it helps to learn how easy they are to reuse. This exercise is designed to give you hands on training in reusing a virtual machine.</p>
<p>Open up VirtualBox, select, but do not open, your Linux image. Choose <strong>File | Export Appliance</strong> from the VirtualBox menu. You will be taken to a screen from which you can confirm that you have chosen the correct virtual machine to export, as shown in Figure 1.</p>
<p><a href="images/VirtualBoxExportAndroid01.png"><img src="images/VirtualBoxExportAndroid01Small.png" alt="Export from VirtualBox" /></a></p>
<p><strong>Figure 01: Appliance Export Wizard, Screen 1. Click to see larger image.</strong></p>
<p>In the next screen, you choose the name of the file that will store your exported appliance. Be sure to pick a drive with plenty of free space. Linux typically takes 2-3 GB when stored, but other OS's need much more space:</p>
<p><a href="images/VirtualBoxExportAndroid02.png"><img src="images/VirtualBoxExportAndroid02Small.png" alt="Export from Virtual Box" /></a></p>
<p><strong>Figure 02: Choose a big drive with plenty of room. Click to see larger image.</strong></p>
<p>Finally, you get a chance to fill in some fields that you can use to identify and describe the export. Double click to edit the fields:</p>
<p><a href="images/VirtualBoxExportAndroid03.png"><img src="images/VirtualBoxExportAndroid03Small.png" alt="VirtualBox Export final screen" /></a></p>
<p><strong>Figure 03: Filling in fields to identify your export.</strong></p>
<p>After you click on the <strong>Export</strong> button your appliance is stored inside a file with an OVA extension. This file can be stored on a DVD, USB hard drive or thumb drive, and can be used to quickly create a VM on your current system, or on another system. The files in the VM are nearly identical to those used by VirtualBox, but they are compressed, and certain identifying information has been stripped out. The lack of identification ensures the VirtualBox can give an imported instance of the Appliance unique identifiers that do not conflict with those on your current system.</p>
<h3 id="importing-an-appliance">Importing an Appliance</h3>
<p>You now want to import the appliance you created. If you created the image on your machine at Bellevue College, then I would like to see you import it to a machine in your home. If you created the image at home, I would like to see you import it on your machine at BC. If for some reason you can't do this, please explain why in the document you will create for the assignment. I describe that document in the section <a href="#turnIn">on turning in your homework</a>. You do not need to remove or rename the system you cloned. Both the original and the copy can co-exist in VirtualBox, though you might not want to run them both at the same time.</p>
<p>Begin by selecting <strong>File | Import Appliance</strong> from the VirtualBox menu. Use the <strong>Choose</strong>button to browse for the file you created in the previous step. After you have selected the file, the window should look like the one in Figure 04:</p>
<p><a href="images/VirtualBoxExportAndroid04.png"><img src="images/VirtualBoxExportAndroid04Small.png" alt="VirtualBox import appliance" /></a></p>
<p><strong>Figure 04: Selecting the file that contains the appliance you want to import.</strong></p>
<p>In the final screen you get a chance to make a few choices. One of the most important is whether or not you want to select a unique Mac address (reinitialize) for your VM. If you want to run this VM and the one you cloned at the same time, then you should check this box, seen at the very bottom of the dialog. You can also choose whether or not to initialize the <strong>USB Controller</strong>, <strong>Sound Card</strong> and <strong>Network Adapter</strong> to their default values. In our case, the answer should probably be yes, but you might not do this on some machines that don't support the same features found on the machine where the device was created.</p>
<p> <a href="images/VirtualBoxExportAndroid05.png"><img src="images/VirtualBoxExportAndroid05Small.png" alt="VirtualBox Import appliance" /></a></p>
<p><strong>Figure 05: Importing an Appliance into VirtualBox. Click to see larger image.</strong></p>
<p>When you are done, you will have a new image based on your original virtual machine. Try running one image, making some modification to a file in your home directory, then close your image and run the other cloned virtual machine. Notice that it does not contain the change you made. These are two different virtual machines.</p>
<p>On Linux, you can use a text editor such as GEdit or Nano to create and edit text files. Your home directory is located in <strong>/home/LastName</strong>, where <strong>UserName</strong> is your user name. For instance a home directory might be called something like <strong>/home/susan</strong>. If you open the Linux file manager (Nautilus) then by default you will end up in your home directory. At the Linux command prompt, if you type <strong>cd</strong> followed by a space, and press enter, you will be taken to your directory. You can see the full path of your current directory by typing<strong>pwd + Enter.</strong>)</p>
<p>What have you accomplished in this exercise? Several different things, at least three of which stand out:</p>
<ul>
<li>You have made a back up of your virtual machine so you can restore it when necessary.</li>
<li>You have made a portable copy of your virtual machine that you can take to another machine or give to a friend. (These images are portable across operatoring systems, so an image made on Windows can be opened on the MAC or a Linux box.)</li>
<li>You have created a &quot;disposable&quot; machine that can be used for testing by developers or students, or anyone else who wants a machine that can be used heavily for a few hours, and then deleted and restored back to its original state by simply re-importing the OVA file.</li>
</ul>
<p>Finally, you have also taken a step toward understanding how multiple virtual machines can be easily deployed on the cloud. If you want to &quot;rent out&quot; these machines to a third party over the Internet, you could simply import your OVA file, find out its IP address, then give that IP address to a third party who could begin using the file over the Internet. You could do this multiple times to begin simulating a real cloud environment, in which one physical machine hosts multiple virtual machines. But we are not quite ready for that scenario yet, though we are getting close.</p>
<p>NOTE: There is a second way to clone a virtual machine that involves having VirtualBox simply note the differences between your original machine and its clone. This saves on hard drive space. We may or may not explore this option later in the course. </p>
<h2 id="networking-errors-after-migrating-an-appliance">Networking Errors after Migrating an Appliance</h2>
<p>If you move an appliance from one machine to another, you can sometimes find that networking will not work when you import the virtual machine on a new computer. If found that if you delete the following file, then reboot the system, it will work again:</p>
<pre><code>/etc/udev/rules.d/70-persistent-net.rules</code></pre>
<p>Frankly, I don't understand why this works, but only that it will work. Some notes I found online suggested it might have something to do with the new virtual MAC address for the imported appliance.</p>
<p>In particular, I tried ifconfig etho up, which should bring the ethernet connection up. Instead, I got this error:</p>
<pre><code>error while getting interface flags</code></pre>
<p>So I Googled around a bit and found that deleting the file mentioned above and rebooting fixed the problem.</p>
<h3 id="notes-on-creating-virtual-appliances-with-virtualbox">Notes on Creating Virtual Appliances with VirtualBox</h3>
<p>OVA files conform to a standard put together by the Distributed Management Task Force (DMTF) and is a variation of the more commonly cited Open Virtualization Format (OVF). OVF consists of multiple files, while an OVA file wraps them all in a single package, in particular, they use the TAR format, which is a bit like a zip file.</p>
<p>The format is designed to specify a single format that can be used by multiple virtual machines. Apparently it does use the VMWare VMDK format, but that is in fact an open format with a public specification. In an ideal world, OVA files could be used by VirtualBox, VMware, XEN, the Microsoft HyperVisor, etc. If you look at section 1.13 of the help for VirtualBox, you will find that they back off making such claims, at least for now. That is, however, the goal.</p>
<p>Evidently either the VMDK format or the OVA format or both, end up compressing files, as the resulting OVA file is smaller than the VDI file we start with.</p>
<p>Note that VirtualBox supports VDKM, VDI, and VHD files. VHD files are part of the Microsoft system virtual machines and can be mounted as a stand alone drive in Windows.</p>
<h2 id="screenshot">Taking Screen Shots of Linux Running in VirtualBox on a Windows Host</h2>
<p>Here is how I get screenshots. When I’m running VirtualBox, I find that my usually <strong>Alt-PrntScrn</strong> key doesn’t work right because VirtualBox swallows the keystroke. I’m therefore forced to put the focus on something else, such as a DOS box or a copy of NotePad, and then press <strong>PrntScrn</strong>. I end up with a huge bitmap that captures the output seen on both my monitors. I open Paint.Net, and press Ctrl-V, which opens up the bitmap of both monitors more or less automatically. (If I’m on a machine that is not dual screen, then my bitmap shows only one monitor.) Paint.NET has excellent tools for letting users make a selection, zoom in on the edges of the selection, use the mouse to adjust the selection to the pixel level, then press Ctrl-C to capture the selected area, Ctrl-N to create a new bitmap of exactly the right size, and Ctrl-V to paste in the bitmap of the user’s selection. I guess it sounds complicated, but it only takes a few seconds after you have done it once or twice.</p>
<h2 id="dhcp">VirtualBox DHCP</h2>
<p>The way it is at the start:</p>
<pre class="code"><code>C:\Program Files\Oracle\VirtualBox&gt;VBoxManage.exe list dhcpservers
NetworkName: HostInterfaceNetworking-VirtualBox Host-Only Ethernet Adaptert Adapter
IP: 192.168.56.100
NetworkMask: 255.255.255.0
lowerIPAddress: 192.168.56.101
upperIPAddress: 192.168.56.254
Enabled: Yes</code></pre>
<p>Now we add in our own DHCP server with the command &quot;all on one line&quot;:</p>
<pre class="code"><code>c:\program files\oracle\virtualbox\VBoxManage.exe&quot; dhcpserver add --netname intnet --ip 192.168.57.100 
--netmask 255.255.255.0 --lowerip 192.168.57.101 --upperip 192.168.57.254 --enable</code></pre>
<p>We issue the command as above, but here it is broken out so it is easier to read:</p>
<pre class="code"><code>vboxmanger dhcpserver add --netname intnet 
--ip 192.168.57.100 
--netmask 255.255.255.0 
--lowerip 192.168.57.101 
--upperip 192.168.57.254 
--enable</code></pre>
<p>When we are done, it looks like this:</p>
<pre class="code"><code>&quot;c:\program files\oracle\virtualbox\VBoxManage.exe&quot; list dhcpservers
NetworkName: HostInterfaceNetworking-VirtualBox Host-Only Ethernet Adapter
IP: 192.168.56.100
NetworkMask: 255.255.255.0
lowerIPAddress: 192.168.56.101
upperIPAddress: 192.168.56.254
Enabled: Yes

NetworkName: intnet
IP: 192.168.57.100
NetworkMask: 255.255.255.0
lowerIPAddress: 192.168.57.101
upperIPAddress: 192.168.57.254
Enabled: Yes</code></pre>
<p>In the VirtualBox settings, we turn to the Network page, and choose:</p>
<ol type="1">
<li><strong>Attached to</strong>:  Internal Network</li>
<li><strong>Name:</strong>:intnet</li>
<li><strong>Promiscuous Mode</strong>: Allow VMs</li>
</ol>
<p><a href="images/InternalNet01.png"><img src="images/InternalNet01Small.png" alt="Setting up the internal network" /></a></p>
<p><strong>Figure 02: Setting up the internal network</strong></p>
<h2 id="from-a-red-hat-video-it-process-institute">From a Red Hat Video (It Process Institute)</h2>
<p>Kurt Milne and Erich Morisse (Red Hat) <script type="text/javascript">
<!--
h='&#114;&#x65;&#100;&#104;&#x61;&#116;&#46;&#x63;&#x6f;&#x6d;';a='&#64;';n='&#x65;&#x6d;&#x6f;&#114;&#x69;&#x73;&#x73;&#x65;';e=n+a+h;
document.write('<a h'+'ref'+'="ma'+'ilto'+':'+e+'">'+e+'<\/'+'a'+'>');
// -->
</script><noscript>&#x65;&#x6d;&#x6f;&#114;&#x69;&#x73;&#x73;&#x65;&#32;&#x61;&#116;&#32;&#114;&#x65;&#100;&#104;&#x61;&#116;&#32;&#100;&#x6f;&#116;&#32;&#x63;&#x6f;&#x6d;</noscript>, <script type="text/javascript">
<!--
h='&#x69;&#116;&#112;&#x69;&#46;&#x6f;&#114;&#x67;';a='&#64;';n='&#x6b;&#x75;&#114;&#116;&#46;&#x6d;&#x69;&#108;&#110;&#x65;';e=n+a+h;
document.write('<a h'+'ref'+'="ma'+'ilto'+':'+e+'">'+'Kurt.milne@itpi.org'+'<\/'+'a'+'>');
// -->
</script><noscript>&#x4b;&#x75;&#114;&#116;&#46;&#x6d;&#x69;&#108;&#110;&#x65;&#64;&#x69;&#116;&#112;&#x69;&#46;&#x6f;&#114;&#x67;&#32;&#40;&#x6b;&#x75;&#114;&#116;&#46;&#x6d;&#x69;&#108;&#110;&#x65;&#32;&#x61;&#116;&#32;&#x69;&#116;&#112;&#x69;&#32;&#100;&#x6f;&#116;&#32;&#x6f;&#114;&#x67;&#x29;</noscript> Twitter: @KurtMilne</p>
<ul>
<li><a href="http://www.redhat.com/cloud/build">http://www.redhat.com/cloud/build</a></li>
<li><a href="http://www.redhat.com/cloudtour">http://www.redhat.com/cloudtour</a></li>
<li><a href="https://engage.redhat.com/forms/idc-cloud">https://engage.redhat.com/forms/idc-cloud</a></li>
</ul>
<p>We want to build cloud services, not just systems. Our goal is automate and improve IT solutions.</p>
<ul>
<li>Bottom Up (IT View)
<ul>
<li>Virtualize</li>
<li>Resource Pools</li>
<li>Automated Provision</li>
<li>Self-Service</li>
</ul></li>
<li>Top Down (Business View)
<ul>
<li>Business objects</li>
<li>Desired Benefits</li>
<li>Constraints</li>
<li>Cloud Goals</li>
</ul></li>
</ul>
<p>He recommends starting with business objectives and working down to the IT area, but the other guy likes the idea of working from both ends at once.</p>
<p> </p>
<p>Physical virtual private cloud plublic cloud</p>
<ul>
<li>Obvious Factors to Care About;
<ul>
<li>Service Quality</li>
<li>Scalability</li>
<li>Cost</li>
<li>Security and Compliances</li>
</ul></li>
<li>Not so Obvjous
<ul>
<li>Avoid lock in</li>
<li>Life cycle phase</li>
<li>Dependencies</li>
<li>Ecosystem - what are the cloud services that are plugged into their solution without having to worry about integration</li>
</ul></li>
</ul>
<p>You do some planning first, but then you have to start doing some exploration.</p>
<p>Make sure you don't over do it. Plan to succeed. Don't take on too much, and don't lock yourself in.</p>
<h4 id="proof-of-concept-poc">Proof of Concept (POC)</h4>
<p>Build a Lighthouse application, is the proof of concept to prove that things actually work. Is the cloud real?</p>
<p>Put together a test and dev environment. Build a lamp stack, or what have you.</p>
<p>Hardware is often not utilized. We use 20 Percent from a machine, but if you virtualize, then people are really using the full 100% of a server.</p>
<ul>
<li>Business sees great agility, scalability and availability</li>
<li>IT sees greater efficiency, utilization, automation and standardization</li>
</ul>
<p>Evaluate and then move to Proof of Concept</p>
<p>Build on existing solutions.</p>
<h2 id="sharing-the-clipboard">Sharing the ClipBoard</h2>
<p>In the settings for your VM. Go to:</p>
<ul>
<li> General | Advanced | Shared Clipboard: Bidirectional</li>
</ul>
</article>
	<footer>

		<p>Copyright &copy; <a href="../../index.html">Charlie Calvert</a> |
		<a href="../../index.html">Elvenware Home</a> |
		<a href="../index.html">Writing Code</a> |
		<a href="../delphi/index.html">Delphi</a> |
		<a href="../csharp/index.html">CSharp</a> |
		<a href="../../books/index.html">My Books</a> </p>
	</footer>
</div>

</body>
</html>



