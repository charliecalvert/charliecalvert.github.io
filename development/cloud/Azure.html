<!DOCTYPE html>
<html dir="ltr">

<!-- #BeginTemplate "../../Elvenware.dwt" -->

<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type" />
<!-- #BeginEditable "doctitle" -->
<title>Elvenware Azure</title>
<!-- #EndEditable -->
<meta content="width=device-width,minimum-scale=1.0,maximum-scale=1.0" name="viewport" />
<link href="/charlie/libs/css/style2.css" rel="stylesheet" title="style2" type="text/css" />
<link href="/charlie/libs/jquery-ui/jquery-ui.css" rel="stylesheet" type="text/css" />
<script src="/charlie/libs/scripts/jquery.min.js" type="text/javascript"></script>
<script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.10.3/jquery-ui.min.js" type="text/javascript"></script>
<script src="/charlie/libs/scripts/elvenware.js" type="text/javascript"></script>
<!-- #BeginEditable "docScripts" -->

<!-- #EndEditable -->
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-2806409-2']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
</head>

<body>

<div id="container">
	<header>
		<div class="navButton" onclick="elvenware.toggleMenu()">
			Toggle Menu</div>
		<h1>Charlie Calvert on Elvenware</h1>
		<h2>Writing Code and Prose on Computers</h2>
	</header>
	<nav>
		<h2>Menu</h2>
		<div id="accordion00">
		<h2 class="navSection01">Core Code</h2>
			<ul>
				<li><a href="../index.html">Strongly Typed</a></li>
				<li><a href="../web/index.html">Web &amp; Scripts</a></li>
				<li><a href="index.shtml">Cloud</a></li>
			</ul>
		
			<h2 class="navSection02">OS and Tools</h2>
			<ul>
				<li><a href="../../os/index.html">OS</a></li>
				<li><a href="../database/index.html">Database</a></li>
				<li><a href="../../books/index.html">My Writing</a></li>
			</ul>
			
		
			<h2 class="navSection03">Art</h2>
			<ul>
				<li><a href="../../Art/index.html">Poems &amp; Photos</a></li>
				<li><a href="../../books/reading/index.html">Book Reviews</a></li>
				<li><a href="../../spirit/index.html">Spiritual</a></li>
			</ul>
			<h2 class="navSection04">Links</h2>
			<ul>
				<li><a href="../../links.html">My Links</a></li>
				<li><a href="http://www.falafel.com/">Falafel</a></li>
				<li><a href="http://sourceforge.net/projects/elvenware/">Sourceforge</a></li>
			</ul>
		</div>
	</nav>
	<article>
		<figure>
			<img alt="Elvenware" src="../../images/elvenwarelogo.png" /></figure>
		<!-- #BeginEditable "body" -->
		<div>
			<h1 id="azureOnElvenwareV">Azure on Elvenware V</h1>
			<p>This page covers Windows Azure and related subjects.</p>
			<h3>Index</h3>
			<ul>
				<li><a href="#installTips">Install Tips</a></li>
				<li><a href="#installNodeJS">Install NodeJS</a></li>
				<li><a href="#phpInstall">Php Install</a></li>
				<li><a href="#pythonInstall">Python Install</a></li>
				<li><a href="#platforms">Platforms</a></li>
				<li><a href="#c#">C#</a></li>
				<li><a href="#nodeJs">NodeJs</a></li>
				<li><a href="#uUID">UUID</a></li>
				<li><a href="#debuggingYourServerSideCode">Debugging Your Server 
				Side Code</a></li>
				<li><a href="#workingOnLinux:">Working on Linux:</a></li>
				<li><a href="#runningNodeFromNotePad++">Running Node from NotePad++</a></li>
				<li><a href="#pHP">PHP</a></li>
				<li><a href="#python">Python</a></li>
				<li><a href="#runningPythonOnAzure">Running Python on Azure</a></li>
				<li><a href="#usingVirtualMachines">Using Virtual Machines</a></li>
				<li><a href="#usingSteveMarxsSolution">Using Steve Marx's Solution</a></li>
				<li><a href="#expressAndJade">Express and Jade</a></li>
				<li><a href="#storageAndSQLAzure">Storage and SQL Azure</a></li>
			</ul>
			<p>Azure is Miscrosoft's cloud development platform. Like Amazon Web 
			Services and other tools, there are several different services, ranging 
			from storage, to VMs to platforms for installing applications.</p>
			<p>Here are links to key areas in the Azure world:</p>
			<ul>
				<li>Main Site: <a href="https://www.windowsazure.com/en-us/">https://www.windowsazure.com/en-us/</a></li>
				<li>Azure Console: <a href="https://windows.azure.com/">https://windows.azure.com/</a>
				</li>
				<li>Developer platform installs:
				<a href="https://www.windowsazure.com/en-us/develop/overview/">https://www.windowsazure.com/en-us/develop/overview/</a></li>
				<li>90 Day free Trial:
				<a href="https://www.windowsazure.com/en-us/pricing/free-trial/">
				https://www.windowsazure.com/en-us/pricing/free-trial/</a></li>
				<li>Pricing:
				<a href="https://www.windowsazure.com/en-us/pricing/calculator/">
				https://www.windowsazure.com/en-us/pricing/calculator/</a></li>
			</ul>
			<p>As with Amazon, you need an account and a credit card to start working 
			in this world. There is a three month free trial available. Again like 
			Amazon, you probably already have an account with Microsoft, but you 
			will need to configure it to use the Azure services.</p>
			<h2 id="installTips">Install Tips</h2>
			<p>Using the
			<a href="http://www.microsoft.com/web/downloads/platform.aspx">Microsoft 
			Web Platform Installer</a>, make sure you have the latest
			<a href="https://www.windowsazure.com/en-us/develop/net/">Windows Azure 
			SDK for .NET and the Visual Studio Tools</a>. This will give you the
			</p>
			<ul>
				<li>Azure SDK</li>
				<li>The Azure Emulator</li>
				<li>IIS ASP.NET, .NET, ISAP, HTTP, MVC3</li>
				<li>Visual Studio Tools</li>
			</ul>
			<p>
			<img alt="Azure SDK .NE Install" class="leaveAlone" src="images/Azure01.png"></p>
			<p><strong>Figure 01: Installing the Windows Azure SDK for .NET with 
			the Web Platform Installer</strong></p>
			<p><a href="images/Azure02.png"><span>
			<img alt="The success screen for the Azure .net Install" class="leaveAlone" src="images/Azure02Small.png"></span></a></p>
			<p><strong>Figure 02: The Successful Install of Azure for .NET and VS</strong></p>
			<p>When you are done, you should be able to choose File | New Project 
			ASP.NET Web Application in Visual Studio, open the Project Manager, 
			right click on your projects main node (WebApplication1) and select
			<strong>Add Windows Azure deployment project</strong>.</p>
			<p>While you have the Web Installer open, there are other tools that 
			you want to install. Two of the most important are the Python Tools 
			for Visual Studio and the Windows Azure SDK for NodeJS. These installs 
			include IIS Node and the Node Package Manager.</p>
			<p><a href="images/Azure03.png"><span>
			<img alt="Python tools for Visual Studio and Node JS Support" class="leaveAlone" src="images/Azure03Small.png"></span></a></p>
			<p><strong>Figure 03: Python tools for Visual Studio and Windows Azure 
			SDK for Node JS Support</strong></p>
			<p><a href="images/Azure04.png"><span>
			<img alt="Python Tools for VS and NodeJS for Azure Success Screen" class="leaveAlone" src="images/Azure04Small.png"></span></a></p>
			<p><strong>Figure 04: Python Tools for VS and NodeJS for Azure Success 
			Screen</strong></p>
			<p>When looking at the Web Platform Installer, you probably noticed 
			that there is an option to install Visual Studio Service Pack 1. In 
			many cases, if you check the about screen for Visual Studio, you will 
			find that you already have SP1 installed, even though this option is 
			available in the Web Platform Installer. My opinion is that you are 
			all set so long as you have Visual Studio SP1 installed. If, however, 
			you feel a strong need to glog up your system with additional useless 
			DLLs and tools, you can select this option in the Web Platform Installer. 
			When the procedure completes, you will be greeted with the following 
			rather depressing list of tools that are now making your system run 
			even slower than it was. When you go back to the Web Platform Installer, 
			you will find, of course, that you are still told that you have not 
			installed VS SP1. Thank you so very much! None of this is meant to discourage 
			you from installing SP1, which is, of course, an essential and very 
			valuable tool.</p>
			<p><a href="images/Azure05.png"><span>
			<img alt="Visual Studio SP1 Effluvia" class="leaveAlone" src="images/Azure05Small.png"></span></a></p>
			<p><strong>Figure 5: Visual Studio SP1 Effluvia.</strong></p>
			<h3 id="installNodeJS">Install NodeJS</h3>
			<p>You will also need to install the Windows Azure SDK for NodeJS:</p>
			<p><a href="https://www.windowsazure.com/en-us/develop/nodejs/">https://www.windowsazure.com/en-us/develop/nodejs/</a></p>
			<p>Here is what the Platform Installer looks like if you have successfully 
			installed this product.</p>
			<p>
			<img alt="Windows Azure SDK for NodeJS" class="leaveAlone" src="images/Azure06.png"></p>
			<p><strong>Figure 06: Windows Azure SDK for NodeJS</strong></p>
			<h3 id="phpInstall">Php Install</h3>
			<p>Installing PHP for Azure is a bit different. The install is on CodePlex, 
			and all you will need to download is a zip file:</p>
			<p><a href="http://phpazure.codeplex.com/">http://phpazure.codeplex.com/</a></p>
			<p>There are set of five directories in the zip file:</p>
			<p>
			<img alt="Azure install for PHP" class="leaveAlone" src="images/Azure07.png"></p>
			<p>You should copy this 22 MB of files to some well known location on 
			your hard drive. As always, make sure there are no spaces in the path 
			to your folder. It is all right if you folder itself has a complex name 
			with no spaces, such as: <strong>
			<a href="file:///J:\Src\PHPAzure-4.1.0">J:\Src\PHPAzure-4.1.0</a></strong>. 
			You will notice that this SDK is made by a company called RealdolMan, 
			and sponsored by Microsoft. As a result, I suppose it has only semi-official 
			status, but so far I have found it be quite professional.</p>
			<h3 id="pythonInstall">Python Install</h3>
			<p>The
			<a href="http://blog.smarx.com/posts/tutorial-running-a-python-web-application-in-windows-azure">
			Python install for Azure</a>, on the other hand, is without official 
			sanction from Microsoft. Nevertheless, it does not really differ so 
			greatly in its fundamentals from the PHP install. The simplest way to 
			install the product is to be sure you have a
			<a href="http://git-scm.com/downloads">GitHub client</a> of some kind, 
			links are available for that client at the bottom of this document. 
			Then you can paste in the following URL and pull down the files:</p>
			<ul>
				<li><strong>git://github.com/smarx/pythonrole</strong></li>
				<li><strong>https://github.com/smarx/pythonrole.git</strong></li>
			</ul>
			<p>Otherwise, you can just go here, and download the zip file:</p>
			<p><a href="https://github.com/smarx/pythonrole">https://github.com/smarx/pythonrole</a></p>
			<p>
			<img alt="Azure Install for Python from GitHub using GitGui" class="leaveAlone" src="images/Azure08.png"></p>
			<p>For Python, you will also want to be sure you have installed easy-install, 
			pip, flask, virtualenv and rocket. You should also install the Python 
			tools for Windows Azure Storage</p>
			<ul>
				<li>
				<a "&gt;https://github.com/sriramk/winazurestorage&lt;/a&gt;&lt;/li&gt;
 &lt;li&gt;For use in GIT: &lt;strong&gt;https://github.com/sriramk/winazurestorage.git&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;img class='leaveAlone' src=" /github.com="" alt="Git on Azure" href="http://www.elvenwa/charlie/development/web/Python/install.html#easyins/charlie/development/web/Python/install.html#easyinstall&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href=" https:="" images/azure09.png"="">
				<p></p>
				<h2 id="platforms">Platforms</h2>
				<p>There are four languages with top level support on Azure: C#, 
				NodeJS, PHP and Java. I have also found a way to run Python on Azure, 
				though it does not enjoy official support.</p>
				<h3 id="c#">C#</h3>
				<ul>
					<li>Overview: </a>
					<a href="http://msdn.microsoft.com/en-us/windowsazure/wazplatformtrainingcourse_windowsazure_unit">
					http://msdn.microsoft.com/en-us/windowsazure/wazplatformtrainingcourse_windowsazure_unit</a></li>
					<li>.NET install:
					<a href="https://www.windowsazure.com/en-us/develop/net/">https://www.windowsazure.com/en-us/develop/net/</a></li>
					<li>Quick Start:
					<a href="http://msdn.microsoft.com/en-us/library/gg663908.aspx">
					http://msdn.microsoft.com/en-us/library/gg663908.aspx</a></li>
					<li>Code Samples:
					<a href="http://code.msdn.microsoft.com/windowsazure/">http://code.msdn.microsoft.com/windowsazure/</a>
					</li>
					<li>C# CGI in IIS:
					<a href="http://chalaki.com/8-steps-program-install-setup-call-csharp-cgi-programs-in-iis-7/321/">
					http://chalaki.com/8-steps-program-install-setup-call-csharp-cgi-programs-in-iis-7/321/</a>
					</li>
				</ul>
				<h3 id="nodeJs">NodeJs</h3>
				<ul>
					<li>SDK Download:
					<a href="https://www.windowsazure.com/en-us/develop/nodejs/">
					https://www.windowsazure.com/en-us/develop/nodejs/</a> </li>
					<li>Azure Tutorial:
					<a href="https://www.windowsazure.com/en-us/develop/nodejs/tutorials/getting-started/">
					https://www.windowsazure.com/en-us/develop/nodejs/tutorials/getting-started/</a></li>
					<li>Node JS Home: <a href="http://nodejs.org/">http://nodejs.org/</a></li>
					<li>Guide: <a href="http://nodeguide.com/">http://nodeguide.com/</a>
					</li>
					<li>API Reference: <a href="http://nodejs.org/api/">hhttp://nodejs.org/api/</a>
					</li>
				</ul>
				<p>Start a NodeJs Powershell in Adminstrator mode by right clicking 
				on the following link and choosing <strong>Run as administrator</strong>:</p>
				<p><strong>Start | All Programs | Windows Azure SDK for NodeJs | 
				Windows Azure Powershell for Node JS</strong></p>
				<p>Switch to the drive where you store your source code. Assuming 
				you want to place your node js code at the root of the drive you 
				should type</p>
				<pre>
mkdir \nodejs
cd \nodejs
New-AzureService webroles
Add-AzureNodeWebRole WebRole01
cd WebRole01
notepad++ server.js</pre>
				<p>Here is the code you should place in server.js:</p>
				<pre>var http = require('http');
var port = process.env.port || 1337;
var server = http.createServer(function (req, res) {
 res.writeHead(200, { 'Content-Type': 'text/html' });
 res.write('&lt;h1&gt;BarBar&lt;/h1&gt;');
 res.end('&lt;p&gt;Hello HTTP from the JSNode\n&lt;/p&gt;');
})

server.listen(port);</pre>
				<p>If you prefer slightly more valid HTML, then write this instead:</p>
				<pre>var http = require('http');
var port = process.env.port || 1337;
var server = http.createServer(function (req, res) {
 res.writeHead(200, { 'Content-Type': 'text/html' });
 res.write('&lt;!DOCTYPE html&gt;\n');
 res.write('&lt;html&gt;\n');
 res.write('&lt;head&gt;\n&lt;title&gt;WebRole01&lt;/title&gt;\n&lt;/head&gt;\n');
 res.write('&lt;body&gt;\n');
 res.write('\t&lt;h1&gt;BarBar&lt;/h1&gt;\n');
 res.write('\t&lt;p&gt;Hello HTTP from the JSNode&lt;/p&gt;\n');
 res.write('&lt;/body&gt;\n');
 res.end('&lt;/html&gt;');
})

server.listen(port);</pre>
				<p>Now start the Azure Emulator:</p>
				<pre>Start-AzureEmulator -launch</pre>
				<p>The entire session looks a bit like this:</p>
				<pre>
PS C:\&gt; mkdir nodejs
 Directory: C:\
Mode LastWriteTime Length Name
---- ------------- ------ ----
d---- 6/4/2012 3:48 PM nodejs

PS C:\&gt; <strong><span>cd .\nodejs</span></strong>
PS C:\nodejs&gt; <strong><span>New-AzureService webroles</span></strong>

Service has been created at C:\nodejs\webroles

PS C:\nodejs\webroles&gt; <strong><span>Add-AzureNodeWebRole WebRole01</span></strong>

Role has been created at C:\nodejs\webroles\WebRole01. For easy access to Windows Azure services fr
om your application code, install the Windows Azure client library for Node.js by running ‘npm inst
all azure’.

PS C:\nodejs\webroles&gt; cd .\WebRole01
PS C:\nodejs\webroles\WebRole01&gt; <strong><span>notepad++ .\server.js</span></strong>

C:\nodejs\webroles\WebRole01&gt;&quot;c:\Program Files (x86)\Notepad++\notepad++.exe&quot; .\server.js
PS C:\nodejs\webroles\WebRole01&gt; <strong><span>Start-AzureEmulator -launch</span></strong>

Creating local package...
Starting Emulator...
Role is running at http://127.0.0.1:81
Started
PS C:\nodejs\webroles\WebRole01&gt;;</pre>
				<p>You can now use the icon on the taskbar to shutdown the emulator. 
				The next step is to publish the service to Azure itself.</p>
				<pre>
Get-AzurePublishSettings </pre>
				<p>Save the settings to your hard drive:</p>
				<p>
				<img alt="Azure Note Credentials" class="leaveAlone" src="images/AzureNode.png"></p>
				<p>Now import the settings. Below you can see a call to Import-AzurePublishSettings 
				where the parameter is the name of the settings file that I downloaded. 
				You can delete or store secretly the file after you download it. 
				The second call actually publishes the service under the name Elvenware001.</p>
				<pre>Import-AzurePublishSettings .\CharlieCred.publishsettings
Publish-AzureService -Location &quot;North Central US&quot; -Name Elvenware001</pre>
				<h3 id="uUID">UUID</h3>
				<p>Start by opening a command prompt at the root of your project 
				and typing this command:</p>
				<div>
					<p><strong>npm install node-uuid</strong></p>
				</div>
				<div>
					<p>Then create the following program:</p>
				</div>
				<pre>var http = require('http');<br><strong><span>var uuid = require('node-uuid');</span></strong><b><br></b>



var port = process.env.port || 1337;<br> &nbsp;var server = http.createServer(function (req, res) {<br> &nbsp; res.writeHead(200, { 'Content-Type': 'text/html' });<br> &nbsp; res.write('&lt;!DOCTYPE html&gt;\n');<br> &nbsp; res.write('&lt;html&gt;\n');<br>
&nbsp;res.write('&lt;head&gt;\n&lt;title&gt;UUID Demo&lt;/title&gt;\n&lt;/head&gt;\n');<br>
&nbsp;res.write('&lt;body&gt;\n');<br> &nbsp; res.write('\t&lt;h1&gt;UUID Generation&lt;/h1&gt;\n');<br>
&nbsp;res.write('\t&lt;p&gt;' + <strong><span>uuid.v4()</span></strong> + '&lt;/p&gt;\n');<br>
&nbsp;res.write('&lt;/body&gt;\n');<br> &nbsp; res.end('&lt;/html&gt;');<br> &nbsp;})
server.listen(port); </pre>
				<p>Run the program in node and in the browser you will see something 
				like this:</p>
				<pre>
UUID Generation
63163d6b-ce4d-4a14-86d3-28721f6106e6 </pre>
				<p>I have placed a sample program like the one quoted above in AndElf 
				in the folder Python/AzureRelated.</p>
				<h3 id="debuggingYourServerSideCode">Debugging Your Server Side 
				Code</h3>
				<p>You can debug your server side code in Eclipse. Here is how to 
				proceed:</p>
				<ul>
					<li>Start Eclipse and optionally set up your project to run 
					in it. You don't actually have to set up the project to run 
					Node from the IDE, but if you want, you can set everything else 
					up.</li>
					<li>Choose Help | Install New Software</li>
					<li>Press the Add button</li>
					<li>Enter this address: <strong>http://chromedevtools.googlecode.com/svn/update/dev/</strong></li>
					<li>Choose to install the <strong>Google Chrome Developer Tools</strong></li>
					<li>Chrome will restart</li>
					<li>Go to the command prompt and run your program in Node with 
					the Debug switch:</li>
					<li><code><span>node --debug server.js // See Figure D01</span></code></li>
					<li>In Eclipse, switch to the Debug perspective. (<strong>Window 
					| Open Perspective | Other | Debug</strong>)</li>
					<li>Choose <strong>Run | Debug Configurations</strong> from 
					the menu</li>
					<li>Select <strong>Standalone V8 Vm</strong></li>
					<li>Click the plus button to get a new configuration</li>
					<li>Call it <strong>Server on Port 5858</strong></li>
					<li>Set the Host to <strong>localhost</strong> and the port 
					to <strong>5858</strong></li>
					<li>Press Apply to save your work // See Figure D02</li>
					<li>Click the <strong>Debug</strong> button</li>
					<li>In the project explorer find the source for the file you 
					want to debug. Look carefully at shots D04 and D05. Notice that 
					I'm opening a file with a long name and lots of underscore characters. 
					I picked this file from the Project Explorer or Script Explorer 
					-- I believe either one will work.</li>
					<li>Open the program in a browser: <strong>
					<a href="http://localhost:3000">http://localhost:3000</a> //
					</strong>Figure D03</li>
					<li>Put a break point on one of your methods, such as
					<strong>request // </strong>Figure D04. If you have trouble 
					setting a breakpoint using the tools, go into your source code, 
					write the command <strong>debugger; </strong>in your source 
					at the place where you want to stop, and then restart your debug 
					session.</li>
					<li>Do something in the browser that will fire the call to
					<strong>request</strong> </li>
					<li>Check Eclipse: you should be at the breakpoint. // Figure 
					D05</li>
					<li>When you are done, you should right click on the project 
					and close it. Either that, or make sure you are running node 
					in Debug mode (Figure D01) when you next open Eclipse. If you 
					don't do one of these two things, you may get a lot of errors 
					when you open Eclipse. If you do get the errors, right click 
					and close the project and restart Eclipse. Yea, I know, it is 
					pretty funky: but it does work if you baby it along some.</li>
				</ul>
				<p>
				<img alt="Starting node in debug mode" class="leaveAlone" src="images/Node01.png"></p>
				<p><strong>Figure D01: Starting node in debug mode</strong></p>
				<p>
				<img alt="Setting up the debug Run Configuration" class="leaveAlone" src="images/Node02.png"></p>
				<p><strong>Figure D02: Setting up the debug run configuration</strong></p>
				<p>
				<img alt="Running your script in the browser" class="leaveAlone" src="images/Node03.png"></p>
				<p><strong>Figure D03: Running the program in a browser</strong></p>
				<p><a href="images/Node04.png"><span>
				<img alt="Setting the breakpoint in your source" class="leaveAlone" src="images/Node04Small.png"></span></a></p>
				<p><strong>Figure D04: Setting a breakpoint. Click to expand</strong></p>
				<p>If you are not able to set the breakpoint by double clicking 
				or right clicking in the gutter on the far left of the IDE, then 
				you can instead insert a breakpoint with code by inserting the word
				<strong>debugger</strong>:</p>
				<pre>sdb.listDomains(function(error, result, meta) {
 if( error ) {
 res.send('listDomains failed: '+ error.Message );
 }
 else {
<strong><span>debugger</span></strong>;
 res.send(result);
 }
});</pre>
				<p>You should enter this breakpoint not in your original source 
				code file, but in the one with the funny long name. You will be 
				asked to make the file writable, and you should choose yes. Then 
				right click, choose <strong>V8 Debugging | Push Changes to VM.</strong> 
				Do something in the browser to cause the line of code you want to 
				execute to be activated, and your program will stop as expected 
				when it hits the word <strong>debugger</strong>. You can also put 
				this word in your original source file, but that seems like an even 
				more unwieldy solution.</p>
				<p>Figure D05 shows what it looks like when you hit a breakpoint 
				set with the IDE tools. It will look the same if you manually enter 
				the word <strong>debugger</strong> in the source, except of course 
				there will be an extra line of code where you entered the word that 
				set the breakpoint:</p>
				<pre>&nbsp;else {
<strong><span>debugger</span></strong>;
 res.send(result);
 }</pre>
				<p><a href="images/Node05.png"><span>
				<img alt="Hitting a breakpoint in your server side code." class="leaveAlone" src="images/Node05Small.png"></span></a></p>
				<p><strong>Figure D05: Hitting a breakpoint in your server side 
				code. Click to expand</strong></p>
				<p>
				<img alt="Error you get if you don't have node running in debug mode." class="leaveAlone" src="images/Node06.png"></p>
				<p><strong>Figure D06: Error you get if you don't have node running 
				in debug mode. (See Figure D01.)</strong></p>
				<p>When looking at Figure D05, note that the <strong>Expressions</strong>,
				<strong>Breakpoints</strong> and <strong>Variables</strong> windows 
				are all visible. We are inspecting the variable called result in 
				both the <strong>Variables </strong>and the <strong>Expressions</strong> 
				windows.</p>
				<p>Reference:
				<a href="https://github.com/joyent/node/wiki/Using-Eclipse-as-Node-Applications-Debugger">
				https://github.com/joyent/node/wiki/Using-Eclipse-as-Node-Applications-Debugger</a></p>
				<h3 id="workingOnLinux:">Working on Linux:</h3>
				<p>You can install Node like this:</p>
				<pre>sudo apt-get install nodejs
sudo apt-get install npm</pre>
				<p>That might not be the most recent nodejs. If that is hte case, 
				then go here:</p>
				<pre>https://github.com/joyent/node/wiki/Installing-Node.js-via-package-manager</pre>
				<p>If you need to do file difs, use Meld.</p>
				<h3 id="runningNodeFromNotePad++">Running Node from NotePad++</h3>
				<p>You can run your Node programs directly from Notepad++:</p>
				<ul>
					<li>Select <strong>Run | Run</strong> from the menu</li>
					<li>Using quotes around any paths that contain spaces, type 
					in the path to node and a macro that points to your main script 
					file:</li>
					<li>&quot;C:\Program Files (x86)\nodejs\node.exe&quot; &quot;$(FULL_CURRENT_PATH)&quot;</li>
					<li>Save the command under a name like MyProgram. Specify a 
					shortcut like Ctrl + F5</li>
					<li>Now you can run your program directly from NotePad++. At 
					any rate, its starts <strong>Node</strong>, and then you can 
					browse to <a href="http://localhost:3000">http://localhost:3000</a> 
					or something similar to use the program.</li>
				</ul>
				<p>Notice that NotePad++ starts up a blank command window that runs 
				your instance of Node. This like the way Node starts, and then seems 
				to &quot;hang&quot; when you run it from the command line. When 
				you are done, you can Alt-Tab to this window and press Ctrl-C to 
				close it.</p>
				<h2 id="pHP">PHP</h2>
				<ul>
					<li>SDK Download: <a href="http://phpazure.codeplex.com/">http://phpazure.codeplex.com/</a></li>
					<li>Docs:
					<a href="http://azurephp.interoperabilitybridges.com/">http://azurephp.interoperabilitybridges.com/</a></li>
					<li>QuickStart:
					<a href="http://azurephp.interoperabilitybridges.com/articles/build-and-deploy-a-windows-azure-php-application">
					http://azurephp.interoperabilitybridges.com/articles/build-and-deploy-a-windows-azure-php-application</a>
					</li>
					<li>SQL Azure from PHP:
					<a href="http://msdn.microsoft.com/en-us/library/windowsazure/ff394110.aspx">
					http://msdn.microsoft.com/en-us/library/windowsazure/ff394110.aspx</a></li>
				</ul>
				<h2 id="python">Python</h2>
				<ul>
					<li>Install: <a href="https://github.com/smarx/pythonrole">https://github.com/smarx/pythonrole</a></li>
					<li>Install Instructions:
					<a href="http://blog.smarx.com/posts/tutorial-running-a-python-web-application-in-windows-azure">
					http://blog.smarx.com/posts/tutorial-running-a-python-web-application-in-windows-azure</a></li>
					<li>Windows Azure for Python:
					<a href="http://pypi.python.org/pypi/windowsazure/0.1.1">http://pypi.python.org/pypi/windowsazure/0.1.1</a></li>
					<li>Azure Storage:
					<a href="https://github.com/sriramk/winazurestorage">https://github.com/sriramk/winazurestorage</a></li>
					<li>Flask Docs: <a href="http://flask.pocoo.org/docs/">http://flask.pocoo.org/docs/</a></li>
					<li>Flask QuickStart:
					<a href="http://flask.pocoo.org/docs/quickstart/#quickstart">
					http://flask.pocoo.org/docs/quickstart/#quickstart</a></li>
					<li>Larger Applications:
					<a href="http://flask.pocoo.org/docs/patterns/packages/">hhttp://flask.pocoo.org/docs/patterns/packages/</a></li>
				</ul>
				<p>To get started, make sure have installed Flask,
				<a href="http://www.virtualenv.org/en/latest/index.html">Virtual 
				Env</a>, etc:</p>
				<p>You should also have the most recent files
				<a href="Mercurial.html">AndElf Mercurial</a>. </p>
				<p>Copy the Python\AzureRelated\AdditionSqlite project to a directory 
				on your system. Open a command prompt and Navigate to that folder 
				and create virtual environment by typing v<strong>irtualenv venv</strong>:</p>
				<pre>J:\Src\PyDevProjects\AdditionSqlite&gt;<strong><span>virtualenv venv</span></strong>
New python executable in venv\Scripts\python.exe
Installing setuptools................done.done.
InsInstalling pip...................done.</pre>
				<p>You can see that I have a copy of AdditionSqlite in a directory 
				on my J drive. You may have installed it somewhere else, but the 
				rest of the command shown above should look about the same on your 
				system. If something goes wrong, that probably means that you don't 
				have virtual environment installed, or else your <strong>C:\Python27\Scripts</strong> 
				folder is not on your path.</p>
				<p>Your virtual environment contains a local copy of your Python 
				installation, just as it will be configured on Windows Azure. That 
				ensures two things:</p>
				<ul>
					<li>You have Python installed on Azure</li>
					<li>It is the same version of Python that you are expecting</li>
					<li>Your copy of Python is configured exactly as you expect</li>
				</ul>
				<p>In short, Virtual Environment gives you the chance to configure 
				your machine in quite specific ways without actually changing any 
				of the global settings on your machine.</p>
				<p>Start the virtual environment:</p>
				<pre>J:\Src\PyDevProjects\AdditionSqlite&gt;venv\Scripts\activate
<strong><span>(venv)</span></strong> J:\Src\PyDevProjects\AdditionSqlite&gt;</pre>
				<p>Notice the (<strong>venv</strong>) inserted before your command 
				prompt. This shows that you are running inside your virtual environment. 
				Now install Flask into the Python installation for your virtual 
				environment:</p>
				<pre>(venv) J:\Src\PyDevProjects\AdditionSqlite&gt;pip install Flask </pre>
				<p>Flask is a fairly complex tool that gives you three great tools:</p>
				<ul>
					<li>A light weight web server called Werkzeug. (Should not conflict 
					with running instances of IIS or Apache.)</li>
					<li>A template engine called Jinja2 for manipulating HTML</li>
					<li>Flask, a library for writing Python web applications</li>
				</ul>
				<p>Now you should have the virtual environment configured properly 
				and you are ready to run the program by typing <strong>python runserver.py</strong>:</p>
				<pre><strong><span>(venv)</span></strong> J:\Src\PyDevProjects\AdditionSqlite&gt;<strong><span>python runserver.py</span></strong>
* Running on http://127.0.0.1:5000/7.0.0.1:50* Restarting with reloader</pre>
				<p>Now you are ready to actually run the program. Fire up a browser 
				and navigate to the url provided at your command prompt:</p>
				<p><a href="http://127.0.0.1:5000">http://127.0.0.1:5000</a></p>
				<p>Or, to say the same thing in human readable format:</p>
				<p><a href="http://localhost:5000">http://localhost:5000</a></p>
				<p>You are now browsing to the AdditionSqlite program using the 
				Wekzeug web server. The presence of this web server should not conflict 
				with existing running installs of IIS or Apache. Try the following 
				URLs to see how the program works:</p>
				<ul>
					<li><a href="http://localhost:5000/show">http://localhost:5000/show</a></li>
					<li><a href="http://localhost:5000/add">http://localhost:5000/add</a></li>
					<li><a href="http://localhost:5000/show">Call show again</a></li>
				</ul>
				<p>The second time you call show you should see a new row has been 
				inserted in the Sqlite database from which the program is pulling 
				data.</p>
				<p>When you are done exploring the program, you can press
				<strong>CTRL-C</strong> at the command prompt to close the Web Server. 
				To exit the virtual environment, type <strong>deactivate</strong> 
				at the command prompt.</p>
				<h3 id="runningPythonOnAzure">Running Python on Azure</h3>
				<p><strong>NOTICE</strong>: <em>As Microsoft rolls out there new 
				tools for Azure, it is becoming clear that we will have an alternative 
				to the Azure Emulator and the Azure Cloud Services. Instead of using 
				Cloud Services, which is a <b>Platform as a Service</b> model, we 
				can use the Azure virtual machines, which is an <b>Infrastructure 
				as a Servic</b>e model. Azure virtual machines is still in beta, 
				but it works fairly well, and it is similar to AWS, so it should 
				be easy for you to use, or at least easy for you to understand from 
				a conceptual point of view. You can create an instance of Windows 
				Server or Linux on Azure, and install your program onto that instance. 
				Just as on AWS, you need to take a moment to open the ports to let 
				your program through. On Azure, this means opening endpoints, and 
				you want to open port 9000 for Python and port 3000 for node, though 
				of course you can run your programs on whatever port you want, including 
				port 80. Because you can run your programs directly in the Azure 
				virtual machine, this means that you are nearly done writing code 
				if you want to use this option rather than Azure Cloud service. 
				Please note: to use Python on Azure you should use </em><strong>
				<i>Rocket</i></strong><em> rather than </em><strong><i>Werkzeug</i></strong><em>; 
				read the next view paragraphs to see the simple technique for transforming 
				your Werkzueg code into a Rocket code.</em></p>
				<p>So now you have the program, such as it is, running locally. 
				The next step is to try it in the Azure Cloud Services emulator. 
				To begin, find the copy of the Python Tools for Azure that you downloaded 
				earlier. Though you can work directly in the GIT repository, you 
				should probably copy the entire (small) folder to a new location. 
				Navigate to the WorkerRole\app directory in the Python Azure tools 
				and paste in the contents of AdditionSqlist directory, but without 
				the virtual environment folder:</p>
				<p>
				<img alt="The app directory just before running on the Azure emulator" class="leaveAlone" src="images/AzurePython10.png"></p>
				<p><strong>Figure P01: The app directory just before running on 
				the Azure emulator. Notice that I have not copied the venv folder.</strong></p>
				<p>We do not copy the virtual environment folder because the Python 
				Azure tools will set that up for us autamatically when it is needed. 
				Before we run the program, you should edit <strong>runserver.py.</strong> 
				You can see this file in Figure P01. It is a very small text file. 
				All you need to do is uncomment the references to Rocket:</p>
				<pre>import os
<strong><span>from rocket import Rocket</span></strong>
from packme import app import app


if __if __name__ == &quot;__main__&quot;:#
<strong><span>Rocket((os.environ.get('ADDRESS', '0.0.0.0'), int(os.environ.get('PORT', 9000))), 'wsgi', {'wsgi_app': app}).start()</span></strong>
 app.run(debug=True)</pre>
				<p>Rocket is yet another web server, and for some reason Steve Marx 
				wanted to include it in his version of the Python Azure even though 
				Flask already had a web server. Above you can see the way that
				<strong>runserver.py </strong>should look after you have uncommented 
				the two references to Rocket.</p>
				<p>The console for the Azure cloud looks very different in its most 
				recent incarnation. In Figure P00 you can see the Virtual servers, 
				Cloud Service, databases and Storage Accounts that I have set up 
				in the cloud. </p>
				<p><a href="images/Azure15.png"><span>
				<img alt="The new interface for the Azure cloud" class="leaveAlone" src="images/Azure15Small.png"></span></a></p>
				<p><strong>Figure P02: The services you have configured in the cloud 
				appear in a list.</strong></p>
				<p><a href="images/Azure14.png"><span>
				<img alt="Figure P04: Setting up the endpoints in the Azure cloud" class="leaveAlone" src="images/Azure14Small.png"></span></a></p>
				<p><strong>Figure P03: Setting up the endpoints in the Azure cloud</strong></p>
				<p>You can use the Remote Desktop Connection tool that ships with 
				Windows to connect and configure your server. You will probably 
				see a button at the bottom edge of one of the Azure screens that 
				will set up your connection automatically. If you need to do it 
				manually, you first need to know the name of the server you connect 
				to. Look at the endpoints panel (Figure P03) to get the port.</p>
				<p>When you sign on, you will be prompted for a user name and password. 
				You supplied the password when you created the VM. You need to attach 
				using the Remote Desktop Connection. You should use <strong>Adminstrator</strong> 
				as the user and provide the password you gave when you created the 
				VM as your credentials. For the domain, you can probably supply 
				almost anything, but the name of the server itself can probably 
				act as the domain. For instance, if I call my server server01, and 
				I access it at server01.cloudapp.net:52333, then you can probably 
				sign on as:<br><br>server01\Administrator</p>
				<p>
				<img alt="Connect to the Azure cloud with Remote Desktop Connection" class="leaveAlone" src="images/Azure16.png"></p>
				<p><strong>Figure P04: Connect to the Azure cloud with Remote Desktop 
				Connection. Note the port number you get from the endpoint screen, 
				seen below.</strong><br><br>And then give the password you assigned 
				when creating the VM. If you've lost that password you can always 
				delete the VM and start over.<br><br>To install programs on the 
				server that you already have on your local machine, you can simple 
				right click on the folder that contains your node application, choose 
				copy, then pick a destination on your F drive for your server, and 
				pick paste. It might make sense to skip big folders like node_modules 
				and then use NPM on the server after installing node from this address:<br>
				<br><a href="http://nodejs.org/">http://nodejs.org/</a><br><br>Below 
				you can see several program set up to run on an Azure server.</p>
				<p><a href="images/Azure11.png"><span>
				<img alt="Running three web servers on Azure" class="leaveAlone" src="images/Azure11Small.png"></span></a></p>
				<p><strong>Figure P05: Running three web servers running three web 
				apps on a beta of Server 2012 in the Azure Cloud. Click to enlarge.</strong></p>
				<p>The screenshot shown in Figure P05 is of a remote desktop connection. 
				Notice that there is a port number shown in the caption bar; you 
				need to use that number when setting up the connection. You can 
				see that I have web apps running at port 80, 3000 and 5000. The 
				browser, seen in the background, displays the program that is running 
				at Port 80 in the Rocket web server.</p>
				<p>
				<img alt="Looking at the Azure apps running in the browser on my home machine" class="leaveAlone" src="images/Azure12Small.png"></p>
				<p><strong>Figure P05: Looking at the Azure apps running in the 
				browser on my home machine</strong></p>
				<p>In Figure P03 I've minimized my connection to the Azure virtual 
				machine and connected to the applications that it is running in 
				my browser. Notice that I am also running a Node web app on a Linux 
				box in the Amazon Web Server cloud.</p>
				<p><a href="images/Azure13.png"><span>
				<img alt="Please, may my application come through the firewall. I've already set up the endpoint!" class="leaveAlone" src="images/Azure13Small.png"></span></a></p>
				<p><strong>Figure P05: Please, may my application come through the 
				firewall. I've already set up the endpoint!</strong></p>
				<p>Just setting up the endpoints (Figure P04) wasn't enough. I also 
				had to configure the server to let the ports passed the firewall.</p>
				<h3 id="usingVirtualMachines">Using Virtual Machines</h3>
				<p>To deploy this code to an Azure virtual machine, do the following:</p>
				<ul>
					<li>
					<a href="https://www.windowsazure.com/en-us/manage/windows/">
					https://www.windowsazure.com/en-us/manage/windows/</a></li>
					<li>(<em>If you are in the old console view, look for the link 
					at the bottom that references the preview. Click it.</em>)</li>
					<li>Select New | Virtual machine (You may have to sign up for 
					the beta. You will have an option to choose Server 2012. Why 
					not go for it?)</li>
					<li>Attach a disk and assign it to drive A (2 GB would be way 
					more than enough)</li>
					<li>Open up an endpoint either at port 80 or port 9000</li>
					<li>Using the standards Windows tools to set up your machine 
					to run Python</li>
					<li>Run your python code as described above, or edit the runserver.py 
					to use Port 80</li>
				</ul>
				<p>I understand, you want more detail, but this should get you started.
				</p>
				<h3 id="usingSteveMarxsSolution">Using Steve Marx's Solution</h3>
				<p>To get through the next part, you need to think about the structure 
				of Steve Marx's code. It looks like this:</p>
				<pre>
-PythonRole
-- WorkerRole
--- app</pre>
				<p>As you can see, we have three folders nested inside one another. 
				In the WorkerRole folder there is a copy of run.cmd. There is also 
				a copy in PythonRole. You should edit the one in WorkerRole so that 
				it calls runserver.py rather than app.py.</p>
				<p>Here is the file you need to edit:</p>
				<p>
				<img alt="Finding the right copy of run.cmd" class="leaveAlone" src="images/AzurePython11.png"></p>
				<p><strong>Figure P02: Finding the right copy of run.cmd</strong></p>
				<p>And here is the change you make to the last line of the file:</p>
				<pre>cd /d &quot;%~dp0&quot;

set PATH=%PATH%;%PYTHON_PATH%

REM Use this virtual environment.
call scripts\activate

cd app

python <strong><span>runserver.py</span></strong></pre>
				<p>Be careful not to confuse this copy of run.cmd with the copy 
				found in the root of the Python Azure tools directory.</p>
				<p>Before you can run the Azure emulator, you will have to start 
				a SQL Azure prompt. Choose <strong>Start | All Programs | Windows 
				Azure SDK for .NET | Windows Azure Command Prompt</strong></p>
				<p>Navigate to the root of the Azure tools for Python and run the 
				script called run.cmd. You may be prompted four or five times to 
				sign over to Steve Balmer your:</p>
				<ul>
					<li>First Born</li>
					<li>Your house</li>
					<li>Second Born</li>
					<li>Parents</li>
				</ul>
				<p>Be sure to click OK at each prompt. Now navigate to:</p>
				<p><strong><a href="http://localhost:81">http://localhost:81</a></strong></p>
				<p>All should be exactly the same as running it at port 5000, only 
				this time you are emulating how it will work on Azure. If it worked 
				before, but does not work when you run in the emulator, consider 
				whether or not you installed Rocket into your main Python installation. 
				(Oddly enough, it appears to be the
				<a href="../../../../Python27">C:\Python27</a> version of Python 
				that the emulator uses. But when you install to Azure itself, it 
				will use the virtual environment. Stever Marx's Python Azure tools 
				will, however, ensure that Rocket is intalled in Azure proper.</p>
				<p>Finally, run the Pack command from the root of the Python tools 
				for Azure, then navigate to the Azure console on the web, and follow 
				the prompts to install the files created by your call to Pack. Please 
				note that on Azure you will be able to read from your database, 
				but inserts will fail, presumably because Azure is a readonly environment. 
				We will address that issue later.</p>
				<h2 id="expressAndJade">Express and Jade</h2>
				<p>jade --out tmp/ --path views --pretty --obj '{title: &quot;Elvenware&quot; 
				}' {views/index,views/layout}.jade</p>
				<h2 id="storageAndSQLAzure">Storage and SQL Azure</h2>
				<ul>
					<li>Storage:
					<a href="https://www.windowsazure.com/en-us/home/features/storage/">
					d</a></li>
					<li>SQL Azure:
					<a href="https://www.windowsazure.com/en-us/home/features/sql-azure/">
					https://www.windowsazure.com/en-us/home/features/sql-azure/</a></li>
					<li>SQL Azure from Linux:
					<a href="http://www.easysoft.com/products/data_access/odbc-sql-azure-driver/linux-unix.html">
					http://www.easysoft.com/products/data_access/odbc-sql-azure-driver/linux-unix.html</a></li>
				</ul>
				<p>Links</p>
				<ul>
					<li><a href="http://code.google.com/p/tortoisegit/">Tortoise 
					GIT</a></li>
					<li><a href="http://windows.github.com/">http://windows.github.com/</a></li>
					<li>
					<a href="http://programmers.stackexchange.com/questions/64727/windows-azure-vs-amazon-ec2-vs-google-app-engine">
					Azure Discussion</a></li>
				</ul>
				</li>
			</ul>
		</div>
		<!-- #EndEditable -->
	</article>
	<footer>

		<p>Copyright &copy; <a href="../../index.html">Charlie Calvert</a> |
		<a href="../../index.html">Elvenware Home</a> |
		<a href="../index.html">Writing Code</a> |
		<a href="../delphi/index.html">Delphi</a> |
		<a href="../csharp/index.html">CSharp</a> |
		<a href="../../books/index.html">My Books</a> </p>
	</footer>
</div>

</body>

<!-- #EndTemplate -->

</html>