<!DOCTYPE html><html lang="en" dir="ltr"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><title>Angular</title><link rel="shortcut icon" href="/charlie/images/favicon.png"><!-- Latest compiled and minified CSS--><link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap.min.css"><!-- Optional theme--><link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap-theme.min.css"><link href="/libs/css/BootstrapIndex.css" rel="stylesheet" type="text/css"><link href="/css/style.css" rel="stylesheet" type="text/css"><script src="/libs/scripts/jquery.min.js"></script><script src="//netdna.bootstrapcdn.com/bootstrap/3.0.0/js/bootstrap.min.js"></script><script src="/libs/scripts/elvenware.js" type="text/javascript"></script><script src="/libs/scripts/Control.js"></script></head><body><div class="navbar navbar-inverse"><div class="container"><div class="navbar-header"><button type="button" data-toggle="collapse" data-target=".navbar-collapse" class="navbar-toggle"><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><a href="/index.html" class="navbar-brand">Elvenware</a></div><div class="collapse navbar-collapse"><ul class="nav navbar-nav"><li class="active"><a href="/index.html">Home</a></li><li><a href="/contents.html">About</a></li><li class="dropdown"><a href="#" data-toggle="dropdown" class="dropdown-toggle">Dropdown<b class="caret"></b></a><ul class="dropdown-menu"><li class="dropdown-header">Core Code</li><li><a href="/development/index.html">Strongly Typed</a></li><li><a href="/development/web/index.html">Web & Scripts</a></li><li><a href="/development/cloud/index.shtml">Cloud</a></li><li class="divider"></li><li class="dropdown-header">OS and Tools</li><li><a href="/os/index.html">OS</a></li><li><a href="/development/database/index.html">Database</a></li><li><a href="/books/index.html">My Writing</a></li><li class="divider"></li><li class="dropdown-header">Art</li><li><a href="/charlie/Art/index.html">Poems & Photos</a></li><li><a href="/books/reading/index.html">Book Reviews</a></li><li><a href="/spirit/index.html">Spiritual</a></li><li class="divider"></li><li class="dropdown-header">Links</li><li><a href="/charlie/links.html">My Links</a></li><li><a href="http://www.github.com/charliecalvert">GitHub</a></li><li><a href="http://sourceforge.net/projects/elvenware/">Sourceforge</a></li></ul></li></ul></div><!-- /.nav-collapse--></div></div><div class="container"><figure><img alt="Elvenware" src="/charlie/images/elvenwarelogo.png"/></figure><h1>Angular</h1><p>Welcomes to Angular</p><ul><!--TOC_Start--><li><a href="#angular">Angular</a></li>
<li><a href="#getting-started">Getting Started</a></li>
<li><a href="#declaring-controllers">Declaring Controllers</a></li>
<li><a href="#dom-manipulation">DOM Manipulation</a></li>
<li><a href="#scope">Scope</a></li>
<li><a href="#calling-methods-in-factories">Calling Methods in Factories</a></li>
<li><a href="#select">Select</a></li>
<li><a href="#jasmine-matchers">Jasmine Matchers</a></li>
<li><a href="#use-tothrow-matcher">Use toThrow Matcher</a></li>
<li><a href="#unit-test-names">Unit Test Names</a></li>
<li><a href="#dialogs-in-unit-tests">Dialogs in Unit Tests</a></li>
<li><a href="#basicMock">Some Basic Mocking</a></li>
<li><a href="#jsonFromServer">JSON from Server</a></li>
<li><a href="#validating-angular-html">Validating Angular HTML</a></li>
<li><a href="#angular-starter-projects-">Angular Starter Projects </a></li>
<li><a href="#elf-ruble-and-angular">Elf Ruble and Angular</a></li>
<li><a href="#angular-git-starter-projects-in-aptana">Angular Git Starter Projects in Aptana</a></li>
<li><a href="#instructions-for-the-angular-three-assignment">Instructions for the Angular Three Assignment</a></li>
<li><a href="#fourmodule-js-file">FourModule.js file</a></li>
<li><a href="#testmain-js-file">TestMain.js file</a></li>
<li><a href="#karma-conf-js">karma.conf.js</a></li>
<li><a href="#main-js">Main.js</a></li>
<li><a href="#index-html">index.html</a></li>
<li><a href="#using-karma">Using Karma</a></li>
<li><a href="#coverage">Coverage</a></li>
<li><a href="#grunt">Grunt</a></li>
<li><a href="#mocking-objects-with-httpbackend">Mocking Objects with $httpBackend</a></li>
<li><a href="#angular-links">Angular Links</a></li>
<li><a href="#elvenware">Elvenware</a></li>
<li><a href="#slides">Slides</a></li><!--TOC_End--></ul><h1 id="angular">Angular</h1>
<p>In this page we cover some facts about Angular and Jasmine.</p>
<ul>
<li><a href="http://www.angularjs.org/">Angular</a></li>
<li><a href="http://pivotal.github.io/jasmine/">Jasmine</a></li>
</ul>
<h2 id="getting-started">Getting Started</h2>
<p>Conside the following simple Angular template:</p>
<pre><code>&lt;!DOCTYPE HTML&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;meta charset=&quot;utf-8&quot;&gt;        
        &lt;title&gt;Angular Starter Add&lt;/title&gt;
        &lt;script src=&quot;https://ajax.googleapis.com/ajax/libs/angularjs/1.3.15/angular.min.js&quot;&gt;&lt;/script&gt;
    &lt;/head&gt;
    &lt;body ng-app&gt;
        &lt;h1&gt;Angular Starter Add&lt;/h1&gt;

        &lt;p&gt;5 * 7 = {{5 * 7}}&lt;/p&gt;

    &lt;/body&gt;
&lt;/html&gt;
</code></pre><p>The file shown here looks like HTML at first, but there a odd bits of syntax.  Notice, for instance, these two bits of syntax:</p>
<ul>
<li>ng-app</li>
<li>{{5 * 7}}</li>
</ul>
<p>These two bits of syntax indicate that this is not raw HTML. Instead, it is an angular <strong>template</strong>.</p>
<p>Nomenclature:</p>
<ul>
<li>The File shown above: an Angular <strong>template</strong>.</li>
<li><strong>ng-app</strong>: It is both an HTML <strong>attribute</strong> and an Angular <strong>directive</strong></li>
<li>{{5 <em> 7}}: Those double curly braces are called Angular <em>*expressions</em></em>.</li>
</ul>
<p>We often write <strong>data-ng-app</strong> in order to conform with the rules of HTML5. Both <strong>ng-app</strong> and <strong>data-ng-app</strong> work.</p>
<h2 id="declaring-controllers">Declaring Controllers</h2>
<p>We should probably end up putting all our controllers inside
the scope of a particular module, using DOT notation:</p>
<pre><code>angular.module(&#39;myApp&#39;, []).controller(&#39;myController&#39;, function() {
</code></pre><p>Here is a more complete example:</p>
<pre><code>angular.module(&#39;myApp&#39;, []).controller(&#39;MileController&#39;, function($scope) {
    $scope.hint = &quot;Enter a number of miles&quot;;

    $scope.miles = 0;

    $scope.convertMilesToInches = function() {
        return $scope.miles * 5280 * 12;  
    };    
});
</code></pre><p>When you declares controllers like this, then you want to use the
<strong>module</strong> call in your Jasmine unit tests:</p>
<pre><code>beforeEach(module(&#39;myApp&#39;));

beforeEach(inject(function($rootScope, $controller) {
    mileController = $rootScope.$new();
    $controller(&#39;MileController&#39;, { $scope: mileController }); 
}));
</code></pre><h2 id="dom-manipulation">DOM Manipulation</h2>
<p>The general rule is fairly simple: </p>
<ul>
<li>Let Angular manipulate the DOM</li>
<li>If you must manipulate the DOM, do it in a directive</li>
<li><a href="https://github.com/charliecalvert/JsObjects/tree/master/JavaScript/Design/AngularDirective">JsObject Directive Example</a></li>
<li><a href="http://docs.angularjs.org/guide/directive">Directives</a></li>
</ul>
<h2 id="scope">Scope</h2>
<p>The scope in Angular is a means of working with the templates in our HTML. If we were using jQuery, we might write code like this in a Controller to update and track code in an input control:</p>
<pre><code>$(&#39;#foo&#39;).val(&#39;bar&#39;);
var userInput = $(&#39;#foo&#39;).val(); // Yields string bar
</code></pre><p>In the simplest, most reductive possible terms, that is what scope does for you. In Angular html templates we write something that might include this code:</p>
<pre><code>&lt;input type=&quot;text&quot; ng-model=&#39;foo&#39;&gt;
</code></pre><p>In our Angular controllers, we write:</p>
<pre><code>$scope.foo = &#39;bar&#39;
</code></pre><p>This is another way of writing the first jquery statement shown above. Here is a way to write the second:</p>
<pre><code>var userInput = $scope.foo;
</code></pre><p>Now lets talk about buttons and clicks.</p>
<p>In jQuery we write:</p>
<pre><code>$(&#39;#myButton&#39;).click(function() {});
</code></pre><p>In Angular we write something like this in the HTML:</p>
<pre><code>&lt;button ng-click(&#39;buttonHandler()&#39;)&gt;My Button&lt;/button&gt;
</code></pre><p>And then in the controller:</p>
<pre><code>$scope.buttonHandler = function() {};
</code></pre><h2 id="calling-methods-in-factories">Calling Methods in Factories</h2>
<p>Let&#39;s go back to the basic examples found here:</p>
<p><a href="https://github.com/charliecalvert/JsObjects/tree/master/JavaScript/Design/AngularThreeModules04">Angular Modules</a></p>
<p>Look at the code for the main module:</p>
<pre><code>angular.module(&#39;elvenApp&#39;, [&#39;tools&#39;])
.controller(&#39;BoatController&#39;, function($scope, boat, sailboat) { &#39;use strict&#39;;
    $scope.simple = &quot;Simple Boat&quot;;
    $scope.boatType = boat.getDescription();
    $scope.sailBoat = sailboat.getDescription();
    $scope.getNine = function() {
        return sailboat.getNine();
    };
});
</code></pre><p>As you can see, we are calling several function that are located in our factory. For instance, we are calling getDescription and getNine. </p>
<p>Here are the implementations for the factories:</p>
<pre><code>angular.module(&#39;tools&#39;, [])
.factory(&#39;boat&#39;, function() {  &#39;use strict&#39;;
    this.Boat = (function() {
        var description = &quot;I&#39;m a boat.&quot;;

        function Boat() {

        }

        Boat.prototype.getDescription = function() {
            return description;
        };

        return Boat;
    })();

    return new this.Boat();
})
.factory(&#39;sailboat&#39;, function() { &#39;use strict&#39;;
    this.SailBoat = (function() {
        var description = &quot;I&#39;m a sailboat&quot;;

        function SailBoat() {

        }

        SailBoat.prototype.getNine = function() {
            return 9;
        };

        SailBoat.prototype.getDescription = function() {
            return description;
        };

        return SailBoat;
    })();

    return new this.SailBoat();
});
</code></pre><p>All that was really needed to make this work was:</p>
<p>1) Factory code that compiled and was well formed. 
2) Controller code that used the tools module, and that injected instances of the objects found in the tools mod:</p>
<pre><code>angular.module(&#39;elvenApp&#39;, [&#39;tools&#39;])
.controller(&#39;BoatController&#39;, function($scope, boat, sailboat) { &#39;use strict&#39;;
</code></pre><p>Once we have included the <strong>tools</strong> module, then we can easily inject the two factories called <strong>boat</strong> and <strong>sailboat</strong>. Now we can call methods on those objects:</p>
<pre><code>boat.getDescription();
sailBoat.getNine();
</code></pre><h2 id="select">Select</h2>
<p>Set it up like this:</p>
<pre><code>$scope.chartSelect = {
    &quot;type&quot;: &quot;select&quot;,
    &quot;name&quot;: &quot;Service&quot;,
    &quot;value&quot;: &quot;PieChart&quot;,
    &quot;values&quot;: [ &quot;PieChart&quot;, &quot;BarChart&quot;, &quot;ColumnChart&quot;, 
         &quot;AreaChart&quot;, &quot;LineChart&quot;, &quot;Table&quot;]
};
</code></pre><p>The HTML should look like this:</p>
<pre><code class="lang-HTML">&lt;select ng-model=&quot;chartSelect.value&quot; 
     ng-options=&quot;v for v in chartSelect.values&quot; ng-change=&quot;chartTypeUpdate()&quot;&gt;
&lt;/select&gt;
</code></pre>
<h2 id="jasmine-matchers">Jasmine Matchers</h2>
<p>There are many Jasmine matchers.</p>
<p>You can look for an exact match like the === operator:</p>
<pre><code>it(&quot;expects 1 + 1 to equal 2&quot;, function() {
    expect(1+1).toBe(2);
});
</code></pre><p>For a less precise match like the == operator:</p>
<pre><code>it(&quot;expects 1 + 1 to equal 2&quot;, function() {
    expect(1+1).toEqual(2);
});
</code></pre><p>Or a more forigiving match for floating point numbers:</p>
<pre><code>it(&quot;1.799 is close to 1.8&quot;, function() {
    expect(1.799).toBeCloseTo(1.8);
});
</code></pre><p>Here are some of the more important Jasmine matchers and a hopefully
reasonable effort to define what they do:</p>
<ul>
<li><strong>toBe</strong>: This is very precise, like using ===.</li>
<li><strong>toBeDefined</strong>: Is it not <strong>undefined</strong></li>
<li><strong>toBeCloseTo</strong>: Compare two floating point numbers.</li>
<li><strong>toBeFalsy</strong>: Is it <strong>false</strong>, an empty string, null, undefined, etc</li>
<li><strong>toBeGreaterThan</strong>: Is one number larger than another number</li>
<li><strong>toBeLessThan</strong>: Is one number less than another</li>
<li><strong>toBeNull</strong>: Test for null</li>
<li><strong>toBeUndefined</strong>: Is the value &quot;undefined&quot;.</li>
<li><strong>toBeTruthy</strong>: Is it <strong>true</strong> or something equivalent.</li>
<li><strong>toContain</strong>: Search an array for a value</li>
<li><strong>toEqual</strong>: Less precise than <strong>toBe</strong>, like using == rather than ===</li>
<li><strong>toMatch</strong>: Compare strings with regular expressions</li>
<li><strong>toThrow</strong>: Does an expression throw an exception?</li>
</ul>
<h2 id="use-tothrow-matcher">Use toThrow Matcher</h2>
<p>Sometimes you want to prove that trying to do some particular action
will raise an exception. Jasmine has the <strong>toThrow</strong> matcher to 
handle these cases. When calling <strong>toThrow</strong> there is a bit of a gotcha.
To get over this hurdle, you have to use a an anonymous function, as
shown below.</p>
<p>Consider this example. We have a method called <strong>tryToCallNew</strong> which is
set up to always thrown an exception. To use <strong>toThrow</strong> we must create
an anonymous function, call <strong>createError</strong> and test if it returns the
error we expect:</p>
<pre><code>function createError() {
    try {
        throw new Error(&quot;Intentional error&quot;);
    } catch(e) {
        throw new Error(&#39;error&#39;);
    }
}

it(&quot;throws an exception&quot;, function() {        
    expect(function() { tryToCallNew(); }).toThrow(new Error(&#39;error&#39;));
});
</code></pre><p>Even though the method created throws an error, our test passes.</p>
<p>Let&#39;s do the same thing, but cause the error a different way:</p>
<pre><code>var objectMethod = {
    a: 1
};

function tryToCallNew() {
    try {
        new objectMethod();
    } catch(e) {
        throw new Error(&#39;error&#39;);
    }
}

it(&quot;cannot be used with new&quot;, function() {        
    expect(function() { tryToCallNew(); }).toThrow(new Error(&#39;error&#39;));
});
</code></pre><p>You can&#39;t call new on object like the one we created. So our attempt
to do so raises an error. But our test passes because it expects the
attempt to raise the error.</p>
<p>Here is another example of how to use <strong>toThrow</strong>. In this case, we 
assume that calling <strong>new objectMethod()</strong> raises a <strong>TypeError</strong> because
<strong>objectMethod</strong> is not a function:</p>
<pre><code>it(&quot;cannot be used with new&quot;, function() {        
    expect(function() { new objectMethod(); }).toThrow(new TypeError(&#39;object is not a function&#39;));
});
</code></pre><h2 id="unit-test-names">Unit Test Names</h2>
<p>I&#39;m belatedly realizing that we can establish better naming
conventions in our unit tests.</p>
<p>We don&#39;t seem to be using this variable:</p>
<pre><code>var pc = null;
...
pc = $controller(&#39;MileController&#39;, { $scope: npcController });
</code></pre><p>So we can just eliminate it:</p>
<pre><code>$controller(&#39;MileController&#39;, { $scope: npcController });
</code></pre><p>There is usually a better name for $mockScope:</p>
<pre><code>var $mockScope = null;
...
$mockScope = $rootScope.$new();
$controller(&#39;MileController&#39;, { $scope: $mockScope });
</code></pre><p>We can call it mileController in a case like this, since that is 
what it ends up holding:</p>
<pre><code>var mileController = null;
...
mileController = $rootScope.$new();
$controller(&#39;MileController&#39;, { $scope: mileController });
</code></pre><h2 id="dialogs-in-unit-tests">Dialogs in Unit Tests</h2>
<p>We can handle that $dialog in a way slightly different from the one 
I outlined to you. Here is what I suggested before:</p>
<p>describe(&quot;mycontrollertest&quot;, function() {&#39;use strict&#39;;
    var npcController = null;<br>    var $dialog = null;</p>
<pre><code>beforeEach(inject(function($rootScope, $controller) {
    npcController = $rootScope.$new();
    pc = $controller(&#39;NPCController&#39;, { $scope: npcController, $dialog: $dialog }); 
}));
</code></pre><p>Apparently we can do this:</p>
<p>describe(&quot;mycontrollertest&quot;, function() {&#39;use strict&#39;;
    var npcController = null;</p>
<pre><code>beforeEach(inject(function($rootScope, $controller) {
    npcController = $rootScope.$new();
    pc = $controller(&#39;NPCController&#39;, { $scope: npcController, $dialog: null }); 
}));
</code></pre><p>In this example I declare $dialog to be null, and I don&#39;t need to declare it as global to our object. </p>
<h3 id="basicMock">Some Basic Mocking</h3>
<p>Here are some tests that provide the first instance we have seen of 
creating a mock object: </p>
<pre><code>beforeEach(inject(function($rootScope, $controller) {
    gameBoard = $rootScope.$new();
    gameEventService = { towerBroadcast: function() { return true; } };
    elfgameService = $rootScope.$new();
    $controller(&#39;GameBoard&#39;, { 
        $scope: gameBoard, 
        gameEventService: gameEventService, 
        elfgameService: elfgameService 
    });
}));
</code></pre><p>Notice this line from the code shown above: </p>
<pre><code>gameEventService = { 
    towerBroadcast: function() { return true; } 
};
</code></pre><p>This code mocks our event service by simply returning true rather than
actually send the message. This line looks as though it is retreiving 
a real gameEventService object, but it just using our mock:</p>
<pre><code>$controller(&#39;GameBoard&#39;, { 
    $scope: gameBoard, 
    gameEventService: gameEventService, 
    elfgameService: elfgameService 
});
</code></pre><p>Now we can write tests that depend on making calls to the <strong>towerBroadcast</strong>
method of our <strong>gameEventService</strong>:</p>
<pre><code>it(&quot;Check ElfGame Width&quot;, function() {
    var actual = elfgameService.reportEvent();
    expect(actual).toEqual(true);
});
</code></pre><p>This code calls <strong>reportEvent</strong> which in turn calls <strong>gameEventServer.towerBroadcast</strong>.</p>
<h3 id="jsonFromServer">JSON from Server</h3>
<p>Here is how to retrieve JSON from a server.</p>
<pre><code>var getDataJson = $http.get(&#39;data.json&#39;);

getDataJson.success(function(data, status, headers, config)  {
    $scope.data = data;
});

getDataJson.error(function(data, status, headers, config) {
    throw new Error(&#39;Oh no! An Error!&#39;);
});
</code></pre><ul>
<li><a href="https://github.com/charliecalvert/JsObjects/tree/master/JavaScript/Design/JsonFromServer">Example</a></li>
<li><a href="https://github.com/charliecalvert/JsObjects/blob/master/JavaScript/Design/JsonFromServer/index.js">Key File</a></li>
</ul>
<h3 id="validating-angular-html">Validating Angular HTML</h3>
<ul>
<li><a href="http://stackoverflow.com/a/16184477/253576">reference</a></li>
</ul>
<h2 id="angular-starter-projects-">Angular Starter Projects </h2>
<p>In JsObjects on GitHub, there are several starter project for 
working with Angular, MongoDb, Karma, Jasmine and Grunt. These 
projects are quite useful as they will help you get over the fussy 
coding required to get all your tools in place.</p>
<ul>
<li><a href="https://github.com/charliecalvert/AngularMongoBootstrapTest">AngularMongoBootstrap</a></li>
<li><a href="https://github.com/charliecalvert/AngularKarma">AngularKaram</a></li>
<li><a href="https://github.com/charliecalvert/AngularTest">AngularTest</a></li>
</ul>
<p>If you use these projects a few times, you should soon reach the 
state where you can pull one down, and start Grunt JsHint, and Karma 
continual testing in less than a minute. The projects ship with 
sample unit tests, but you might even be able to add your first new 
unit test in that time. They provide a great jump start for people
who have a moderate knowledge of how to create and test projects using 
Angular, Jasmine, Karma and Grunt with JsHint.</p>
<h2 id="elf-ruble-and-angular">Elf Ruble and Angular</h2>
<p>There is an add on (a Ruble) for Aptana that will allow you to create
Elven Angular Projects and other things. See the ReadMe for details:</p>
<ul>
<li><a href="https://github.com/charliecalvert/ElfRuble/blob/master/README.md">Elf Ruble README</a></li>
</ul>
<h2 id="angular-git-starter-projects-in-aptana">Angular Git Starter Projects in Aptana</h2>
<p>There is a second way to get the projects that are stored in the Elf
Ruble. This sections describes how to pull them directly from GitHub.</p>
<p>You can use the projects described above via the File | New Web Site
command in Aptana Studio. When used that way, they act as new
Project Templates that extend the power of Aptana by allowing you
automatically create projects that support Angular, Jasmine, Karam, 
Grunt and JsHint.</p>
<p>If you have not done so already, open up the HTML bundle in Aptana. 
There are two possible ways to do this. Pick the one that works on 
your system.</p>
<ol>
<li>Commands | HTML | Edit this Bundle</li>
<li>Commands | Other | HTML | Edit this Bundle</li>
</ol>
<p>It may take a moment, but eventually you should see a new folder
called HTML in your workspace.</p>
<p>Open the <strong>templates</strong> directory and find the file called 
<strong>project_templates.rb</strong>. Paste the code shown below into the bottom 
of it. Please note the line feed after the final end. That is needed 
or the IDE will complain.</p>
<pre><code>project_template &quot;Elvenware Angular Unit Test Project &quot; do |t|
  t.type = :web
  t.tags = [&#39;Web&#39;]
  t.icon = &quot;templates/HTML5_Logo_64.png&quot;
  t.id = &quot;com.elvenware.project.template.web.html5&quot;
  t.location = &quot;git://github.com/charliecalvert/AngularTest.git&quot;
  t.description = &quot;Remote template. Requires network access.&quot;
  t.replace_parameters = false
  t.tags = [&#39;Web&#39;]  
end

project_template &quot;Elvenware Angular Jasmine Karma Project &quot; do |t|
  t.type = :web
  t.tags = [&#39;Web&#39;]
  t.icon = &quot;templates/HTML5_Logo_64.png&quot;
  t.id = &quot;com.elvenware.project.template.web.html5&quot;
  t.location = &quot;git://github.com/charliecalvert/AngularKarma.git&quot;
  t.description = &quot;CSC Remote template. Requires network access.&quot;
  t.replace_parameters = false
  t.tags = [&#39;Web&#39;]  
end

project_template &quot;Elvenware Angular Mongo Bootstrap Project &quot; do |t|
  t.type = :web
  t.tags = [&#39;Web&#39;]
  t.icon = &quot;templates/HTML5_Logo_64.png&quot;
  t.id = &quot;com.elvenware.project.template.web.html5&quot;
  t.location = &quot;git://github.com/charliecalvert/AngularMongoBootstrapTest.git&quot;
  t.description = &quot;CSC Remote template. Requires network access.&quot;
  t.replace_parameters = false
  t.tags = [&#39;Web&#39;]  
end
</code></pre><p>Restart Aptana. Select <strong>File | New | Web Project</strong>. Select the 
project called <strong>Elvenware Angular Unit Test Project</strong>. Create the
project as usually, filling in the name of the project. Run the 
two HTML files and confirm that they work.</p>
<p>Note that the template for the project is stored on GitHub, so you
have to be connected for this to work. That&#39;s a drawback, but there
are obvious benefits to pulling from a repository that I can easily
update.</p>
<p>Since this project was pulled from GitHub, it includes a .git 
folder. You should consider removing this folder if you do not want 
to use git, or if this folder is embedded inside another git 
repository.</p>
<p>After you have restarted Aptana, you can use these Project templates
to create new projects. </p>
<p>If you have some basic knowledge of Grunt and Karma, then you can 
use these tools with these projects. To get started, run <strong>npm 
install</strong> in the root directory for the project:</p>
<pre><code>npm install
</code></pre><p>Next, start Karma by typing <strong>karma start</strong>:</p>
<pre><code>karma start
</code></pre><p>Periodically, you should go to the command line in the root directory
for this folder and run <strong>grunt jshint</strong>.</p>
<pre><code>grunt jshint
</code></pre><p>You should then examine the <strong>result.xml</strong> file to look for any problems
in your code.</p>
<p>Also, read the <strong>README.md</strong> files for these projects.</p>
<h1 id="instructions-for-the-angular-three-assignment">Instructions for the Angular Three Assignment</h1>
<p><em>With thanks to Margie Calvert for helping to assemble this information.</em></p>
<p>This exercise creates a very simple function inside an angular 
module, then hooks it up appropriately with a controller, a unit 
test, and an index page. It uses Charlie&#39;s Aptana Ruble to get 
started.</p>
<ul>
<li><a href="https://github.com/charliecalvert/ElfRuble/blob/master/README.md">Ruble</a></li>
</ul>
<p>Use the Elvenware Angular Jasmine Karma project. This contains the 
necessary files to run Karma on the code you generate, as you 
generate it.</p>
<p>After you install the project in Aptana, set up the following files.</p>
<h3 id="fourmodule-js-file">FourModule.js file</h3>
<p>Use a new JavaScript Template (File -&gt; New From Template -&gt; JavaScript -&gt; JavaScript Template) 
to create a blank javascript page. Call it FourModule.js and save it 
in the Source directory of your project.</p>
<p>Use this code in the module:</p>
<pre><code>angular.module(&quot;fourModule&quot;, [])
.factory(&#39;fourFactory&#39;, function() {&#39;use strict&#39;;
    return {
        getFour : function(){
        return 4;
        }
    };
});
</code></pre><h3 id="testmain-js-file">TestMain.js file</h3>
<p>Now set up the Unit Test. Go to TestMain.js, and make these changes:</p>
<p>Locate this line of code near the the top of the file.</p>
<pre><code>describe(&quot;Test Main&quot;, function() {&#39;use strict&#39;;
</code></pre><p>Create a variable called (var fourFactory = null;). This code will be 
somewhere beneath this declaration: <strong>var MainController = null;</strong></p>
<p>Then find the following lines of code: </p>
<pre><code>(beforeEach(function() {
    module(&#39;mainModule&#39;); 
    // Insert your code here.
</code></pre><p>Inset the following: <strong>module(&#39;fourModule&#39;);</strong></p>
<p>Scroll down past this code:</p>
<pre><code>beforeEach(inject(function($rootScope, 
    $controller, $injector) {
    mainController = $rootScope.$new();
    $controller(&#39;mainController&#39;, {
    $scope : mainController
    // Insert your code here
});
</code></pre><p>Type this:</p>
<pre><code>fourFactory = $injector.get(&#39;fourFactory&#39;);
</code></pre><p>Go below the }));  and type this code:</p>
<pre><code>it(&quot;gets the number four&quot;, function() {
    var actual = fourFactory.getFour();
    expect(actual).toEqual(4);
});
</code></pre><h3 id="karma-conf-js">karma.conf.js</h3>
<p>Open up karma.conf.js, which is in the Tests folder. You will see something like this 
after the first little bit:</p>
<pre><code>files: [   
    &#39;Library/angular.js&#39;,
    &#39;Library/angular-mocks.js&#39;,
    &#39;Tests/TestMain.js&#39;,
    &#39;Source/Main.js&#39;,
    &#39;Source/NewModule.js&#39;,
    &#39;Source/EightModule.js&#39;,
    &#39;Source/TenModule.js&#39;,
    &#39;Source/OneModule.js&#39;,
    &#39;Source/ThreeModule.js&#39;, 
],
</code></pre><p>Add &#39;Source/FourModule.js&#39; to the list. I already added a few other modules, so your list will look
different.</p>
<h3 id="main-js">Main.js</h3>
<p>Add the module into the list in the brackets. Any time you add a module, 
add the name here. The first line will look something like this before you change anything. </p>
<pre><code>angular.module(&#39;mainModule&#39;, [&#39;newModule&#39;, 
    &#39;eightModule&#39;, &#39;tenModule&#39;, 
    &#39;oneModule&#39;, &#39;threeModule&#39;])
</code></pre><p>In my code, I already added quite a few modules, which you will not 
have. Don&#39;t forget to put the name of your module in quotes and 
don&#39;t forget to use a comma to separate any modules in the brackets.</p>
<p>So now in my code it looks like this:</p>
<pre><code>angular.module(&#39;mainModule&#39;, [&#39;newModule&#39;, 
    &#39;eightModule&#39;, &#39;tenModule&#39;, &#39;oneModule&#39;, 
    &#39;threeModule&#39;, &#39;fourModule&#39;])
</code></pre><p>The second line looks something like this:</p>
<pre><code>.controller(&#39;mainController&#39;, function($scope, 
    newFactory, eightFactory, tenFactory, 
    oneFactory, threeFactory) { &#39;use strict&#39;;
</code></pre><p>Add fourFactory to the list.</p>
<pre><code>.controller(&#39;mainController&#39;, function($scope, 
    newFactory, eightFactory, tenFactory, oneFactory, 
    threeFactory, fourFactory) { &#39;use strict&#39;;
</code></pre><p>The next line is</p>
<pre><code>$scope.name = &quot;mainController&quot;;
</code></pre><p>Somewhere under that, put this code:</p>
<pre><code>$scope.getFour = fourFactory.getFour();
</code></pre><p>This is also where you would write a function for the 
mainController. In my code things look like this:</p>
<pre><code>$scope.add = function(a, b) {
    return a + b;
};

$scope.getNine = newFactory.getNine();
$scope.getEight = eightFactory.getEight();
$scope.getTen = tenFactory.getTen();
$scope.getOne = oneFactory.getOne();
$scope.getThree = threeFactory.getThree();
$scope.getFour = fourFactory.getFour();
</code></pre><p>Then way at the bottom  you will see  });</p>
<h3 id="index-html">index.html</h3>
<p>Add this code in the <head></head> section:</p>
<pre><code>&lt;script src = &quot;Source/FourModule.js&quot;&gt; &lt;/script&gt;
</code></pre><p>In the body you will see a <strong>div id</strong> tag:</p>
<pre><code>&lt;div id=&quot;textDisplay&quot; data-ng-controller=&quot;mainController&quot;&gt;
</code></pre><p>Below that, put your display instructions:</p>
<pre><code>&lt;p&gt;Get Four:  {{getFour}}&lt;/p&gt;
</code></pre><p>Now try running index.html. It should show the results of your work.    </p>
<h2 id="using-karma">Using Karma</h2>
<p>Karma is a wrapper around unit testing frameworks. It helps automate
the way we run our tests. It is commonly used with AngularJs. It 
once had a name so absurd that I refuse to repeat it here. The name 
change is fairly recent, so you may find references to the old name 
here and there.</p>
<p>To install Karma:</p>
<pre><code>npm install -g karma
</code></pre><p>Test from command line to see if it is installed:</p>
<pre><code>&gt;karma --version
Karma version: 0.10.2
</code></pre><p>In the command terminal in Aptana, navigate to the directory where you have your project. 
You will be starting in your Users/myName directory. So if the project is in the isit320 
directory, you might have to cd to Documents/isit320/currentprojectfolder.</p>
<p>run</p>
<pre><code>npm install
</code></pre><p>and then type</p>
<pre><code>karma start
</code></pre><h3 id="coverage">Coverage</h3>
<p>Code coverage let&#39;s you know what code in your program is not covered
by unit tests.</p>
<p>First install coverage tool, which is called <a href="https://github.com/gotwarlost/istanbul">Istanbul</a>:</p>
<pre><code>npm install -g istanbul
</code></pre><p>In some cases, you may already have a package.json that includes 
karma-coverage, so just rerun npm install. However, of other projects,
you can install coverage and save a reference for it in your <strong>package.json</strong>
file by typing the following:</p>
<pre><code>npm install karma-coverage --save-dev
</code></pre><p>When you are done, you can open up <strong>package.json</strong> and find the entry
for <strong>karma-coverage</strong>.</p>
<p>Then you need to modify three parts of <strong>karma.conf.js</strong>:</p>
<ul>
<li>preprocessors</li>
<li>reporters</li>
<li>plugins</li>
</ul>
<p>In the preprocessors section of <strong>karma.conf.js</strong>:</p>
<pre><code>preprocessors: {
    &#39;Source/**/*.js&#39;: [&#39;commonjs&#39;, &#39;coverage&#39;],
    },
</code></pre><p>When defining your coverage support, remember that it is up to you 
to tell coverage where the files are that are being tested. You 
don&#39;t have to point to the test files, just the files that are being 
tested. For most of our programs, that means doing something like 
this in the preprocessors statement:</p>
<pre><code>&#39;Source/**/*.js&#39;
</code></pre><p>When you get it right, you should see Coverage produce an HTML file 
for each JavaScript file in your Source directory.</p>
<p>Add on support for your reports:</p>
<pre><code>reporters: [&#39;progress&#39;, &#39;coverage&#39;, &#39;junit&#39;],
</code></pre><p>And in your plugins at the bottom of karam.conf.js and in karam-coverage:</p>
<pre><code>plugins: [      
      &#39;karma-jasmine&#39;,
      &#39;karma-coverage&#39;,
      &#39;karma-chrome-launcher&#39;,
      &#39;karma-firefox-launcher&#39;,
      &#39;karma-junit-reporter&#39;,
      &#39;karma-commonjs&#39;
    ]
</code></pre><p>The results end up in a folder called <strong>coverage</strong> in a series of 
HTML files. Open the files in your browser.</p>
<p><img src="../Images/Coverage01.png" alt="Coverage of Simpler Controller"></p>
<h2 id="grunt">Grunt</h2>
<p>You can also use Grunt to run jshint.</p>
<pre><code>grunt jshint
</code></pre><h2 id="mocking-objects-with-httpbackend">Mocking Objects with $httpBackend</h2>
<p>Read the README.md file for JsonFromServer:</p>
<ul>
<li><a href="https://github.com/charliecalvert/JsObjects/blob/master/JavaScript/Design/JsonFromServer/README.md">JsonFromServer on GitHub</a></li>
</ul>
<p>The example demonstrates how to proceed.</p>
<p>Mocking Mongo Data:</p>
<ul>
<li><a href="https://github.com/charliecalvert/JsObjects/tree/master/Data/MongoLab01">MongoLab01</a></li>
<li><a href="https://github.com/charliecalvert/JsObjects/tree/master/Data/MongoLab02">MongoLab02</a></li>
<li><a href="https://github.com/charliecalvert/JsObjects/tree/master/Data/MongoLab03">MongoLab03</a></li>
<li><a href="https://github.com/charliecalvert/JsObjects/tree/master/JavaScript/Games/CharacterCreate02">CreateCharacters02</a></li>
</ul>
<p>See TestMongoTower.js.</p>
<h2 id="angular-links">Angular Links</h2>
<h3 id="elvenware">Elvenware</h3>
<ul>
<li><a href="http://www.elvenware.com/charlie/development/web/JavaScript/Angular.html">Angular on Elvenware</a></li>
<li><a href="https://github.com/charliecalvert/JsObjects/tree/master/JavaScript/Design">JsObjects</a></li>
</ul>
<h3 id="slides">Slides</h3>
<ul>
<li><a href="http://bit.ly/angular-yeoman">http://bit.ly/angular-yeoman</a></li>
<li><a href="http://bit.ly/AngularPart01">http://bit.ly/AngularPart01</a></li>
<li><a href="http://bit.ly/angular-mod">http://bit.ly/angular-mod</a></li>
<li><a href="http://bit.ly/angular-unit-test">http://bit.ly/angular-unit-test</a></li>
</ul>
</div></body></html>