<!DOCTYPE html><html lang="en" dir="ltr"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width initial-scale=1.0"><title>NodeJade</title><link href="/css/first-style.css" rel="stylesheet"><link rel="shortcut icon" href="/images/favicon.png"><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/cerulean/bootstrap.min.css" rel="stylesheet"><link href="/css/highlight/googlecode.css" rel="stylesheet" type="text/css"><link href="/css/style.css" rel="stylesheet"><script src="https://code.jquery.com/jquery-1.12.0.min.js"></script><script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<!-- Latest compiled and minified CSS --><script src="/js/elven-help.js"></script></head><body><nav class="navbar navbar-inverse"><div class="container"><div class="navbar-header"><button type="button" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar" class="navbar-toggle collapsed"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><a href="/" class="navbar-brand">Elvenware</a></div><div id="navbar" class="navbar-collapse collapse">       <ul class="nav navbar-nav"><li ng-class="{ active: isActive('/')}" class="trigger-collapse"><a href="/">Home</a></li><li><a href="/about.html">About</a></li></ul></div></div></nav><div class="container"><figure><img alt="Elvenware" src="/images/elvenwarelogo.png" class="elf-normal"/></figure><h1>NodeJade</h1><p>Welcome to NodeJade</p><ul><!--TOC_Start--><li><a href="#pug">Pug</a></li>
<li><a href="#clean">Clean</a></li>
<li><a href="#render-basics">Rendering Jade/Pug</a></li>
<li><a href="#input-controls">Input Controls</a></li>
<li><a href="#editors">Editors</a></li>
<li><a href="#loading-pug">Loading Pug</a></li>
<li><a href="#render-examples">Render Examples</a></li>
<li><a href="#unique-names">Use Unique Names</a></li>
<li><a href="#jade-indent">Pug Indent</a></li>
<li><a href="#pug">Pug</a></li>
<li><a href="#clean">Clean</a></li>
<li><a href="#render-basics">Rendering Jade/Pug</a></li>
<li><a href="#input-controls">Input Controls</a></li>
<li><a href="#editors">Editors</a></li>
<li><a href="#loading-pug">Loading Pug</a></li>
<li><a href="#render-examples">Render Examples</a></li>
<li><a href="#unique-names">Use Unique Names</a></li>
<li><a href="#jade-indent">Pug Indent</a></li><!--TOC_End--></ul></div><div class="container"><a class="anchor" id="pug"></a>
<h2>Pug</h2>
<p><a href="https://pugjs.org/api/getting-started.html">Pug</a> is a template library similar to <a href="http://haml.info/">HAML</a> and not totally unlike other popular template libraries such as <a href="http://handlebarsjs.com/">Handlebars</a>. It also is a bit like Markdown, in that it provides a shorthand syntax for composing HTML pages.</p>
<p><strong>NOTE</strong>: <em>The pug library used to be called Jade.</em></p>
<a class="anchor" id="clean"></a>
<h2>Clean</h2>
<p>Many developers like to use Pug instead of raw HTML for several reasons:</p>
<ul>
<li>It has a clean easy to read syntax</li>
<li>It is more succinct than HTML</li>
<li>It is also more flexible than HTML. For instance, it allows developers to declare variables and reuse code.</li>
</ul>
<p>Here is an example of how to layout a pug template:</p>
<pre>doctype html
html
    head
        title= title
        link(rel='stylesheet', href='/stylesheets/style.css')
    body
        nav
            ul
                li
                    a(href="/") page01
                li
                    a(href="/page02") page02
                li
                    a(href="/page03") page03
        h1 #{title}
        block content
</pre>
<p>When working with Pug, indentation is crucial. You should indent with either tabs or spaces, but not both. You frequently need to open your file in an editor that allows you to visualize your white space. Then you should count your spaces, and make sure it follows an exact pattern. Suppose, for instance, that you are using tabs for your indentation. In the pseudo code shown below, each hyphen (dash -) represents one tab. Example 1 is like what&#39;s shown above:</p>
<pre>doctype html
html
- head
- - title
- - link
- body
- - nav
- - - ul
- - - - li
- - - - li
- - - - li
- - h1
- - block content
</pre>
<p>Example 2 is a common pattern in bootstrap files:</p>
<pre>block content
- container
- - header
- - navbar
- - - nav
- - - - ul
- - - - - li
- - - - - li
- - - - - h3
- - - h1
- - - p
- - - h1
- - - div
- - - footer
- - - - p
</pre>
<p>When looking at the pseudo code above, the point is that you can explicitly count how many tabs appear before each HTML element. You want to achieve that level of specificity when working with Pug.</p>
<a class="anchor" id="render-basics"></a>
<h2>Rendering Jade/Pug</h2>
<p>Pug allows us to &quot;pass in&quot; variables (locals) that can be used on the page. This is known as templating.</p>
<p>When Pug is being translated to HTML, the renderer looks at the locals that are passed to it and substitutes these variables for markers on the page.</p>
<p>For instance, in this well-known chunk of code, where the locals have a property called title:</p>
<pre>router.get('/', routeParamMiddleware, function(req, res, next) {
    'use strict';
    res.render('index', {
        title: 'Week09-SessionBasics'
    });
});
</pre>
<p>We can then reference this in our Pug like this:</p>
<pre>p Welcome to #{title}
For more details on this process, see the overview here:
</pre>
<p><a href="https://pugjs.org/api/getting-started.html">https://pugjs.org/api/getting-started.html</a> (Links to an external site.)</p>
<p>Even if all this is clear, it still may not be obvious that the locals can take a complex object like user, and that we can reference the fields of that object in our Pug:</p>
<pre>response.render('account', {
    title: 'Google Account',
    user: request.user
});
</pre>
<p>And in the Pug:</p>
<pre>p DisplayName: #{user.displayName}
</pre>
<a class="anchor" id="input-controls"></a>
<h2>Input Controls</h2>
<p>Declare a text Input:</p>
<pre>input#dirToWalk(type='text', name='dirToWalk')
</pre>
<p>Put text in it with jQuery:</p>
<pre>$('#dirToWalk').val('/home/charlie/Documents/AllTest');
</pre>
<a class="anchor" id="editors"></a>
<h2>Editors</h2>
<p><strong>HINT</strong>: <em>Here are some ways to turn on visual whitespace in various editors:</em></p>
<ul>
<li>NotePad++: <strong>View | Show Symbol | Show White Space and Tab</strong></li>
<li>Geany: <strong>View | Editor | Show White Space</strong></li>
</ul>
<p>Most programming editors have options like these.</p>
<a class="anchor" id="loading-pug"></a>
<h2>Loading Pug</h2>
<p>While reading this section, you might want to also run the accompanying example program, found in the <a href="https://github.com/charliecalvert/JsObjects/tree/master/JavaScript/NodeCode/JadeRoutes">JadeRoutes</a> program from JsObjects.</p>
<p>In the next few paragraphs I describe how Pug templates get loaded in to our web applications. Much of the code I describe is autogenerated for you when you first create the express application. However, some of the code you have to write yourself. Of course, whether the code is autogenerated, or created automatically, you should be sure that you understand all the pieces and what they do.</p>
<p>In our <strong>app.js</strong> file we link in the views directory and tell express to use Pug. Note that their other ways for express to generate or <strong>render</strong> HTML files. But we are asking it to render HTML from Pug templates. We do so with code like this:</p>
<pre>app.set('views', path.join(__dirname, 'views'));
app.set('view engine', 'pug');
</pre>
<p>Once again, this code is found in <strong>app.js</strong>. It is frequently, perhaps even usually, auto-generated by the <strong>express-generator</strong>. But you should understand what it does.</p>
<p>After processing the above code, express knows to look for Pug files in the <strong>views</strong> directory. It also knows to <strong>render</strong> views using the Pug engine.</p>
<p>Our next chore is to tell express where to send requests sent from the browser. The user typically uses HTTP to compose URLs which are sent back to our express server. Depending on the shape of the URL, the express app can handle the request in any number of ways. The following code in <strong>app.js</strong> tells express where to send requests with a particular type of URL. This is known as routing:</p>
<pre>// Link in the index.js file from the routes directory
var routes = require('./routes/index');

// Tell the program to send routes of a certain type to **routes/index.js**.
app.use('/', routes.index);
</pre>
<p>The above code tells express the following:</p>
<ul>
<li>If the user types in <strong>http:www.example.com/</strong><ul>
<li>route the request to <strong>routes/index.js</strong>.</li>
</ul>
</li>
<li>If he types in <strong><a href="http://www.example.com/foo">http://www.example.com/foo</a></strong> the code is also routed to <strong>routes/index.js</strong>.</li>
</ul>
<p>In fact, with the code shown above, most requests from the server will end up going to <strong>routes/index.js</strong>. However, we shall see that it is possible to tell the server to route requests of a certain type to another file. For instance, requests to <strong><a href="http://www.example.com/foo">http://www.example.com/foo</a></strong> could be sent to <strong>routes/foo.js</strong>.</p>
<a class="anchor" id="render-examples"></a>
<h2>Render Examples</h2>
<p>When the browser sends a request for an HTML page, express can send the request to <strong>routes/index.js</strong>). Routes found in that file detail how our Pug templates should be rendered.</p>
<p>Here is an example <strong>routes/index.js</strong>. Study it with care:</p>
<pre>var express = require('express');
var router = express.Router();

/* ONE: GET home page. */
router.get('/', function(request, response, next) {
    'use strict';
    response.render('index', {
        author: 'Charlie Calvert',
        title: 'Solar Explorer'
    });
});

/* TWO: Energy Types Pug files routed here. The Pug is in the energy-types directory. */
router.get('/energy-types/:id', function(request, response) {
    'use strict';
    response.render('energy-types/' + request.params.id, {
        title: 'Energy Types'
    });
});

/* THREE: Renewable Pug files routed here. The Pug is in the renewables directory */
router.get('/renewables/:id', function(request, response, next) {
    'use strict';
    response.render('renewables/' + request.params.id, {
        title: 'Renewable Types'
    });
});

/* FOUR: Other Pug files routed here. The Pug is in the views directory. */
router.get('/:id', function(request, response, next) {
    'use strict';
    response.render(request.params.id, {
        title: 'Random types'
    });
});

module.exports = router;
</pre>
<p>Once again, I ask the you study this example carefully. All the routes in this file translate Pug into HTML and send the result to the server using HTTP. I have labeled each method as ONE, TWO, THREE and FOUR.</p>
<ul>
<li>ONE: This is where requests for the home page go. <strong><a href="http://www.example.com">http://www.example.com</a></strong></li>
<li>TWO: This is where requests for energy-types pages go: <strong><a href="http://www.example.com/energy-types/solar-page">http://www.example.com/energy-types/solar-page</a></strong></li>
<li>THREE: This is where requests for renewable pages go: <strong><a href="http://www.example.com/renewables/hydro-page">http://www.example.com/renewables/hydro-page</a></strong></li>
<li>FOUR: This where requests for uncategorized files go: <strong><a href="http://www.example.com/about-page">http://www.example.com/about-page</a></strong></li>
</ul>
<p><strong>NOTE</strong>: <em>We don&#39;t explicitly ask for HTML even though it is HTML that will be sent back to the brower. In other words, instead of writing this: <strong><a href="http://example.com/about.html">http://example.com/about.html</a></strong>, we write this: <strong><a href="http://example.com/about">http://example.com/about</a></strong>. It is a simple matter to teach express to respond properly to either request, but I find it simpler to dismiss with the HTML extension. But this is a matter of taste, and you should feel free to do what seems best to you.</em></p>
<p>Now let&#39;s consider the case where we want requests for anything have to do with renewables to be sent not to <strong>routes/index.js</strong> but to <strong>routes/renewables.js</strong>. We do this in large programs where we don&#39;t want to overload <strong>index.js</strong> with too many methods.</p>
<p>Suppose you create a file called <strong>routes/renewables.js</strong>. To set it up, do this in <strong>app.js</strong>:</p>
<pre>var renewables = require('./routes/renewables');
var routes = require('./routes/index');

// It's usually safest to insert the renewables middleware
// before the middleware found in **routes/index.js**
app.use('/renewables/', renewables);
app.use('/', routes);
</pre>
<p>In <strong>routes/renewables.js</strong>, add, for now, just one route:</p>
<pre>var express = require('express');
var router = express.Router();

router.get('/:id', function(request, response) {
    'use strict';
    response.render('renewables/' + request.params.id, {
        title: 'ElfComponent'
    });
});

module.exports = router;
</pre>
<p>Now consider where our different URLs lead:</p>
<ul>
<li><strong><a href="http://www.example.com">http://www.example.com</a></strong> =&gt; <strong>routes/index.js</strong></li>
<li><strong><a href="http://www.example.com/energy-types/my-jade-file">http://www.example.com/energy-types/my-jade-file</a></strong> =&gt; <strong>routes/index.js</strong></li>
<li><strong><a href="http://www.example.com/renewables/my-jade-file">http://www.example.com/renewables/my-jade-file</a></strong> =&gt; <strong>routes/renewables.js</strong></li>
<li><strong><a href="http://www.example.com/about">http://www.example.com/about</a></strong> =&gt; <strong>routes/index.js</strong></li>
</ul>
<p>Notice that the third request routes URLs with <strong><a href="http://example.com/renewables/">http://example.com/renewables/</a></strong> in them to the routes found in our <strong>routes/renewables.js</strong> file.</p>
<p>The next logical step would be to create <strong>routes/energy-types.js</strong>. To do so, just follow the template established by the example shown above for <strong>renewables</strong>.</p>
<p>Finally, we can, of course, define other routes in these files that have nothing to do with Pug. For instance, we might define a route in <strong>renewables.js</strong> that loads a JSON file:</p>
<pre>var express = require('express');
var router = express.Router();

/* ONE */
router.get('/getRenewables', function(request, response) {
    'use strict';
    fs.readFile('data/renewables.json', 'utf8', function(err, data) {
        if (err) {
            response.status(404).send(err);
        } else {
            var jsonAsObject = JSON.parse(data);
            response.send({ renewables: jsonAsObject });
        }
    });
});

/* TWO */
router.get('/:id', function(request, response) {
    'use strict';
    response.render('renewables/' + request.params.id, {
        title: 'ElfComponent'
    });
});

module.exports = router;
</pre>
<p>Looking at the above code, it should be obvious that route ONE has nothing to do with Pug. It is about loading JSON. Route TWO, on the other hand, has to be about Pug, since it calls render. As explained above, we have configured our express program to render Pug as HTML and send it back to the browser via HTTP.</p>
<p>Some resources:</p>
<ul>
<li><a href="http://jade-lang.com/">Home page</a></li>
<li><a href="http://html2pug.com/">HTML to Pug</a></li>
<li><a href="http://html2jade.aaron-powell.com/">HTML to Jade</a></li>
</ul>
<a class="anchor" id="unique-names"></a>
<h2>Use Unique Names</h2>
<p>Don&#39;t define the same name for different tasks. If you have a javascript file called <strong>/public/javascript/renewables.js</strong>, consider avoiding creating entities such as:</p>
<ul>
<li><strong>views/renewables.jade</strong></li>
<li><strong>routes/renewables.js</strong></li>
</ul>
<p>Also consider avoiding creating routes in <strong>routes/renewables.js</strong> that look like this:</p>
<pre>router.post('/renewables', function(request, response) { ... })
</pre>
<p>It is not necessarily an error to do this, but it can cause confusion. Consider instead:</p>
<ul>
<li><strong>views/renewables-page.jade</strong></li>
<li><strong>routes/renewables-routes.js</strong></li>
<li><strong>router.post(&#39;/getRenewables&#39;, function(request, response) { ... })</strong></li>
</ul>
<p>This may not be an idea solution, but it can help you sort out your code. If you don&#39;t like this kind of solution, then just be careful when loading javascript, Pug and calling routes.</p>
<a class="anchor" id="jade-indent"></a>
<h2>Pug Indent</h2>
<p>When thinking about Pug, indentation is crucial. Suppose I write this:</p>
<pre>div
p
</pre>
<p>That creates two separate, unrelated elements, a div and paragraph.</p>
<pre><div></div>
<p></p>
</pre>
<p>Suppose I write this:</p>
<pre>div
   p
</pre>
<p>Now the paragraph is part of the div because it is indented to the right beneath it.</p>
<pre><div>
   <p></p>
</div>
</pre>
<p>Suppose you create a div and make it your controller:</p>
<pre>div(ngController="MyController")
p {{firstName}}
</pre>
<p>The above code probably won&#39;t work because the paragraph is not part of the controller and hence <strong>{{firstName}}</strong> is out of scope. To fix it, do this:</p>
<pre>div(ngController="MyController")
   p {{firstName}}
</pre>
<p>Now the paragraph is part of the controller.</p>
<p>When trying to see exactly what is going on with the spacing in a Pug file, considering opening it in geany and turning on <strong>View | Editor | Show White Space</strong>. Or open it in NotePad++ and choose <strong>View | Show Symbol | Show White Space and Tab</strong>.</p>
<p>In WebStorm, you can also turn on visible white space, I believe it is: <strong>File | Settings | Editor | General | Appearance | White Space</strong>.</p>
</div></body></html>