<!DOCTYPE html><html lang="en" dir="ltr"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width initial-scale=1.0"><title>NodePackages</title><link rel="shortcut icon" href="/charlie/images/favicon.png"><!-- Latest compiled and minified CSS--><link rel="stylesheet" href="/components/bootstrap/dist/css/bootstrap.min.css"><!-- Optional theme--><link rel="stylesheet" href="/components/bootstrap/dist/css/bootstrap-theme.min.css"><link href="/libs/css/BootstrapIndex.css" rel="stylesheet" type="text/css"><link href="/css/style.css" rel="stylesheet" type="text/css"><script src="/components/jquery/dist/jquery.js"></script><script src="/components/angular/angular.js"></script><script src="/components/angular-route/angular-route.js"></script><script src="/components/bootstrap/dist/js/bootstrap.min.js"></script><script src="/libs/scripts/elvenware.js" type="text/javascript"></script><script src="/libs/scripts/Control.js"></script></head><body ng-app="elfApp"><div class="navbar navbar-inverse"><div class="container"><div class="navbar-header"><button type="button" data-toggle="collapse" data-target=".navbar-collapse" class="navbar-toggle"><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><a href="/" class="navbar-brand">Elvenware</a></div><div class="collapse navbar-collapse"><ul class="nav navbar-nav"><li class="active"><a href="/index.html">Home</a></li><li><a href="/about">About</a></li><li class="dropdown"><a href="#/" data-toggle="dropdown" class="dropdown-toggle">Dropdown<b class="caret"></b></a><ul class="dropdown-menu"><li class="dropdown-header">Core Code</li><li><a href="/development/index.html">Strongly Typed</a></li><li><a href="/development/web/index.html">Web & Scripts</a></li><li><a href="/development/cloud/index.shtml">Cloud</a></li><li class="divider"></li><li class="dropdown-header">OS and Tools</li><li><a href="/os/index.html">OS</a></li><li><a href="/development/database/index.html">Database</a></li><li><a href="/books/index.html">My Writing</a></li><li class="divider"></li><li class="dropdown-header">Art</li><li><a href="/charlie/Art/index.html">Poems & Photos</a></li><li><a href="/books/reading/index.html">Book Reviews</a></li><li><a href="/spirit/index.html">Spiritual</a></li><li class="divider"></li><li class="dropdown-header">Links</li><li><a href="/charlie/links.html">My Links</a></li><li><a href="http://www.github.com/charliecalvert">GitHub</a></li><li><a href="http://sourceforge.net/projects/elvenware/">Sourceforge</a></li></ul></li></ul></div><!-- /.nav-collapse--></div></div><div class="container"><figure><img alt="Elvenware" src="/charlie/images/elvenwarelogo.png"/></figure><h1>NodePackages</h1><p>Welcomes to NodePackages</p><ul><!--TOC_Start--><li><a href="#packageJson">Using package.json</a></li>
<li><a href="#adding-entries-to-package-json">Adding entries to package.json</a></li>
<li><a href="#module-missing">Cannot Find Module</a></li>
<li><a href="#more-on-node-and-package-json">More on Node and Package.json</a></li>
<li><a href="#error-couldn-t-read-dependencies">Error: Couldn&#39;t Read Dependencies</a></li>
<li><a href="#EADDRINUSE">Error: Address in Use EADDRINUSE</a></li><!--TOC_End--></ul><p>This document is focused on Node and the <strong>package.json</strong> file.</p>
<h2 id="packageJson">Using package.json</h2>
<p>All your projects should include a file called <strong>package.json</strong>. To create one from scratch, go to the root of your project and issue this command:</p>
<pre><code>npm init
</code></pre><p>You will be presented with a series of prompts to fill out. Just step through them one by one, leaving the ones that don&#39;t interest or confuse you blank. When you are done, there will be a file called <strong>package.json</strong> in your current directory.</p>
<p>To add packages to package.json, issue a command like this:</p>
<pre><code>npm install require --save
</code></pre><p>This installs the package called <strong>require</strong> into a folder called <strong>node_modules</strong>. It also saves a command to install the package into <strong>package.json</strong>. To reinstall <strong>require</strong> later, just type this command:</p>
<pre><code>npm install
</code></pre><p>This command processes <strong>package.json</strong> and automatically installs all the packages you <strong>saved</strong> into it. You can, of course, <strong>save</strong> information about many packages into a single <strong>package.json</strong> file.</p>
<p>You may have a project that depends on express. In such cases, the author of the project will probably create a file called <strong>package.json</strong> that will contain a reference to express. If this file exists, you can just type the following to install express and any other libraries that the project depends upon:</p>
<pre><code>npm install
</code></pre><p>Here is the contents of a simple package.json file that installs both express
and openid as well as a library called mdirp:</p>
<pre><code>    {
        &quot;name&quot;: &quot;OpenId04&quot;, 
        &quot;version&quot;: &quot;0.0.1&quot;,
        &quot;private&quot;: true,
        &quot;dependencies&quot;: {
            &quot;openid&quot;: &quot;latest&quot;,
            &quot;express&quot;: &quot;latest&quot;,
            &quot;mkdirp&quot;: &quot;latest&quot;
        }
    }
</code></pre><p>To put the thing you installed in package.json:</p>
<pre><code>npm install &quot;karma-script-launcher&quot; --save-dev
</code></pre><p>The key point to remember is that <strong>npm install</strong> processes the contents of the file called <strong>package.json</strong>. It installs all the libraries listed in that file in a local directory called <strong>node_modules</strong>. By locally, I mean that the directory is now included in your project.</p>
<p>If you follow the link to <a href="https://github.com/charliecalvert/JsObjects/blob/master/JavaScript/Design/BridgeSailor/package.json">package.json</a> for <a href="https://github.com/charliecalvert/JsObjects/tree/master/JavaScript/Design/BridgeSailor">BridgeSailor</a> you will see that karma is listed in that file:</p>
<pre><code>&quot;devDependencies&quot;: {
    &quot;requirejs&quot;: &quot;^2.1.11&quot;,
    &quot;karma&quot;: &quot;^0.12.14&quot;,
    &quot;karma-jasmine&quot;: &quot;^0.2.0&quot;,
    &quot;karma-requirejs&quot;: &quot;^0.2.1&quot;,
    &quot;karma-chrome-launcher&quot;: &quot;^0.1.3&quot;,
    &quot;karma-firefox-launcher&quot;: &quot;^0.1.3&quot;
}
</code></pre><p>This means that running <strong>npm install</strong> will install all the files listed above, including the <strong>karma</strong> library. </p>
<p>The point of <strong>npm install</strong> and <strong>package.json</strong> is that they work together to install a series of libraries, rather than asking you to type the following series of individual commands:</p>
<pre><code>npm install requirejs
npm install karma
npm install karma-jasmine
npm install karma-requirejs
npm install karma-chrome-launcher
npm install karma-firefox-launcher
</code></pre><p>Typing all of the above commands is time consuming, error prone and repetitious. Therefore we use <strong>package.json</strong>, which needs to be configured correctly once, and works automatically thereafter.</p>
<h2 id="adding-entries-to-package-json">Adding entries to package.json</h2>
<p>Usually all you need to do is process <strong>package.json</strong> by typing <strong>npm install</strong>. However, you may occassionally. want to add your own dependency to package.json. Here is how to put a library called <strong>karma-script-launcher</strong> in <strong>package.json</strong>:</p>
<pre><code>npm install &quot;karma-script-launcher&quot; --save-dev
</code></pre><p>The command shown above first installs <strong>karma-script-launcher</strong> into <strong>node_modules</strong>. It then adds an entry for it to <strong>package.json</strong>. Then next time you run <strong>npm install</strong> the <strong>karma-script-launcher</strong> package will be installed automatically because it is now included in <strong>package.json</strong>.</p>
<p>Consider this command:</p>
<pre><code>npm install karma --save-dev
</code></pre><p>This command installs the library, and saves the library name into <strong>package.json</strong> if it is not already there. </p>
<table>
<thead>
<tr>
<th style="text-align:left">Command</th>
<th style="text-align:left">Result</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><strong>npm install</strong></td>
<td style="text-align:left">process package.json and install all packages it references into <strong>node_modules</strong></td>
</tr>
<tr>
<td style="text-align:left"><strong>npm install chai</strong></td>
<td style="text-align:left">install chai into node_modules </td>
</tr>
<tr>
<td style="text-align:left"><strong>npm install chai --save</strong></td>
<td style="text-align:left">install chai into <strong>node_modules</strong> and add <strong>chai</strong> to <strong>package.json</strong></td>
</tr>
<tr>
<td style="text-align:left"><strong>npm install chai --save-dev</strong></td>
<td style="text-align:left">install chai into <strong>node_modules</strong> and add <strong>chai</strong> to <strong>package.json</strong> in a section listing packages used during development.</td>
</tr>
</tbody>
</table>
<h2 id="module-missing">Cannot Find Module</h2>
<p>One useful tip:</p>
<ul>
<li>Delete your <strong>node_modules</strong> folder</li>
<li>Try to start your project: <strong>npm start</strong></li>
</ul>
<p>You might see something like this:</p>
<pre><code>$ npm start

&gt; Week02-NpmBower@0.0.0 start /home/bcuser/Git/isit320-foo-2015/Week02-NpmBower
&gt; nodemon ./bin/www

28 Sep 17:54:30 - [nodemon] 1.7.1
28 Sep 17:54:30 - [nodemon] to restart at any time, enter `rs`
28 Sep 17:54:30 - [nodemon] watching: *.*
28 Sep 17:54:30 - [nodemon] starting `node ./bin/www`
module.js:338
    throw err;
    ^

Error: Cannot find module &#39;express&#39;
</code></pre><p>Study this error message. You are likely to see this error quite frequently. In particular, pattern <strong>Error: Cannot find module &#39;XXX&#39;</strong>. Getting that error usually means we have not run <strong>npm install</strong> or we have a problem in our <strong>package.json</strong> file. </p>
<p>The facts are simple. We often forget to run <strong>npm install</strong>. We make mistakes in our <strong>package.json</strong> files, usually because we forgot to include <strong>--save</strong> when we installed a particular package:</p>
<ul>
<li>Correct: npm install jquery --save</li>
<li>Incorrect: npm install jquery</li>
</ul>
<p>They both install <strong>jquery</strong>, but only the first adds an entry to <strong>package.json</strong>.  </p>
<p>Understanding the source of errors like those shown above is very helpful. Remember, we fix this error by running the following command:</p>
<pre><code>npm install
</code></pre><p>Understand when to run that command, and what it does. In particular, understand that it processes the contents of <strong>package.json</strong>.</p>
<h2 id="more-on-node-and-package-json">More on Node and Package.json</h2>
<p>NPM related issues are specific to node, not to Linux. If you were using node on Windows or the Mac, <strong>npm</strong> behaves in a very similar fashion.</p>
<p><strong>npm</strong> is the Node Package Manager. It installs libraries that are used by Node projects. Some of the libraries, such as <strong>fs</strong> (the File System package) are built into node, but most are open source projects hosted on GitHub. </p>
<p>Here are a few node packages (libraries) that I often install globally:</p>
<pre><code>/usr/lib
├─┬ express-generator@4.0.0
├─┬ grunt-cli@0.1.13
├─┬ jasmine-node@1.14.3
├─┬ js-beautify@1.5.1
├─┬ jshint@2.5.0
├─┬ karma-cli@0.0.4
└─┬ npm@1.4.9
</code></pre><p>These are stored here on a typical Linux system:</p>
<pre><code>$ ls -l /usr/lib/node_modules/
total 28
drwxr-xr-x 5 nobody charlie 4096 Apr 21 12:24 express-generator
drwxr-xr-x 6 nobody charlie 4096 Apr 20 09:57 grunt-cli
drwxr-xr-x 9 nobody charlie 4096 Apr 21 16:02 jasmine-node
drwxr-xr-x 4 nobody charlie 4096 Apr 26 15:43 js-beautify
drwxr-xr-x 6 nobody charlie 4096 Apr 21 18:31 jshint
drwxr-xr-x 4 nobody charlie 4096 Apr 27 10:23 karma-cli
drwxr-xr-x 9 root root 4096 May 5 07:56 npm
</code></pre><p>We install these global packages by typing something like: </p>
<pre><code>sudo npm install -g karma-cli
</code></pre><p>Where <strong>karma-cli</strong> is the package we want to install.</p>
<p>Each project also has packages that it uses. Each individual project might rely on a particular version of a package. For instance, one express project might use express 3.5.1, while another might use express 4.0.0. As a result, we don&#39;t install these packages globally. Instead, we install them inside the project we are currently using. This way, a particular project can rely on a particular version of a package. Specifically, we install them in a folder called <strong>node_modules</strong>.</p>
<p>Here, for instance, are the packages installed for a project called Week02Jade:</p>
<pre><code>charlie@MountainStreamsLinux:~/Git/Prog282/Week02Jade
$ ls -l node_modules/
total 28
drwxrwxr-x 3 charlie charlie 4096 Apr 26 16:44 body-parser
drwxrwxr-x 5 charlie charlie 4096 Apr 26 16:44 cookie-parser
drwxrwxr-x 3 charlie charlie 4096 Apr 26 16:44 debug
drwxrwxr-x 5 charlie charlie 4096 Apr 26 16:44 express
drwxrwxr-x 5 charlie charlie 4096 Apr 26 16:44 jade
drwxrwxr-x 3 charlie charlie 4096 Apr 26 16:44 morgan
drwxrwxr-x 2 charlie charlie 4096 Apr 26 16:44 static-favicon
</code></pre><p>These packages get installed when we type <strong>npm install</strong>. This action causes <strong>npm</strong> to process the contents of <strong>package.json</strong>, and to install the packages listed there:</p>
<pre><code>    $ cat package.json 
    {
      &quot;name&quot;: &quot;application-name&quot;,
      &quot;version&quot;: &quot;0.0.1&quot;,
      &quot;private&quot;: true,
      &quot;scripts&quot;: {
        &quot;start&quot;: &quot;DEBUG=my.application node ./bin/www&quot;
      },
      &quot;dependencies&quot;: {
        &quot;express&quot;: &quot;~4.0.0&quot;,
        &quot;static-favicon&quot;: &quot;~1.0.0&quot;,
        &quot;morgan&quot;: &quot;~1.0.0&quot;,
        &quot;cookie-parser&quot;: &quot;~1.0.1&quot;,
        &quot;body-parser&quot;: &quot;~1.0.0&quot;,
        &quot;debug&quot;: &quot;~0.7.4&quot;,
        &quot;jade&quot;: &quot;~1.3.0&quot;
      }
    }
</code></pre><p>Do you see that the directory listing is the same as the packages listed in <strong>package.json</strong>? The bottom line is that we need to think in terms of both global and local versions of our <strong>npm</strong> packages. </p>
<p>You can find all the <strong>npm</strong> packages here:</p>
<ul>
<li><a href="https://www.npmjs.org/">https://www.npmjs.org/</a></li>
</ul>
<h3 id="error-couldn-t-read-dependencies">Error: Couldn&#39;t Read Dependencies</h3>
<p>Sometimes you may also see this error:</p>
<pre><code>npm install
npm ERR! install Couldn&#39;t read dependencies
npm ERR! package.json ENOENT, open &#39;/home/charlie/package.json&#39;
etc...
</code></pre><p>This errror occurs, needless to say, because a copy of <strong>package.json</strong> is not found. As mentioned above, there are cases when a node program does not rely on any libraries, and hence <strong>package.json</strong> does not exist. But the error above usually occurs because you are not in the proper directory. For instance, you are in your home directory, and the program you want to run is in <strong>~/Git/JsObjects/JavaScript/Design/SimpleQueue</strong>.</p>
<p>To return to our main point: the primary problem that developers encounter when the see this error is simply forgetting to type <strong>npm install</strong>.</p>
<h3 id="EADDRINUSE">Error: Address in Use EADDRINUSE</h3>
<p>The EADDRINUSE (Error Address In Use) message usually means that the 
port is in use by another program. For instance, you left an 
instance of a program running on the port where you want to launch your
node server. Usually, fixing this is just a matter of finding the 
SSH or Windows command prompt where the server is running, and pressing
Ctrl-C to stop the server:</p>
<pre><code>C:\Git\P282\CanvasGrid&gt;node server.js
  Listening on port :30026
^C   &lt;== Here I press Ctrl-C
C:\Git\P282\CanvasGrid&gt;
</code></pre><p>An important variation on this error can occur if you are running upstart. Details about that variant of the <a href="#eaddrinuse-and-upstart">EEADDRINUSE error are discussed below</a>. </p>
</div></body></html>