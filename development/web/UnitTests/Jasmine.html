<!DOCTYPE html><html lang="en" dir="ltr"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width initial-scale=1.0"><title>Jasmine</title><link rel="shortcut icon" href="/charlie/images/favicon.png"><!-- Latest compiled and minified CSS--><link rel="stylesheet" href="/components/bootstrap/dist/css/bootstrap.min.css"><!-- Optional theme--><link rel="stylesheet" href="/components/bootstrap/dist/css/bootstrap-theme.min.css"><link href="/libs/css/BootstrapIndex.css" rel="stylesheet" type="text/css"><link href="/css/style.css" rel="stylesheet" type="text/css"><link href="/css/highlight/googlecode.css" rel="stylesheet" type="text/css"><script src="/components/jquery/dist/jquery.js"></script><script src="/components/angular/angular.js"></script><script src="/components/angular-route/angular-route.js"></script><script src="/components/bootstrap/dist/js/bootstrap.min.js"></script><script src="/libs/scripts/elvenware.js" type="text/javascript"></script><script src="/libs/scripts/Control.js"></script></head><body ng-app="elfApp"><div class="navbar navbar-inverse"><div class="container"><div class="navbar-header"><button type="button" data-toggle="collapse" data-target=".navbar-collapse" class="navbar-toggle"><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><a href="/" class="navbar-brand">Elvenware</a></div><div class="collapse navbar-collapse"><ul class="nav navbar-nav"><li class="active"><a href="/index.html">Home</a></li><li><a href="/about">About</a></li><li class="dropdown"><a href="#/" data-toggle="dropdown" class="dropdown-toggle">Dropdown<b class="caret"></b></a><ul class="dropdown-menu"><li class="dropdown-header">Core Code</li><li><a href="/development/index.html">Strongly Typed</a></li><li><a href="/development/web/index.html">Web & Scripts</a></li><li><a href="/development/cloud/index.shtml">Cloud</a></li><li class="divider"></li><li class="dropdown-header">OS and Tools</li><li><a href="/os/index.html">OS</a></li><li><a href="/development/database/index.html">Database</a></li><li><a href="/books/index.html">My Writing</a></li><li class="divider"></li><li class="dropdown-header">Art</li><li><a href="/charlie/Art/index.html">Poems & Photos</a></li><li><a href="/books/reading/index.html">Book Reviews</a></li><li><a href="/spirit/index.html">Spiritual</a></li><li class="divider"></li><li class="dropdown-header">Links</li><li><a href="/charlie/links.html">My Links</a></li><li><a href="http://www.github.com/charliecalvert">GitHub</a></li><li><a href="http://sourceforge.net/projects/elvenware/">Sourceforge</a></li></ul></li></ul></div><!-- /.nav-collapse--></div></div><div class="container"><figure><img alt="Elvenware" src="/charlie/images/elvenwarelogo.png"/></figure><h1>Jasmine</h1><p>Welcomes to Jasmine</p><ul><!--TOC_Start--><li><a href="#jasmine">Jasmine</a></li>
<li><a href="#async">Async</a></li>
<li><a href="#spyon">SpyOn</a></li>
<li><a href="#install-jasmine-node">Install Jasmine-node</a></li>
<li><a href="#create-route">Create Route</a></li>
<li><a href="#basic-jasmine-node">Basic Jasmine-Node</a></li>
<li><a href="#run-the-test-">Run the test:</a></li>
<li><a href="#permanently-delete-from-git-repository">Permanently Delete from Git Repository</a></li><!--TOC_End--></ul><h1 id="jasmine">Jasmine</h1>
<p>Jasmine is a unit testing tool for JavaScript. There are many
examples of how to use it in JsObjects.</p>
<ul>
<li><a href="https://github.com/charliecalvert/JsObjects/tree/master/JavaScript/UnitTests">Jasmine on JsObjects</a></li>
</ul>
<p>##Jasmine Spy</p>
<p>The <a href="https://github.com/charliecalvert/JsObjects/tree/master/JavaScript/UnitTests/JasmineSpyOn">JasmineSpy</a> program demonstrates how to:</p>
<ul>
<li>Use Jasmine to test async calls</li>
<li>SpyOn to create mock objects</li>
</ul>
<h2 id="async">Async</h2>
<p>The Async calls use done:</p>
<pre><code>it<span class="hljs-list">(<span class="hljs-string">"Integration test makes a real AJAX request"</span>, function<span class="hljs-list">(<span class="hljs-keyword">done</span>)</span> {
    textLoader.loadFile<span class="hljs-list">(<span class="hljs-string">"Sources.html"</span>, function<span class="hljs-list">(<span class="hljs-keyword">responseText</span>)</span> {
        var bar = $<span class="hljs-list">(<span class="hljs-keyword">responseText</span>)</span>.filter<span class="hljs-list">(<span class="hljs-quoted">'#paragraph04</span>')</span>.html<span class="hljs-list">()</span><span class="hljs-comment">;</span>
        expect<span class="hljs-list">(<span class="hljs-keyword">bar</span>)</span>.toBe<span class="hljs-list">(<span class="hljs-quoted">'Fine</span> time.')</span><span class="hljs-comment">;</span>
        done<span class="hljs-list">()</span><span class="hljs-comment">;</span>
    })</span><span class="hljs-comment">;</span>
})</span><span class="hljs-comment">;</span>
</code></pre><p>Looking at the function above, do you see that the test is past <strong>done</strong>
as a parmater? Notice also that it calls <strong>done()</strong> when it is finished.
The call to done notifies Jasmine that your callback is complete.</p>
<h2 id="spyon">SpyOn</h2>
<p>Create a mock object and instrument the object so that you can learn 
key facts such as:</p>
<ul>
<li>Was the mock object called?</li>
<li><p>What parameters were passed to the mock object</p>
<p>  it(&quot;Tests that loadFile is called with Sources.html&quot;, function() {</p>
<pre><code>  <span class="hljs-comment">// get is stubbed and never really called</span>
  spyOn($, <span class="hljs-string">"get"</span>);
  textLoader.loadFile(<span class="hljs-string">"Sources.html"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">data</span>) </span>{
      <span class="hljs-built_in">console</span>.log(data);
  });
  expect($.get).toHaveBeenCalledWith(<span class="hljs-string">"Sources.html"</span>,     jasmine.any(<span class="hljs-built_in">Function</span>));
</code></pre><p>  });</p>
</li>
</ul>
<p>Here we use SpyOn to mock <strong>jQuery.get()</strong>: </p>
<pre><code>spyOn(<span class="hljs-variable">$,</span> <span class="hljs-string">"get"</span>);
</code></pre><p>Once we have mocked it, we cn ask questions, such what parameters was it called
with:</p>
<pre><code>expect($.<span class="hljs-keyword">get</span>).toHaveBeenCalledWith(<span class="hljs-string">"Sources.html"</span>,     jasmine.any(<span class="hljs-built_in">Function</span>));
</code></pre><p>Our question here is simple: <em>Was <em>*get</em></em> called with two parameters. The first
a string, the second a function. We expect the first parameter, the string, to
be &quot;Sources.html&quot;. </p>
<p>When we mock an object, it is never called. Instead it is stubbed. A fake object
is put in its place.</p>
<h1 id="install-jasmine-node">Install Jasmine-node</h1>
<pre><code>sudo npm install -g jasmine-<span class="hljs-keyword">node</span><span class="hljs-identifier"></span><span class="hljs-title"></span>
</code></pre><p>You will also want to install request locally:</p>
<pre><code>npm <span class="hljs-keyword">install</span> request
</code></pre><p>Or</p>
<pre><code>npm install request --<span class="hljs-built_in">save</span>-<span class="hljs-built_in">dev</span>
</code></pre><h1 id="create-route">Create Route</h1>
<p>Create a simple route you want to test:</p>
<pre><code>app.<span class="hljs-keyword">get</span>(<span class="hljs-string">'/hello'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(request, response)</span> </span>{ <span class="hljs-string">'use strict'</span>;
    response.send(<span class="hljs-string">'Hi there.'</span>);
});
</code></pre><h1 id="basic-jasmine-node">Basic Jasmine-Node</h1>
<p>Save the following as <strong>Tests/SimpleSpec.js</strong>:</p>
<pre><code>var request = require<span class="hljs-list">(<span class="hljs-quoted">'request</span>')</span><span class="hljs-comment">;</span>

describe<span class="hljs-list">(<span class="hljs-string">"A suite"</span>, function<span class="hljs-list">()</span> {
    it<span class="hljs-list">(<span class="hljs-string">"should respond with hello world"</span>, function<span class="hljs-list">(<span class="hljs-keyword">done</span>)</span> {
        request<span class="hljs-list">(<span class="hljs-string">"http://localhost:30025/hello"</span>, function<span class="hljs-list">(<span class="hljs-keyword">error</span>, response, body)</span> {
            expect<span class="hljs-list">(<span class="hljs-keyword">body</span>)</span>.toEqual<span class="hljs-list">(<span class="hljs-string">"Hi there."</span>)</span><span class="hljs-comment">;</span>
            done<span class="hljs-list">()</span><span class="hljs-comment">;</span>
        })</span><span class="hljs-comment">;</span>
    })</span><span class="hljs-comment">;</span>
})</span><span class="hljs-comment">; </span>
</code></pre><p>Your tests must be saved in a file that has spec as the last four
letters in the name. For instance: FooSpec.js is good. SpecFoo.js
is not good.</p>
<h1 id="run-the-test-">Run the test:</h1>
<p>Now run start your server running in one shell:</p>
<pre><code><span class="hljs-keyword">node</span><span class="hljs-identifier"> </span><span class="hljs-title">Server</span>.js
</code></pre><p>Then open a second shell and run your tests:</p>
<pre><code>jasmine-<span class="hljs-keyword">node</span><span class="hljs-identifier"> </span><span class="hljs-title">Tests</span>/
</code></pre><h1 id="permanently-delete-from-git-repository">Permanently Delete from Git Repository</h1>
<p>A tool called BFG can make permanently deleting files from a repository
fairly easy. </p>
<ul>
<li><a href="http://www.elvenware.com/charlie/development/cloud/Git.html#permanent-delete">Elvenware Git</a></li>
</ul>
</div></body></html>