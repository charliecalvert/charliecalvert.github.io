<!DOCTYPE html>
<html dir="ltr">

<head>
	<meta charset="utf-8" />
	<title>MySql</title>
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="shortcut icon" href="Images/favicon.png">
	<!-- Latest compiled and minified CSS -->
	<link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap.min.css">
	<!-- Optional theme -->
	<link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap-theme.min.css">
	<link href="Styles/BootstrapIndex.css" rel="stylesheet" type="text/css" />
	<!-- Latest compiled and minified JavaScript - Move to bottom of body element -->
	<script src="//code.jquery.com/jquery.js"></script>
	<script src="//netdna.bootstrapcdn.com/bootstrap/3.0.0/js/bootstrap.min.js"></script>
	<script src="Scripts/elvenware.js" type="text/javascript"></script>
</head>

<body>



	<div class="navbar navbar-inverse navbar-fixed-top">
		<div class="container">
			<div class="navbar-header">
				<button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
					<span class="icon-bar"> </span>
					<span class="icon-bar"> </span>
					<span class="icon-bar"> </span>
				</button>
				<a class="navbar-brand" href="/charlie/index.html">Elvenware</a>
			</div>
			<div class="collapse navbar-collapse">
				<ul class="nav navbar-nav">
					<li class="active"><a href="/charlie/index.html">Home</a></li>
					<li><a href="/charlie/contents.html">About</a></li>
					<li class="dropdown">
						<a href="#" class="dropdown-toggle" data-toggle="dropdown">Dropdown <b class="caret"></b></a>
						<ul class="dropdown-menu">
							<li class="dropdown-header">Core Code</li>
							<li><a href="/charlie/development/index.html">Strongly Typed</a></li>
							<li><a href="/charlie/development/web/index.html">Web &amp; Scripts</a></li>
							<li><a href="/charlie/development/cloud/index.shtml">Cloud</a></li>
							<li class="divider"></li>
							<li class="dropdown-header">OS and Tools</li>
							<li><a href="/charlie/os/index.html">OS</a></li>
							<li><a href="/charlie/development/database/index.html">Database</a></li>
							<li><a href="/charlie/books/index.html">My Writing</a></li>
							<li class="divider"></li>
							<li class="dropdown-header">Art</li>
							<li><a href="/charlie/Art/index.html">Poems &amp; Photos</a></li>
							<li><a href="/charlie/books/reading/index.html">Book Reviews</a></li>
							<li><a href="/charlie/spirit/index.html">Spiritual</a></li>
							<li class="divider"></li>
							<li class="dropdown-header">Links</li>
							<li><a href="/charlie/links.html">My Links</a></li>
							<li><a href="http://www.github.com/charliecalvert">GitHub</a></li>
							<li><a href="http://sourceforge.net/projects/elvenware/">Sourceforge</a></li>
						</ul>
					</li>
				</ul>
			</div><!--/.nav-collapse -->
		</div>
	</div>

	<div class="container">

		<div class="starter-template">
			<figure><img alt="Elvenware" src="Images/elvenwarelogo.png" /></figure>
<h2>Table of Contents</h2>
<ul>
	<li><a href='#mysql'>MySql</a></li>
	<li><a href='#install-on-windows'>Install on Windows</a></li>
	<li><a href='#is-mysql-running'>Is MySQL Running?</a></li>
	<li><a href='#mysql-workbench'>MySQL WorkBench</a></li>
	<li><a href='#installOnLinux'>Install LAMP on Linux</a></li>
	<li><a href='#use-mysqladmin.'>Use MySqlAdmin.</a></li>
	<li><a href='#logging-in'>Logging in</a></li>
	<li><a href='#createdatabase'>Create a database</a></li>
	<li><a href='#users'>Create, Delete and Explore Users</a></li>
	<li><a href='#grant'>Grant</a></li>
	<li><a href='#password'>Change Password</a></li>
	<li><a href='#userSignIn'>Sign in as a User</a></li>
	<li><a href='#createtable'>Create Table</a></li>
	<li><a href='#insert'>Insert Data into Tables</a></li>
	<li><a href='#compare'>Comparing Techniques for Creating Tables</a></li>
	<li><a href='#php'>Simple PHP Script</a></li>
	<li><a href='#python'>Python</a></li>
	<li><a href='#onetomany'>One to Many</a></li>
	<li><a href='#onetomanyscript'>One to Many Scripts</a></li>
	<li><a href='#dump'>Backup (Dump) a Database</a></li>
</ul>
<h2 id="mysql">MySql</h2>
<p>Learn about installing LAMP: Linux, Apache, MySQL, Python.</p>
<h2 id="install-on-windows">Install on Windows</h2>
<p>The MySQL site makes it look, at first, as if you have to pay to download the product. This is not true. MySQL is an open source project. For the download, try this <a href="http://www.mysql.com/downloads/installer/">page</a>. Be sure you turn to the Download tab, if you are not there already. You can also download it using the Web Platform Installer from Microsoft.</p>
<p><a href="http://www.mysql.com/downloads/installer/">http://www.mysql.com/downloads/installer/</a></p>
<p><a href="../../../images/development/MySql01.png"><img src="../../../images/development/MySql01Small.png" alt="MySql Install Screen" /></a></p>
<p><a href="../../../images/development/MySql02.png"><img src="../../../images/development/MySql02Small.png" alt="My SQL Main Screen of Install" /></a></p>
<p><strong>Figure 02: My SQL Main Screen of Install (Click to enlarge.)</strong></p>
<p>When prompted, I choose to install the development server.</p>
<figure>
<img src="../../../images/development/MySql03Small.png" alt="Configuration screen for developer server" /><figcaption>Configuration screen for developer server</figcaption>
</figure>
<p><strong>Figure 03: The configuration screen for the developer server.</strong></p>
<p>This may have been a glitch on my system, but during the install, a blank command prompt type screen appeared labeled Python. This screen appeared to hang for well over 5 minutes, perhaps closer to 10 minutes. I put my cursor in the screen and pressed enter and it ran a script, and the rest of the install went very quickly.</p>
<h2 id="is-mysql-running">Is MySQL Running?</h2>
<p><a href="http://dev.mysql.com/doc/refman/5.1/en/windows-start-service.html">http://dev.mysql.com/doc/refman/5.1/en/windows-start-service.html</a></p>
<h2 id="mysql-workbench">MySQL WorkBench</h2>
<p>MySQL Workbench is avilable on both Windows and on <a href="http://dev.mysql.com/downloads/workbench/#downloads">Linux</a>. It has replaced the now outdated My SQL Browser and its related tools.</p>
<p><a href="../../../images/development/MySql04.png"><img src="../../../images/development/MySql04Small.png" alt="Using MySql Workbench to query the default city table" /></a></p>
<p><strong>Figure 04: Using MySql Workbench to query the default city table. (Click to englarge)</strong></p>
<p>Here is how to set up MySQLWorkbench on Linux. Begin by ensurng the prereqs are installed:</p>
<pre class="code"><code>sudo apt-get install libctemplate0 libzip1 python-pysqlite2 mysql-client python-crypto python-paramiko
sudo apt-get install libgtkmm-2.4-1c2a</code></pre>
<p>Then download the workbench:</p>
<ul>
<li><a href="http://www.mysql.com/downloads/workbench/#downloads">http://www.mysql.com/downloads/workbench/#downloads</a></li>
<li><a href="https://help.ubuntu.com/community/MySqlWorkBench">https://help.ubuntu.com/community/MySqlWorkBench</a></li>
</ul>
<p>Finally, you are ready to install the file you downloaded:</p>
<pre class="code"><code>sudo dpkg -i mysql-workbench-gpl-5.2.38-1ubu1104-i386.deb </code></pre>
<p>After this it should be available as an item in your GUI menu for the OS. </p>
<h2 id="installOnLinux">Install LAMP on Linux</h2>
<p>LAMP means: Linux, Apache, MySQL and Php/Python. So if you install this one &quot;feature,&quot; you have everything you need to get to work.</p>
<pre class="code"><code>sudo apt-get install tasksel
sudo tasksel install lamp-server</code></pre>
<p>You might get an error saying: <strong>tasksel: aptitude failed (100).</strong>That might mean that your system is not up to date. To fix the problem, try the following:</p>
<p><strong>sudo apt-get update</strong></p>
<p><strong>sudo apt-get upgrade</strong></p>
<p><strong>sudo tasksel install lamp-server</strong></p>
<p>Probably only 1 and 3 are necessary, but there really is no reason you would not normally want to have a fully updated system, so issueing all three commands is best in most cases. The first command assures that you are pulling from the most recent sources, the second actually updates the programs and files on your system, and the third will, of course, install LAMP.</p>
<p>If you just want to install MySql and not the rest of LAMP:</p>
<pre class="code"><code>sudo apt-get install mysql-server</code></pre>
<p>These images might be helpful:</p>
<p><img src="/charlie/books/CloudNotes/Images/Lamp01.png" alt="One" /> <img src="/charlie/books/CloudNotes/Images/Lamp02.png" alt="One" /> <img src="/charlie/books/CloudNotes/Images/Lamp03.png" alt="One" /> <img src="/charlie/books/CloudNotes/Images/Lamp04.png" alt="One" /></p>
<p>More details:</p>
<p><a href="https://help.ubuntu.com/8.04/serverguide/C/mysql.html">https://help.ubuntu.com/8.04/serverguide/C/mysql.html</a></p>
<h2 id="use-mysqladmin.">Use MySqlAdmin.</h2>
<p>I explain a little about how to use MySqlAdmin on <a href="linux-user-password.html">the passwords page</a>.</p>
<h2 id="logging-in">Logging in</h2>
<p>The text shown shown here and in many of the following listings are from the Linux command prompt. However, an install of MySQL on Windows also provides you with a command line tool called <strong>mysql.exe</strong>. The install should provide a link to it in the start menu, or try looking in a folder similar to this one:</p>
<pre class="code"><code>C:\Program Files\MySQL\MySQL Server 5.1\bin&gt;</code></pre>
<p>Among the first things you will want to do is start <strong>mysql</strong>:</p>
<pre class="code"><code>charlie@WesternSea:~$ mysql -u root -p
Enter password: 
Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 118
Server version: 5.1.58-1ubuntu1 (Ubuntu)

Copyright (c) 2000, 2010, Oracle and/or its affiliates. All rights reserved.
This software comes with ABSOLUTELY NO WARRANTY. This is free software,
and you are welcome to modify and redistribute it under the GPL v2 license

Type &#39;help;&#39; or &#39;\h&#39; for help. Type &#39;\c&#39; to clear the current input statement.

mysql&gt;</code></pre>
<p>Just for the sake a clarity, the following shows that everything (except the command line prompt) looks pretty much the same in Windows:</p>
<pre class="code"><code>C:\Program Files\MySQL\MySQL Server 5.1\bin&gt;mysql -u root -p
Enter password: ********
Welcome to the MySQL monitor. Commands end with ; or \g.
Your MySQL connection id is 7
Server version: 5.1.57-community MySQL Community Server (GPL)

Copyright (c) 2000, 2010, Oracle and/or its affiliates. All rights reserved.
This software comes with ABSOLUTELY NO WARRANTY. This is free software,
and you are welcome to modify and redistribute it under the GPL v2 license

Type &#39;help;&#39; or &#39;\h&#39; for help. Type &#39;\c&#39; to clear the current input statement.

mysql&gt;</code></pre>
<h2 id="createdatabase">Create a database</h2>
<p>Whether you are in Linux or Windows, you now want to create a database:</p>
<pre class="code"><code>mysql&gt; show databases;
+--------------------+
| Database           |
+--------------------+
| information_schema |
| mysql              |
| phpmyadmin         |
| wordpress          |
+--------------------+
4 rows in set (0.00 sec)

mysql&gt; create database script_child

mysql&gt; show databases;
+--------------------+
| Database           |
+--------------------+
| information_schema |
| script_child       |
| mysql              |
| phpmyadmin         |
| wordpress          |
+--------------------+
5 rows in set (0.00 sec)</code></pre>
<h2 id="users">Create, Delete and Explore Users</h2>
<p>You can create a user with this command:</p>
<pre class="code"><code> CREATE USER &#39;charlie&#39;@&#39;localhost&#39; IDENTIFIED BY &#39;xxx&#39;;</code></pre>
<p>The IDENTIFIED BY bit is how you specify the password. So the password in this case is 'xxx'.</p>
<p>To see the users you have created, enter the following command:</p>
<pre class="code"><code>select host, user from mysql.user;</code></pre>
<p>For instance, here is brief session showing how to see two of the many fields in the <strong>mysql.user</strong>table. </p>
<pre class="code"><code>mysql&gt; use mysql;
Reading table information for completion of table and column names
You can turn off this feature to get a quicker startup with -A

Database changed
mysql&gt; select host, user from user;
+------------+------------------+
| host       | user             |
+------------+------------------+
| 127.0.0.1  | root             |
| WesternSea | root             |
| localhost  | charlie          |
| localhost  | debian-sys-maint |
| localhost  | phpmyadmin       |
| localhost  | root             |
+------------+------------------+
6 rows in set (0.00 sec)

mysql&gt; </code></pre>
<p>For more details on the mysql.user table type <strong>describe mysql.user</strong>.</p>
<p>If you need to delete a user, the command looks like this:</p>
<pre class="code"><code>drop user &#39;charlie&#39;@&#39;localhost&#39;;</code></pre>
<h2 id="grant">Grant</h2>
<pre class="code"><code>grant all privileges on script_child.* to &#39;charlie&#39;@&#39;localhost&#39; with grant option;
Query OK, 0 rows affected (0.00 sec)</code></pre>
<p>If the above does not work, try putting the database name in quotes: 'script_child'.* to etc.</p>
<p>What privileges does he have?</p>
<pre class="code"><code> show grants for &#39;charlie&#39;@&#39;localhost&#39;;</code></pre>
<h2 id="password">Change Password</h2>
<p>To change the root or user password, see this page:</p>
<p><a href="/charlie/development/database/mysql/linux-user-password.html">linux-user-password.html</a></p>
<h2 id="userSignIn">Sign in as a User</h2>
<p>Use the following technique to check the password for your user on your database. We normally sign in to MySQL like this:</p>
<pre class="code"><code>mysql -u root -p</code></pre>
<p>This signs you in as the MySQL administrator. But you can also sign in as your user. You will have less rights, but sometimes it is a good way to check the permissions for your user. Also, this is the experience that others will have if you give them rights to act as a user, but not as an administrator. For instance, my user in MySQL is charlie, so I can sign into the database like this:</p>
<pre class="code"><code>mysql -u charlie -p</code></pre>
<p>I will then be prompted for my user password. If I don't have the user set up right, then I won't be able to get into the database.</p>
<p>Here, for instance, is what failure looks like:</p>
<pre class="code"><code>charlie@ip-10-195-152-218:~$ mysql -u charlie -pEnter password:ERROR 1045 (28000): Access denied for user &#39;charlie&#39;@&#39;localhost&#39; (using password: YES)charlie@ip-10-195-122-228:~$</code></pre>
<p>And here is success:</p>
<pre class="code"><code>charlie@ip-10-195-152-218:~$ mysql -u charlie -pEnter password:Welcome to the MySQL monitor. Commands end with ; or \g.Your MySQL connection id is 850Server version: 5.5.28-0ubuntu0.12.04.2 (Ubuntu)
Copyright (c) 2000, 2012, Oracle and/or its affiliates. All rights reserved.
Oracle is a registered trademark of Oracle Corporation and/or itsaffiliates. Other names may be trademarks of their respectiveowners.
Type &#39;help;&#39; or &#39;\h&#39; for help. Type &#39;\c&#39; to clear the current input statement.
mysql&gt;</code></pre>
<p> </p>
<h2 id="createtable">Create Table</h2>
<p>I will show two ways to create a table. Read the section below on comparing the two techniques in order to understand which technique is best for you. Here is the first technique:</p>
<pre class="code"><code>mysql&gt; create table presidents (id int NOT NULL AUTO_INCREMENT, first varchar(128), last varchar(128), PRIMARY KEY (id));

mysql&gt; describe presidents;
+-------+--------------+------+-----+---------+----------------+
| Field | Type         | Null | Key | Default | Extra          |
+-------+--------------+------+-----+---------+----------------+
| id    | int(11)      | NO   | PRI | NULL    | auto_increment |
| first | varchar(128) | YES  |     | NULL    |                |
| last  | varchar(128) | YES  |     | NULL    |                |
+-------+--------------+------+-----+---------+----------------+
3 rows in set (0.01 sec)</code></pre>
<p>And here is a second technique:</p>
<pre class="code"><code>mysql&gt; create table presidents (id int, first varchar(128), last varchar(128));
Query OK, 0 rows affected (0.01 sec)

mysql&gt; show tables;
+------------------------+
| Tables_in_script_child |
+------------------------+
| presidents             |
+------------------------+
1 row in set (0.00 sec)

mysql&gt; alter table presidents add primary key (id);
Query OK, 0 rows affected (0.02 sec)
Records: 0  Duplicates: 0  Warnings: 0</code></pre>
<p>Here is another example of the first technique:</p>
<pre class="code"><code>create table elvenpages (id int NOT NULL AUTO_INCREMENT, path varchar(128), folder varchar(128), PRIMARY KEY (id));</code></pre>
<p>Show table structure:</p>
<pre class="code"><code>mysql&gt; describe presidents;
+-------+--------------+------+-----+---------+-------+
| Field | Type         | Null | Key | Default | Extra |
+-------+--------------+------+-----+---------+-------+
| id    | int(11)      | NO   | PRI | 0       |       |
| first | varchar(128) | YES  |     | NULL    |       |
| last  | varchar(128) | YES  |     | NULL    |       |
+-------+--------------+------+-----+---------+-------+
3 rows in set (0.00 sec)</code></pre>
<h2 id="insert">Insert Data into Tables</h2>
<p>If you used the first technique from the previous section, write this:</p>
<pre class="code"><code>mysql&gt; insert into presidents (first, last) values (&#39;George&#39;, &#39;Washington&#39;);</code></pre>
<p>If you used the second technique, write this:</p>
<pre class="code"><code>mysql&gt; insert into presidents (id, first, last) values (1, &#39;George&#39;, &#39;Washington&#39;);
Query OK, 1 row affected (0.00 sec)

mysql&gt; select * from presidents;
+----+--------+------------+
| id | first  | last       |
+----+--------+------------+
|  1 | George | Washington |
+----+--------+------------+
1 row in set (0.00 sec) o

mysql&gt; insert into presidents (id, first, last) values (2, &#39;John&#39;, &#39;Adams&#39;);
Query OK, 1 row affected (0.00 sec)

mysql&gt; select * from presidents;
+----+--------+------------+
| id | first  | last       |
+----+--------+------------+
|  1 | George | Washington |
|  2 | John   | Adams      |
+----+--------+------------+
2 rows in set (0.00 sec)

mysql&gt;</code></pre>
<h2 id="compare">Comparing Techniques for Creating Tables</h2>
<p>There are two ways to create a table, here is the first, and least powerful way:</p>
<pre class="code"><code>mysql&gt; create table presidents (id int, first varchar(128), last varchar(128));      
mysql&gt; alter table presidents add primary key (id);  </code></pre>
<p>If you use this technique, then you need to explicitly define the ID when you do the insert:</p>
<pre class="code"><code>mysql&gt; insert into presidents (id, first, last) values (1, &#39;George&#39;, &#39;Washington&#39;);
mysql&gt; insert into presidents (id, first, last) values (2, &#39;John&#39;, &#39;Adams&#39;); </code></pre>
<p>Notice that I include unique ID's of 1 and 2 in the insert statement. This works, but becomes unwieldy when writing code on the client side, since it is hard to guess what the next unique number in the sequence will be in all circumstances.</p>
<p> To get around this problem, first drop your old table and then use this technique to recreate the table:</p>
<pre class="code"><code>drop mytable;
create table mytable (id int NOT NULL AUTO_INCREMENT, path varchar(128), folder varchar(128), PRIMARY KEY (id));  </code></pre>
<p>By using <strong>auto_increment</strong> you ensure that the ID is incremented automatically by the database itself, and hence each ID will be unique: the database guarantees it. Now you no longer have to include the ID when you do the insert:</p>
<pre class="code"><code>insert into presidents (first, last) values (&#39;George&#39;, &#39;Washington&#39;);</code></pre>
<p>Because the ID is set to auto_increment, the database will insert the auto-incremented ID automatically.</p>
<p>Here is a description of a table that uses auto_increment:</p>
<pre class="code"><code>mysql&gt; describe additions;
+----------+---------+------+-----+---------+----------------+
| Field    | Type    | Null | Key | Default | Extra          |
+----------+---------+------+-----+---------+----------------+
| id       | int(11) | NO   | PRI | NULL    | auto_increment |
| operanda | int(11) | YES  |     | NULL    |                |
| operandb | int(11) | YES  |     | NULL    |                |
| answer   | int(11) | YES  |     | NULL    |                |
+----------+---------+------+-----+---------+----------------+
4 rows in set (0.02 sec)

mysql&gt;</code></pre>
<p>Let's convert a table without autoincrement ID to one that uses autoincrement. The code below first:</p>
<ul>
<li>Describes what the table looked like before the conversion</li>
<li>Performs the conversion</li>
<li>Shows the table with the new ID's</li>
<li>Then describes the table with the new auto_increment field:</li>
</ul>
<pre class="code"><code>mysql&gt; describe presidents;
+-------+--------------+------+-----+---------+-------+
| Field | Type         | Null | Key | Default | Extra |
+-------+--------------+------+-----+---------+-------+
| id    | int(11)      | NO   | PRI | 0       |       |
| first | varchar(128) | YES  |     | NULL    |       |
| last  | varchar(128) | YES  |     | NULL    |       |
+-------+--------------+------+-----+---------+-------+
3 rows in set (0.01 sec)    
    
mysql&gt; alter table presidents drop column id;
mysql&gt; alter table presidents add column (id int NOT NULL AUTO_INCREMENT, primary key (id));

mysql&gt; select * from presidents;
+--------+------------+----+
| first  | last       | id |
+--------+------------+----+
| George | Washington |  1 |
| John   | Adams      |  2 |
+--------+------------+----+
2 rows in set (0.00 sec)

mysql&gt; describe presidents;
+-------+--------------+------+-----+---------+----------------+
| Field | Type         | Null | Key | Default | Extra          |
+-------+--------------+------+-----+---------+----------------+
| first | varchar(128) | YES  |     | NULL    |                |
| last  | varchar(128) | YES  |     | NULL    |                |
| id    | int(11)      | NO   | PRI | NULL    | auto_increment |
+-------+--------------+------+-----+---------+----------------+
3 rows in set (0.01 sec)

mysql&gt;</code></pre>
<p>The code shown above leaves the ID field as the last in the table, which I find confusing. It might be simpler in at least some cases to simply delete the table and recreat it. Consider using the <a href="#dump">MySqlDump utility</a>to aid in this process.</p>
<h2 id="php">Simple PHP Script</h2>
<p>Here is your script for selecting from the Presidents table, which you can place anywhere on your server:</p>
<pre class="code"><code>&lt;html&gt;
&lt;body&gt;
&lt;?php
  print &quot;&lt;h1&gt;Presidents&lt;/h1&gt;&quot;;

  $con = mysql_connect(&quot;localhost&quot;,&quot;charlie&quot;,&quot;xxx&quot;);
  if (!$con)
  {
    die(&#39;Could not connect: &#39; . mysql_error());
  }

  $db_selected = mysql_select_db(&quot;script_child&quot;, $con);
  if (!$db_selected) 
  {
    die (&#39;Can\&#39;t use database : &#39; . mysql_error());
  }

  $result = mysql_query(&quot;SELECT * FROM presidents&quot;);

  // Check result
  // This shows the actual query sent to MySQL, and the error. Useful for debugging.
  if (!$result) {
    $message = &#39;Invalid query: &#39; . mysql_error() . &quot;\n&quot;; 
    die($message);
  }

  while($row = mysql_fetch_array($result))
  {
    echo $row[&#39;first&#39;] . &quot; &quot; . $row[&#39;last&#39;];
    echo &quot;&lt;br /&gt;&quot;;
  }

  mysql_close($con);
?&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre>
<h2 id="python">Python</h2>
<p>First <a href="http://www.elvenware.com/charlie/development/web/Python/install.html#mysqldb">make sure that MySQLdb is installed</a>. Then write your script, which we shall call data_python.py</p>
<pre class="code"><code>#!/usr/bin/python
import MySQLdb;
import cgi

print &quot;Content-Type: text/html\n\n&quot;
print
print &quot;&lt;html&gt;\n&quot;
print &quot;&lt;head&gt;\n&quot;
print &quot;&lt;meta content=&#39;text/html; charset=utf-8&#39; http-equiv=&#39;Content-Type&#39;&gt;\n&quot;
print &quot;\t&lt;title&gt;Info Form&lt;/title&gt;\n&quot;
print &quot;&lt;/head&gt;\n&quot;
print &quot;&lt;body BGCOLOR = white&gt;\n&quot;
db = MySQLdb.connect(host=&quot;localhost&quot;, port=80, user=&quot;charlie&quot;, passwd=&quot;xxx&quot;, db=&quot;script_child&quot;)
cursor = db.cursor()
cursor.execute(&quot;select first, last from presidents&quot;)
rows = cursor.fetchall()
for row in rows:
    print &quot;&lt;p&gt;%s, %s&lt;/p&gt;&quot; % (row[0], row[1])
print &quot;&lt;/body&gt;\n&quot;
print &quot;&lt;/html&gt;\n&quot;</code></pre>
<p>If you want, read /etc/apache2/sites-available/default. In there you will find:</p>
<pre class="code"><code>    ScriptAlias /cgi-bin/ /usr/lib/cgi-bin/
    &lt;Directory &quot;/usr/lib/cgi-bin&quot;&gt;
        AllowOverride None
        Options +ExecCGI -MultiViews +SymLinksIfOwnerMatch
        Order allow,deny
        Allow from all
    &lt;/Directory&gt;</code></pre>
<p>Now you know where to put your script: /usr/lib/cgi-bin. Be sure to make it executable:</p>
<pre class="code"><code>sudo chmod +x data_python.py</code></pre>
<p>People frequently make errors by entering the wrong user name, password or database. Be sure to  examine your connect line carefully, and ensure that you passing in the right information:</p>
<pre class="code"><code>db = MySQLdb.connect(host=&quot;localhost&quot;, port=80, user=&quot;charlie&quot;, passwd=&quot;xxx&quot;, db=&quot;script_child&quot;)</code></pre>
<p>Another frequent mistake involves the fields in your database as specified in your query. Be sure to examine the query carefully:</p>
<pre class="code"><code>cursor.execute(&quot;select first, last from presidents&quot;)</code></pre>
<h2 id="onetomany">One to Many</h2>
<pre class="code"><code>CREATE TABLE artist
(
  id int(11) NOT NULL auto_increment,
  first varchar(255),
  last varchar(255),
  description text,
  sex enum(&#39;male&#39;,&#39;female&#39;),
  date timestamp(14),
  PRIMARY KEY (id)
);</code></pre>
<p>Now the child table:</p>
<pre class="code"><code>CREATE TABLE art
(
  id int(11) NOT NULL auto_increment,
  title varchar(255),
  description text,
  genre enum(&#39;written word&#39;,&#39;painting&#39;, &#39;music&#39;, &#39;sculpture&#39;),
  artist_id int,
  date timestamp(14),
  PRIMARY KEY (id)
);</code></pre>
<p>Inert some data:</p>
<pre class="code"><code>INSERT INTO artist (first, last,description,sex,date) 
  VALUES(&#39;Jane&#39;, &#39;Austin&#39;, &#39;English author.&#39;,&#39;female&#39;,NOW());
INSERT INTO artist (first, last,description,sex,date) 
  VALUES(&#39;Thomas&#39;, &#39;Pynchon&#39;, &#39;American author.&#39;,&#39;male&#39;,NOW());
INSERT INTO artist (first, last,description,sex,date) 
  VALUES(&#39;J. K.&#39;, &#39;Rowling&#39;, &#39;English author.&#39;,&#39;female&#39;,NOW());
INSERT INTO art(title,description,genre,artist_id,date) VALUES (&#39;Emma&#39;,&#39;Boy meets girl&#39;,&#39;written word&#39;,1, NOW())  
INSERT INTO art(title,description,genre,artist_id,date) VALUES (&#39;Gravity\&#39;s Rainbow&#39;,&#39;World War II&#39;,&#39;written word&#39;,2,NOW());  
INSERT INTO art(title,description,genre,artist_id,date) VALUES (&#39;The Crying of Lot 49&#39;,&#39;Conspiracy&#39;,&#39;written word&#39;,2,NOW());    </code></pre>
<p>And run the one to many query:</p>
<pre class="code"><code>SELECT artist.id,artist.last as Artist,art.title as Title
FROM artist,art
WHERE artist.id = art.artist_id
ORDER BY artist.last ASC;</code></pre>
<h2 id="onetomanyscript">One to Many Scripts</h2>
<pre class="code"><code>&lt;html&gt;
&lt;body&gt;
&lt;?php
  print &quot;&lt;h1&gt;Art and Artist&lt;/h1&gt;&quot;;

  $con = mysql_connect(&quot;localhost&quot;,&quot;charlie&quot;,&quot;xxx&quot;);
  if (!$con)
  {
    die(&#39;Could not connect: &#39; . mysql_error());
  }

  $db_selected = mysql_select_db(&quot;charlie&quot;, $con);
  if (!$db_selected) 
  {
    die (&#39;Can\&#39;t use database : &#39; . mysql_error());
  }

  $result = mysql_query(&quot;SELECT artist.id, artist.last AS Artist, art.title AS Title FROM artist, art WHERE artist.id = art.artist_id ORDER BY artist.last ASC&quot;);

  // Check result
  // This shows the actual query sent to MySQL, and the error. Useful for debugging.
  if (!$result) {
    $message = &#39;Invalid query: &#39; . mysql_error() . &quot;\n&quot;; 
    die($message);
  }

  while($row = mysql_fetch_array($result))
  {
    echo $row[&#39;Artist&#39;] . &quot; &quot; . $row[&#39;Title&#39;];
    echo &quot;&lt;br /&gt;&quot;;
  }

  mysql_close($con);
?&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre>
<p>If you would like a somewhat more interesting layout, then you can delete the four lines beginning with <strong>while ($row... etc...</strong> and replace them with this table syntax:</p>
<pre class="code"><code> print &quot;&lt;table border=1&gt;&quot;;
print &quot;&lt;tr&gt;&lt;th&gt;Author&lt;/th&gt;&lt;th&gt;Title&lt;/th&gt;&lt;/tr&gt;&quot;;
while($row = mysql_fetch_array($result))
{
print &quot;&lt;tr&gt;&lt;td&gt;&quot; . $row[&#39;Artist&#39;] . &quot;&lt;/td&gt;&lt;td&gt;&quot; . $row[&#39;Title&#39;] . &quot;&lt;/td&gt;&lt;/tr&gt;&quot;; 
}
print &quot;&lt;/table&gt;&quot;;</code></pre>
<h2 id="dump">Backup (Dump) a Database</h2>
<p>You can backup, or dump, the complete description of a database with a command like the following:</p>
<pre class="code"><code>mysqldump -u root -p --database charlie --result-file=c:\users\charlie\documents\charlie.sql</code></pre>
<p>The <strong>mysqldump</strong> utility is generally available from any command prompt in Linux, and is available here in Windows:</p>
<pre class="code"><code>C:\Program Files\MySQL\MySQL Server 5.1\bin&gt;</code></pre>
<p>There are several parameters passed to <a href="http://dev.mysql.com/doc/refman/5.1/en/mysqldump.html">mysqldump</a> in the above example:</p>
<ul>
<li>The user who has rights to the database you want to backup: <strong>--u root</strong></li>
<li>A request to be prompted for a password: <strong>-p</strong></li>
<li>The file that you want to create to hold the output: <strong>--result-file=/home/charlie/charlie.sql</strong></li>
</ul>
<p>To make it work, you have to go to the command line (DOS prompt) and navigate to a directory similar to this one:</p>
<pre class="code"><code>C:\Program Files\MySQL\MySQL Server 5.1\bin&gt;</code></pre>
<p>There you will find the mysqldump program which you run like this:</p>
<pre class="code"><code>mysqldump -u root -p --database charlie --result-file=c:\users\charlie\documents\charlie.sql</code></pre>
<p>Looking at the above command, there are three parts to it.</p>
<ol type="1">
<li>Get in the MySql database utility:<strong>mysqldump -u root -p</strong></li>
<li>Specifiy the database you want to dump<strong>: --database charlie</strong></li>
<li>Define the output file: <strong>--result-file=c:\users\charlie\documents\charlie.sql</strong></li>
</ol>
<p>Put the all together into one command:</p>
<p>mysqldump -u root -p --database charlie --result-file=c:\users\charlie\documents\charlie.sql</p>
<p>To restore the database, just redirect the output into the mysql utility:</p>
<pre class="code"><code>mysql -u root -p &lt; c:\users\charlie\documents\charlie.sql</code></pre>
<p>Do it for a single table in the database, where the first line pulls a table called <strong>additions</strong>from a database called <strong>charlie,</strong>and the second line restores the table to a database called <strong>test:</strong></p>
<pre class="code"><code>mysqldump -u root -p --database charlie --table additions --result-file=bar.sql
mysql -u root -p --database test &lt; bar.sql</code></pre>
<p>Here is a more in depth description of how to restore the database:</p>
<ul>
<li><a href="http://stackoverflow.com/questions/105776/how-do-i-restore-a-mysql-dump-file">http://stackoverflow.com/questions/105776/how-do-i-restore-a-mysql-dump-file</a></li>
<li><a href="http://www.techiecorner.com/31/how-to-restore-mysql-database-from-sql-dump-file/">http://www.techiecorner.com/31/how-to-restore-mysql-database-from-sql-dump-file/</a></li>
</ul>
<!-- FOOTER -->
      <footer>
        <p class="pull-right"><a href="#">Back to top</a></p>        
		<p>Copyright &copy; <a href="/charlie/index.html">Charlie Calvert</a> |
		<a href="/charlie/contents.html">Site Overview</a> |
		<a href="/charlie/development/index.html">Writing Code</a> |
		<a href="/charlie/development/web/index.html">Web</a> |
		<a href="/charlie/development/web/JavaScript/index.html">JavaScript</a> |
		<a href="/charlie/books/index.html">My Books</a> </p>

      </footer>

    </div><!-- /.container -->
</body>
</html>



